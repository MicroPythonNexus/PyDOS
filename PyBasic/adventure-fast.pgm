10,0
11,62
12,126
13,177
14,185
15,250
16,328
17,402
18,410
19,495
20,575
21,628
22,672
23,743
44,813
45,892
46,918
47,939
50,962
51,979
52,997
53,1013
54,1030
70,2373
110,2409
130,2429
150,2470
160,2510
161,2617
162,2723
170,2738
171,2760
172,2793
175,2806
182,2839
190,2880
192,2933
193,2956
194,3031
195,3154
196,3278
197,3295
198,3308
200,3323
210,3340
220,3379
221,3408
222,3547
228,3564
230,-3577
231,-3610
232,-3642
233,-3676
234,-3705
235,-3737
236,-3767
240,3801
241,3831
242,3970
243,3987
245,-4000
246,-4028
247,-4056
260,4084
263,4120
264,4148
266,4164
267,4193
280,4221
300,4255
310,4282
320,4331
321,4367
330,4430
340,4457
350,4471
360,4511
370,4529
375,4545
380,4572
390,4588
400,4655
410,4688
420,4729
425,4754
431,4784
432,4814
433,4838
449,4879
450,4948
460,4977
470,5015
471,5092
480,5154
490,5166
500,5206
510,5307
520,5358
800,5383
870,5423
871,5477
872,5548
873,5577
874,5631
890,5702
900,5724
910,5737
920,5786
930,5844
940,5860
950,5917
980,5931
990,5982
1000,6033
1010,6066
1020,6088
1030,6144
1040,6157
1050,6191
1060,6207
1070,6239
1130,6266
1140,6294
1150,6332
1160,6356
1170,6400
1180,6416
1190,6440
1191,6483
1200,6503
1220,6519
1221,6533
1230,6550
1240,6565
1250,6599
1260,6615
1261,6666
1270,6726
1280,6768
1290,6793
1300,6821
1310,6836
1320,6874
1330,6937
1340,6965
1350,6980
1360,7017
1370,7083
1380,7105
1390,7132
1400,7147
1410,7174
1420,7231
1430,7257
1440,7285
1460,7300
1470,7341
1480,7369
1490,7398
1500,7426
1510,7441
1520,7460
1530,-7482
1540,7516
1550,7556
1560,7570
1570,7584
1580,7600
1590,7621
1600,7649
1610,7682
1620,7712
1630,7725
1640,7753
1650,7768
1660,7782
1670,7796
1680,7812
1690,7836
1691,7882
1700,7973
1710,7996
1720,8023
1730,8058
1740,8086
1750,8101
1760,8115
1770,8131
1780,8147
1781,8184
1790,8231
1800,8277
1810,8305
1820,8320
1821,8348
1830,8376
1840,8399
1850,8411
1860,8427
1870,8483
1880,8511
1890,8526
1900,8589
1910,8606
1920,8634
1940,8649
1950,8674
1960,8741
1980,8808
1990,8835
1991,8885
2000,8945
2020,8967
2021,9016
2022,9039
2023,9053
2030,9068
2040,9081
2050,9100
2051,9139
2052,9153
2060,9166
2070,-9181
2080,9281
2090,9296
2095,9316
2110,9611
2120,9627
2130,9651
2140,9678
2150,9719
2160,9733
2170,9749
2180,9777
2190,9790
2200,9806
2210,9833
2220,9848
2230,9872
2240,9899
2250,9940
2260,9954
2270,9970
2280,9998
2290,10011
2300,10027
2310,10083
2320,10110
2325,10144
2330,10163
2335,10198
2340,10218
2350,10232
2360,10248
2370,10276
2380,10290
2390,10306
2400,10330
2410,10358
2420,10385
2430,10412
2440,10427
2450,10439
2460,10491
2470,10507
2480,10535
2490,10561
2500,10573
2510,10589
2520,10617
2530,10629
2540,10645
2550,10673
2560,10685
2570,10701
2580,10725
2590,10753
2600,10787
2610,10813
2620,10827
2630,10841
2640,10857
2650,10898
2660,10965
2670,10992
2680,11008
2690,11023
2700,11057
2710,11077
2720,11116
2730,11131
2740,11157
2750,11184
2760,11199
2770,11289
2780,11319
2790,11335
2800,11362
2810,11379
2820,11419
2830,11434
2840,11464
2850,11504
2860,11519
2870,11543
2880,11577
2890,11593
2900,11631
2910,11664
2920,11686
2930,11701
2940,11724
2941,11762
2950,11827
2960,11855
2970,11870
2980,11887
2990,11904
3000,11919
3010,11943
3020,11977
3030,11995
3040,12011
3050,12023
3060,12039
3070,12075
3080,12091
3090,12126
3100,12160
3110,12176
3120,12201
3130,12217
3140,12241
3150,12268
3160,12287
3170,12299
3180,12315
3190,12343
3200,12368
3210,12380
3240,12396
3250,12427
3260,12454
3270,12493
3280,12506
3290,12522
3300,12545
3310,12572
3320,12594
3330,12606
3340,12622
3350,12650
3360,12678
3370,12690
3400,12706
3410,12728
3420,12755
3430,12794
3440,12807
3450,12823
3470,12851
3480,12864
3490,12898
3510,12920
3511,12954
3520,12987
3530,13002
3540,13020
3550,13033
3551,13069
3560,13092
3570,13104
3590,13119
3630,13141
3640,13189
3650,13206
3660,13232
3670,13256
3680,13272
3710,13295
3720,13343
3730,13394
3740,13428
3750,13461
3760,13509
3770,13569
3780,13585
3790,13638
3800,13651
3810,13673
3811,13707
3820,13725
3830,13738
3840,13764
3850,13792
3860,13820
3870,13835
3880,13851
3890,13872
3900,13929
3910,13943
3920,13958
3940,13981
3950,14029
3960,14046
3970,14072
3980,14097
4000,14113
4030,14136
4040,14184
4050,14235
4060,14267
4070,14301
4080,14349
4090,14418
4100,14434
4110,14499
4120,14515
4130,14574
4140,14594
4150,14608
4160,14623
4170,14647
4180,14664
4190,14690
4200,14716
4210,14732
4220,14767
4230,14820
4240,14854
4241,14882
4260,14920
4270,14973
4280,15008
4281,15036
4300,15067
4310,15120
4320,15151
4330,15180
4340,15208
4350,15225
4360,15241
4361,15269
4380,15300
4390,15342
4391,15376
4400,15393
4410,15415
4415,15435
4420,15463
4430,15478
4440,15503
4450,15520
4460,15585
4470,15614
4480,15642
4490,15657
4500,15685
4501,15713
4520,15752
4530,15786
4540,15818
4560,15851
4570,15897
4580,15933
4590,15961
4600,15976
4610,16004
4620,16032
4630,16047
4640,16070
4650,16087
4660,16115
4670,16143
4680,16171
4690,16186
4700,16220
4720,16250
4730,16277
4740,16308
4750,16336
4760,16351
4770,16384
4790,16435
4800,16450
4810,16474
4820,16508
4840,16539
4850,16567
4851,16605
4852,16631
4853,16657
4860,16683
4870,16710
4890,16758
4900,16785
4920,16833
4930,16860
4950,16908
4960,16931
4970,16969
4980,16996
4990,17012
5000,17046
5020,17076
5040,17112
5060,17127
5070,17152
5080,17187
5090,17228
5110,17264
5120,17279
5130,17307
5140,17333
5150,17361
5160,17376
5165,17402
5170,17423
5180,17451
5190,17466
5200,17489
5210,17537
5220,17576
5230,17603
5240,17618
5250,17653
5260,17682
5270,17703
5280,17731
5290,17757
5300,17776
5310,17839
5320,17866
5330,17894
5350,17933
5360,17960
5380,17992
5381,18029
5390,18068
5400,18087
5410,18102
5420,18125
5430,18176
5440,18210
5460,18239
5470,18271
5480,18312
5490,18326
5491,18359
5492,18385
5500,18411
5510,18439
5530,18463
5540,18491
5560,18515
5570,18538
5580,18555
5590,18581
5610,18615
5620,18642
5630,18675
5650,18726
5660,18753
5680,18811
5690,18844
5700,18872
5710,18887
5720,18919
5730,18976
5740,19010
5750,19084
5760,19099
5770,19123
5780,19140
5790,19167
5800,19195
5810,19210
5820,19224
5830,19275
5840,19309
5860,19338
5870,19366
5880,19397
5890,19423
5900,19484
5910,19499
5920,19521
5930,19569
5940,19597
5950,19612
5970,19639
5980,19664
6000,19692
6010,19716
6020,19764
6030,19792
6040,19807
6060,19834
6070,19859
6071,19887
6090,19926
6100,19960
6110,19987
6120,20014
6130,20029
6140,20062
6150,20089
6160,20117
6180,20146
6190,20176
6200,20195
6210,20225
6220,20253
6230,20268
6240,20292
6250,20325
6270,20349
6280,20372
6290,20404
6310,20428
6320,20452
6330,20524
6350,20548
6360,20571
6370,20597
6380,20614
6390,20640
6400,20656
6410,20676
6420,20693
6430,20708
6440,20739
6450,20756
6451,20794
6460,20865
6470,-20884
6480,20957
6481,20993
6482,21020
6483,21033
6484,21056
6485,21070
6490,21084
6500,21138
6510,21151
6520,21183
6530,21201
6540,21223
6550,21246
6560,21260
6570,21286
6575,21319
6580,21348
6585,21381
6590,21410
6600,21424
6605,21566
6610,21681
6620,21704
6621,21737
6630,21769
6640,21783
6660,21796
6680,21832
6690,21852
6700,21875
6710,21896
6711,21930
6720,21945
6721,21959
6722,21994
6730,22022
6740,22055
6745,22072
6750,22100
6760,22117
6770,22129
6775,22142
6780,22181
6820,22201
6830,22224
6840,22245
6850,22259
6860,22278
6870,22293
6880,22306
6890,22329
6900,22386
6910,22428
6920,22456
6930,22471
6940,22516
6950,22532
6960,22560
6970,22576
6980,22612
6990,22659
7000,22687
7010,22703
7020,22749
7030,22774
7040,22802
7050,22818
7060,22864
7070,22904
7080,22938
7090,22954
7100,22996
7110,23035
7140,23090
7150,23118
7160,23141
7170,23168
7180,23209
7210,23264
7220,23298
7240,23328
7250,23362
7260,23388
7280,23430
7290,23456
7300,23484
7310,23500
7320,23543
7330,23585
7340,23619
7360,23645
7370,23661
7380,23686
7390,23714
7400,23737
7410,23782
7415,23810
7420,23836
7425,23863
7430,23889
7440,23905
7450,23943
7460,23971
7470,23988
7480,24014
7490,24061
7500,24091
7520,24128
7530,24174
7541,24219
7542,24286
7543,24314
7550,24368
7560,24395
7570,24428
7580,24461
7581,24489
7600,24534
7610,24562
7619,24578
7620,24602
7630,24637
7640,24655
7645,24701
7650,24743
7660,24803
7670,24826
7672,24848
7673,24893
7690,24909
7700,24952
7705,24988
7710,25024
7712,25060
7720,25096
7730,25118
7740,25164
7750,25180
7760,25196
7770,25250
7800,25263
7810,25273
7820,25306
7830,25316
7840,25332
7842,25380
7850,25416
7860,25441
7861,25504
7870,25532
7880,25554
7881,25605
7890,25633
7900,25653
7901,25701
7910,25729
7920,25745
7921,25807
7930,25835
7940,25850
7941,25898
7950,25926
7951,25974
7960,26002
7970,26025
7971,26073
7980,26106
7990,26119
8000,26129
8010,26190
8020,26245
8030,26272
8040,26335
8050,26354
8060,26380
8070,26409
8080,26425
8090,26483
8100,26512
8110,26528
8120,26557
8130,26591
8180,26604
8190,26663
8200,26727
8201,26769
8202,26786
8210,26802
8220,26860
8230,26879
8235,26896
8240,26909
8250,26919
8260,26967
8270,27013
8280,27050
8300,27082
8320,27105
8330,27156
8340,27174
8350,27218
8351,27261
8352,27314
8360,27328
8370,27342
8380,27356
8390,27369
8400,27403
8410,27416
8415,27439
8430,27465
8431,27523
8440,27566
8450,27580
8460,27593
8470,27604
8480,27648
8490,27658
8500,27692
8510,27731
8520,27744
8530,27757
8540,27770
8550,27783
8560,27808
8570,27835
8580,27873
8590,27900
8600,27930
8610,27954
8620,27982
8630,28011
8640,28027
8650,28058
8652,28086
8660,28117
8661,28151
8662,28206
8663,28235
8670,28266
8680,28295
8690,28310
8700,28338
8705,28380
8706,28401
8707,28431
8710,28447
8720,28476
8730,28490
8740,28517
8750,28544
8760,28569
8770,28585
8780,28623
8781,28654
8785,28706
8786,28726
8790,28754
8800,28767
8810,28792
8820,28847
8830,28860
8840,28887
8850,28909
8855,28943
8860,28961
8870,28974
8880,29018
8890,29061
8900,29091
8910,29119
8920,29135
8930,29163
8940,29185
8945,29219
8950,29239
8960,29252
8970,29265
8980,29293
8990,29353
9000,29395
9010,29411
9020,29453
9030,29468
9040,29705
9041,29727
9042,29769
9043,29782
9044,29810
9050,29826
9051,29851
9060,29864
9070,29914
9080,29929
9090,29961
9100,29987
9110,30033
9120,30048
9130,30084
9140,30125
9150,30141
9160,30180
9170,30195
9171,30314
9180,30338
9191,30360
9192,30416
9193,30429
9194,30467
9200,30483
9210,30496
9220,30511
9230,30547
9240,30564
9250,30591
9260,30619
9270,30634
9280,30668
9290,30690
9300,30706
9310,30736
9320,30765
9330,30780
9340,30802
9341,30827
9390,30869
9400,30900
9410,30928
9420,30949
9430,31022
9440,31044
9450,31061
9460,31076
9470,31103
9480,31124
9490,31138
9500,31181
9510,31197
9540,31212
9550,31238
9560,31256
9561,31282
9562,31308
9570,31334
9580,31383
9590,31411
9600,31428
9610,31444
9620,31472
9630,31488
9640,31514
9650,31542
9660,31595
9670,31645
9680,31667
9685,31701
9690,31720
9700,31733
9710,31801
9720,31842
9730,31857
9740,31892
9750,31920
9760,31945
9762,31962
9770,32002
9780,32013
9790,32036
9791,32062
9800,32126
9810,32168
9820,32327
9830,32342
9840,32371
9850,32399
9860,32415
9870,32450
9875,32465
9877,32500
9880,32515
9890,32557
9900,32600
9901,32638
9910,32651
9911,32689
9920,32702
9930,32718
9940,32745
9945,32761
9950,32774
9961,-32818
9962,-32849
9963,-32877
9964,-32907
9965,-32931
9966,-32961
9967,-32992
9968,-33022
9969,-33055
9970,-33092
9971,-33123
9972,-33153
9973,-33179
9974,-33204
9975,-33229
9976,-33257
9977,-33276
9978,-33293
9979,-33317
9980,-33335
9981,-33353
9982,-33373
9983,-33398
9984,-33428
9985,-33446
9986,-33468
9987,-33486
9988,-33503
9989,-33530
9990,-33561
9991,-33581
9992,-33599
9993,-33618
9994,-33638
9995,-33657
9996,-33676
9997,-33694
9998,-33714
9999,-33733
10000,-33752
10001,-33772
10002,-33793
10003,-33812
10004,-33833
10005,-33851
10006,-33873
10007,-33892
12500,33917
12501,33953
12502,34008
12504,34026
12505,34080
12506,34125
12520,34198
12522,34234
12530,34256
12531,34303
12540,34337
12550,34367
12560,34411
12570,34447
12571,34484
12572,34511
12573,34553
12574,34652
12576,34685
12580,34703
12581,34737
12585,34780
12590,34799
12591,34817
12592,34856
12593,34883
12594,34916
12595,34930
12596,34955
12597,34972
12600,35012
12604,35030
12610,35076
12612,35102
12615,35121
12620,35152
12630,35188
12640,35202
12641,35223
12650,35242
12660,35273
12670,35326
12680,35359
-999,-999
10 REM ADVENTURE/3000 VERSION 3.2     27 FEB 1979 AT 5:30 PM
11 REM THIS PROGRAM IS RELATIVELY BUG-FREE, BUT ONE STILL MUST
12 REM realize that murphy 'S LAW STILL PREVAILS!
13 REM
14 REM ADVENTURE: PROGRAMMED IN HP/3000 BASIC BY BENJAMIN MOSER
15 REM JAMES MADISON HIGH SCHOOL, VIENNA, VIRGINIA.  THE BASIC LAYOUT OF THE
16 REM GAME WAS CONCEIVED BY DON WOODS & WILLIE CROWTHER, BOTH OF M.I.T.
17 REM
18 REM ADVENTURE WAS PORTED TO THE MACINTOSH PLUS BY THE ELIZABETH AND DAVID HUNTER
19 REM IN MARCH 1998 AND THEN TO PYBASIC FOR THE RASPBERRY RP2040 IN JUNE 2021
20 REM print "Adventure 3.2 on ";date$;" at ";time$
21 PRINT "Adventure 3.2 for micro PyBasic"
22 OPEN "AMESSAGE" FOR INPUT AS # 3 : OPEN "AMOVING" FOR INPUT AS # 4
23 OPEN "ADESCRIP" FOR INPUT AS # 1 : OPEN "AITEMS" FOR INPUT AS # 2
44 REM dirs is an array of possible room directions, it replaces file AMOVING
45 DIM DIRS ( 100 , 10 )
46 DIM INDX ( 303 )
47 DIM FRAINDX ( 10 )
50 DIM S ( 99 )
51 DIM V ( 100 )
52 DIM K ( 2 )
53 DIM O ( 15 )
54 STRING$ = "100 N 101 NE 102 E 103 SE 104 S 105 SW 106 W 107 NW 108 U 109 D 110 PLUGH 111 XYZZY 112 PLOVER 113 CROSS 114 CLIMB 115 JUMP 116 FILL 117 EMPTY 117 POUR 118 LOOK 118 L 119 LIGHT 119 ON 120 EXTINGUISH 120 OFF 121 IN 121 ENTER 122 LEAVE 122 OUT 123 INVENTORY 123 I 124 GET 124 CATCH 124 TAKE 125 DROP 125 DUMP 047 ALL 047 EVERYTHING 126 THROW 127 ATTACK 127 KILL 128 FEED 129 WATER 130 LOCK 131 UNLOCK 132 FREE 132 RELEASE 133 WAVE 134 OPEN 135 CLOSE 136 OIL 137 EAT 138 DRINK 139 FEE FIE FOE FOO 140 SHORT 141 LONG 142 BRIEF 143 QUIT 143 STOP 143 END 144 SCORE 145 SAVE 146 LOAD 147 READ 147 EXAMINE 148 YES 148 Y 149 BUG 001 GOLD 001 NUGGET 002 BARS 002 SILVER 003 JEWELRY 004 COINS 005 DIAMONDS 006 MING 006 VASE 007 PEARL 008 EGGS 008 NEST 009 TRIDENT 010 EMERALD 011 PLATINUM 011 PYRAMID 012 CHAIN 013 SPICES 014 PERSIAN 014 RUG 015 TREASURE 015 CHEST 016 WATER 017 OIL 018 LAMP 018 LANTERN 019 KEYS 020 FOOD 021 BOTTLE 022 CAGE 023 ROD 023 WAND 024 CLAM 025 MAGAZINE 026 BEAR 027 AXE 028 VELVET 028 PILLOW 029 SHARDS 030 OYSTER 031 BIRD 032 TROLL 033 DRAGON 034 SNAKE 035 DWARF 036 ROCK 036 BOULDER 037 STAIRS 038 STEPS 039 HOUSE 039 BUILDING 040 GRATE 041 STREAM 042 ROOM 043 BRIDGE 044 PIT 045 VOLCANO 046 ROAD 100 NORTH 101 NORTHEAST 102 EAST 103 SOUTHEAST 104 SOUTH 105 SOUTHWEST 106 WEST 107 NORTHWEST 108 UP 109 DOWN "
70 PRINT : PRINT "Initializing." ;
110 REM initialize
130 REM total rooms, items,and keywords
150 L1 = INT ( RND * 4 ) + 1 : L2 = L1
160 G = 0 : B0 = 1 : SN = 1 : D1 = 1 : D2 = 0 : T = 1 : B1 = 0 : B2 = 0 : P1 = 0 : DEAD = 0 : LASTC$ = ""
161 L = 0 : C = 0 : D3 = 0 : B3 = 0 : D0 = 2 : T1 = 100 : T2 = 35 : T3 = 149 : R0 = 0 : C0 = 0 : C$ = ""
162 KC = 1.02
170 FOR II = 1 TO 99
171 S ( II ) = 0 : V ( II ) = 0
172 NEXT II
175 PRINT "." ; : V ( 100 ) = 0
182 INDX ( 1 ) = - 1 : INDX ( 2 ) = - 1
190 REM   read in possible movement direction array
192 FOR Z2 = 1 TO 100
193 INPUT # 4 , DX1 , DX2 , DX3 , DX4 , DX5 , DX6 , DX7 , DX8 , DX9 , DX0
194 DIRS ( Z2 , 1 ) = DX1 : DIRS ( Z2 , 2 ) = DX2 : DIRS ( Z2 , 3 ) = DX3 : DIRS ( Z2 , 4 ) = DX4 : DIRS ( Z2 , 5 ) = DX5
195 DIRS ( Z2 , 6 ) = DX6 : DIRS ( Z2 , 7 ) = DX7 : DIRS ( Z2 , 8 ) = DX8 : DIRS ( Z2 , 9 ) = DX9 : DIRS ( Z2 , 10 ) = DX0
196 PRINT "." ;
197 NEXT Z2
198 CLOSE # 4
200 RESTORE 230
210 REM    read in locations of items
220 FOR Z2 = 1 TO T2 STEP 5
221 READ DX1 , DX2 , DX3 , DX4 , DX5 : S ( Z2 ) = DX1 : S ( Z2 + 1 ) = DX2 : S ( Z2 + 2 ) = DX3 : S ( Z2 + 3 ) = DX4 : S ( Z2 + 4 ) = DX5
222 PRINT "." ;
228 NEXT Z2
230 DATA 18 , 25 , 23 , 24 , 21
231 DATA 52 , 0 , 71 , 74 , 58
232 DATA 59 , 69 , 66 , 82 , 100
233 DATA 7 , 49 , 7 , 7 , 7
234 DATA 7 , 12 , 13 , 40 , 38
235 DATA 69 , 0 , 46 , 0 , 0
236 DATA 15 , 60 , 82 , 22 , 250
240 FOR II = 1 TO 15 STEP 5 
241 READ DX1 , DX2 , DX3 , DX4 , DX5 : O ( II ) = DX1 : O ( II + 1 ) = DX2 : O ( II + 2 ) = DX3 : O ( II + 3 ) = DX4 : O ( II + 4 ) = DX5
242 PRINT "." ;
243 NEXT II
245 DATA 1 , 2 , 2 , 2 , 2
246 DATA 3 , 4 , 3 , 3 , 2
247 DATA 5 , 3 , 2 , 3 , 3
260 REM ASK IF HE WANTS DIRECTIONS
263 Z59 = 301 : GOSUB 7620
264 GOSUB 9860
266 IF Z0 THEN 267 ELSE 320
267 Z59 = 302 : GOSUB 7620
280 REM    command input routine
300 REM print room, items
310 REM If it's dark don't let him see anything
320 IF L1 < 13 OR L1 = 58 THEN 350
321 IF L = 1 AND ( S ( 18 ) = L1 OR S ( 18 ) = - 1 ) THEN 350
330 Z59 = 45 : GOSUB 7620
340 GOTO 400
350 ON D0 + 1 GOSUB 6780 , 7990 , 8180
360 V ( L1 ) = 1
370 GOSUB 6680
375 IF DEAD = 1 THEN 9540
380 GOSUB 7800
390 REM INPUT LOOP --- MULTIPLE COMMAANDS, REMOVE JUNK CHARACTERS
400 REM if len(c$) > 0 then 500
410 INPUT ">" , C$ : C$ = UPPER$ ( C$ )
420 IF C$ = "" THEN 410
425 PRINT : PRINT : NKEY = 0
431 IF C$ <> LASTC$ THEN 433
432 C$ = "" : GOTO 900
433 NUMKEYS = 1 : LASTC$ = C$ : A$ = ""
449 REM    65-90 = A-Z               48-57 = 0-9         46 = .    
450 FOR X = 1 TO LEN ( C$ )
460 Z5 = ASC ( MID$ ( C$ , X , 1 ) )
470 IF ( Z5 > 64 AND Z5 < 91 ) OR ( Z5 > 47 AND Z5 < 58 ) THEN 480 ELSE 471
471 C$ = MID$ ( C$ , 1 , X - 1 ) + " " + MID$ ( C$ , X + 1 )
480 NEXT X
490 IF INSTR ( C$ , " " ) = 0 THEN 520
500 NUMKEYS = 2 : A$ = MID$ ( C$ , INSTR ( C$ , " " ) , LEN ( C$ ) - INSTR ( C$ , " " ) + 1 ) + " "
510 C$ = MID$ ( C$ , 1 , INSTR ( C$ , " " ) - 1 )
520 C$ = " " + C$ + " "
800 K ( 1 ) = 0 : K ( 2 ) = 0 : Z3 = 0
870 A1 = INSTR ( STRING$ , C$ ) : IF A1 = 0 THEN 872
871 C$ = MID$ ( STRING$ , A1 - 3 , 3 ) : K ( 1 ) = INT ( VAL ( C$ ) )
872 IF NUMKEYS = 1 THEN 900
873 A1 = INSTR ( STRING$ , A$ ) : IF A1 = 0 THEN 900
874 B$ = MID$ ( STRING$ , A1 - 3 , 3 ) : K ( 2 ) = INT ( VAL ( B$ ) )
890 REM EXOTIC WORDS
900 Z0 = 36
910 IF K ( 1 ) >= Z0 AND K ( 1 ) <= 46 THEN 930
920 IF K ( 2 ) >= Z0 AND K ( 2 ) <= 46 THEN 930 ELSE 980
930 GOSUB 8390
940 PRINT "What do you want to do with the " ; D$ ; "?"
950 GOTO 410
980 IF K ( 1 ) >= 110 AND K ( 1 ) <= T3 THEN 1950
990 IF K ( 2 ) >= 110 AND K ( 2 ) <= T3 THEN 1950
1000 REM THEN IS IT A DIRECTION
1010 FOR D = 1 TO 10
1020 IF K ( 1 ) = D + 99 OR K ( 2 ) = D + 99 THEN 1070
1030 NEXT D
1040 REM COMMAND NOT A DIRECTION
1050 GOTO 1950
1060 REM CAN HE MOVE THAT WAY?
1070 Z2 = DIRS ( L1 , D )
1130 IF Z2 = 255 THEN 1470
1140 IF Z2 < 1 OR Z2 > 254 THEN 1220
1150 REM NORMAL MOVING
1160 REM CHECK FOR SPECIAL MOVE CONDITIONS
1170 GOTO 1260
1180 L2 = L1 : L1 = Z2
1190 IF S ( 35 ) = L2 THEN 1191 ELSE 1200
1191 S ( 35 ) = L1
1200 GOTO 9780
1220 Z59 = 1
1221 GOSUB 7620
1230 GOTO 400
1240 REM SPECIAL ROOM DIRECTIONS
1250 REM GRATE
1260 IF L1 = 10 AND ( D = 10 OR D = 5 ) THEN 1280
1261 IF L1 = 11 AND ( D = 9 OR D = 3 ) THEN 1280 ELSE 1320
1270 REM IF GRATE IS OPEN (G=0) MOVE HIM
1280 IF G = 1 THEN 1180
1290 Z59 = 10 : GOSUB 7620
1300 GOTO 400
1310 REM CAN'T TAKE NUGGET UPPSTAIRS
1320 IF NOT ( L1 = 17 AND D = 9 AND S ( 1 ) = - 1 ) THEN 1360
1330 Z59 = 38 : GOSUB 7620
1340 GOTO 400
1350 REM CRYSTAL BRIDGE AND FISSURE
1360 IF NOT ( L1 = 19 AND D = 7 OR L1 = 20 AND D = 3 ) THEN 1410
1370 IF B2 THEN 1180
1380 Z59 = 3 : GOSUB 7620
1390 GOTO 400
1400 REM MT. KING & SNAKE
1410 IF NOT ( L1 = 22 AND D <> 3 AND D <> 9 ) THEN 1690
1420 IF SN = 0 THEN 1180
1430 Z59 = 50 : GOSUB 7620
1440 GOTO 400
1460 REM bedquilt and random directiosn
1470 IF L1 <> 44 THEN 1590
1480 IF RND > 0.5 THEN 1510
1490 Z59 = 52 : GOSUB 7620
1500 GOTO 400
1510 RESTORE 1530
1520 REM ROOMS TO JU
1530 DATA 33 , 37 , 45 , 92 , 76
1540 FOR Z3 = 1 TO INT ( RND * 5 ) + 1
1550 READ Z2
1560 NEXT Z3
1570 GOTO 1180
1580 REM WITT's END
1590 IF L1 <> 39 THEN 1220
1600 REM SHOULD WE LET HIM OUT?
1610 IF RND < 0.15 THEN 1650
1620 REM NO
1630 Z59 = 52 : GOSUB 7620
1640 GOTO 400
1650 REM YES
1660 Z2 = 38
1670 GOTO 1180
1680 REM Narrow Tunnel
1690 IF NOT ( L1 = 57 OR L1 = 58 ) THEN 1780
1691 IF K ( 1 ) <> 102 AND K ( 2 ) <> 102 AND K ( 1 ) <> 106 AND K ( 2 ) <> 106 THEN 1780
1700 FOR Z3 = 1 TO T2
1710 IF Z3 = 10 THEN 1750
1720 IF S ( Z3 ) <> - 1 THEN 1750
1730 Z59 = 53 : GOSUB 7620
1740 GOTO 400
1750 NEXT Z3
1760 GOTO 1180
1770 REM TROLL
1780 IF L1 = 60 AND D = 2 THEN 1790
1781 IF L1 = 61 AND D = 6 THEN 1790 ELSE 1860
1790 ON T + 1 GOTO 1180 , 1800 , 1820 , 1840
1800 Z59 = 55 : GOSUB 7620
1810 GOTO 400
1820 Z59 = 56 : GOSUB 7620
1821 Z59 = 55 : GOSUB 7620
1830 T = 1 : GOTO 400
1840 T = 2
1850 GOTO 1180
1860 IF NOT ( L1 = 73 AND D = 1 AND D2 = 0 ) THEN 1890
1870 Z59 = 57 : GOSUB 7620
1880 GOTO 400
1890 IF NOT ( L1 = 82 AND S ( 33 ) = L1 AND D = 1 ) THEN 1180
1900 REM DRAGON
1910 Z59 = 51 : GOSUB 7620
1920 GOTO 400
1940 REM OTHER COMMANDS
1950 Z1 = K ( 1 ) : IF K ( 1 ) >= 110 AND K ( 1 ) <= T3 THEN 2090
1960 Z1 = K ( 2 ) : IF K ( 2 ) >= 110 AND K ( 2 ) <= T3 THEN 2090
1980 REM ITEM BO NO VERB?
1990 IF K ( 1 ) >= 1 AND K ( 1 ) <= 35 THEN 2000
1991 IF K ( 2 ) >= 1 AND K ( 2 ) <= 35 THEN 2000 ELSE 2040
2000 FOR X = 1 TO 35
2020 IF K ( 1 ) <> X AND K ( 2 ) <> X THEN 2030
2021 RESTORE 9960 + X
2022 READ D$
2023 GOTO 940
2030 NEXT X
2040 RESTORE 2070
2050 FOR X = 1 TO INT ( RND * 4 ) + 1
2051 READ B$
2052 NEXT X
2060 PRINT B$
2070 DATA "What?" , "I don't understand." , "I can't understand that." , "I don't know that word."
2080 GOTO 400
2090 Z1 = Z1 - 109
2095 ON Z1 GOTO 2120 , 2220 , 2300 , 2390 , 2570 , 2640 , 2680 , 2860 , 2930 , 3000 , 3080 , 3130 , 3290 , 3450 , 3590 , 3920 , 4160 , 4430 , 4630 , 4800 , 4950 , 5060 , 5190 , 5410 , 5560 , 5750 , 5810 , 5920 , 6000 , 6090 , 6230 , 6270 , 6310 , 6350 , 6410 , 8970 , 9080 , 9220 , 4490 , 9330
2110 GOTO 2040
2120 REM *** PLUGH ***
2130 IF L1 <> 7 THEN 2170
2140 IF S ( 35 ) = L1 THEN S ( 35 ) = 0
2150 Z2 = 26
2160 GOTO 1180
2170 IF L1 <> 26 THEN 2200
2180 Z2 = 7
2190 GOTO 1180
2200 Z59 = 2 : GOSUB 7620
2210 GOTO 400
2220 REM *** XYZZY ***
2230 IF L1 <> 7 THEN 2270
2240 IF S ( 35 ) = L1 THEN S ( 35 ) = 0
2250 Z2 = 13
2260 GOTO 1180
2270 IF L1 <> 13 THEN 2200
2280 Z2 = 7
2290 GOTO 1180
2300 REM *** PLOVER *** (CAN'T BRING EMERALD WITH HIM)
2310 IF L1 > 26 THEN 2360
2320 IF S ( 35 ) <> L1 THEN 2330
2325 S ( 35 ) = 0
2330 IF S ( 10 ) <> - 1 THEN 2340
2335 S ( 10 ) = L1
2340 Z2 = 58
2350 GOTO 1180
2360 IF L1 <> 58 THEN 2200
2370 Z2 = 26
2380 GOTO 1180
2390 REM *** CROSS ***
2400 IF L1 <> 19 THEN 2470
2410 IF B2 <> 0 THEN 2440
2420 Z59 = 3 : GOSUB 7620
2430 GOTO 400
2440 D = 7
2450 REM JUST GIVE NEW DIRECTION, USE MOVE ROUTINE
2460 GOTO 1070
2470 IF L1 <> 20 THEN 2510
2480 IF B2 = 0 THEN 2420
2490 D = 3
2500 GOTO 1070
2510 IF L1 <> 60 THEN 2540
2520 D = 2
2530 GOTO 1070
2540 IF L1 <> 61 THEN 2200
2550 D = 6
2560 GOTO 1070
2570 REM *** CLIMB ***
2580 IF L1 <> 50 THEN 2200
2590 REM CAN HE CLIMB BEANSTALK?
2600 IF P1 < 2 THEN 2200
2610 REM YES
2620 Z2 = 70
2630 GOTO 1180
2640 REM *** JUMP *** STRICTLY SUICIDAL
2650 IF L1 <> 16 AND L1 <> 19 AND L1 <> 20 AND L1 <> 27 THEN 2200
2660 Z59 = 4 : GOSUB 7620
2670 GOTO 9550
2680 REM FILL
2690 IF S ( 21 ) = - 1 THEN 2730
2700 B$ = "bottle"
2710 PRINT "You don't have the " ; B$
2720 GOTO 410
2730 IF B0 = 0 THEN 2760
2740 Z59 = 5 : GOSUB 7620
2750 GOTO 410
2760 IF L1 <> 7 AND L1 <> 8 AND L1 <> 9 AND L1 <> 35 AND L1 <> 74 AND L1 <> 81 THEN 2790
2770 B0 = 1 : S ( 16 ) = - 1
2780 GOTO 2840
2790 IF L1 = 49 THEN 2830
2800 B$ = "oil"
2810 PRINT "I see no " ; B$ ; " here."
2820 GOTO 400
2830 B0 = 2 : S ( 17 ) = - 1
2840 PRINT "The bottle is now filled."
2850 GOTO 400
2860 REM *** EMPTY ***
2870 IF S ( 21 ) = - 1 THEN 2890
2880 GOTO 2700
2890 REM EMPTY BOTTLE (ASSUMED FULL)
2900 S ( B0 + 15 ) = 0 : B0 = 0
2910 PRINT "Emptied"
2920 GOTO 400
2930 REM *** LOOK ***
2940 IF L1 < 13 OR L1 = 58 THEN 2970
2941 IF L = 1 AND ( S ( 18 ) = L1 OR S ( 18 ) = - 1 ) THEN 2970
2950 Z59 = 45 : GOSUB 7620
2960 GOTO 400
2970 GOSUB 8050
2980 GOSUB 6680
2990 GOTO 400
3000 REM *** LIGHT ***
3010 IF S ( 18 ) = - 1 THEN 3040
3020 B$ = "lamp"
3030 GOTO 2710
3040 L = 1
3050 B$ = "on"
3060 PRINT "The lamp is now " ; B$
3070 GOTO 2940
3080 REM *** OFF (EXTINGUSIH) ***
3090 IF S ( 18 ) = - 1 THEN 3110
3100 GOTO 3020
3110 L = 0 : B$ = "off"
3120 GOTO 3060
3130 REM *** ENTER ***
3140 IF L1 <> 6 THEN 3180
3150 REM TO HOUSE
3160 D = 3
3170 GOTO 1070
3180 IF L1 <> 68 THEN 3240
3190 REM TO BARREN ROOM
3200 D = 3
3210 GOTO 1070
3240 FOR D = 10 TO 1 STEP - 1
3250 Z2 = DIRS ( L1 , D )
3260 IF Z2 > 0 AND Z2 < 101 THEN 1150
3270 NEXT D
3280 GOTO 2200
3290 REM ** LEAVE ***
3300 IF L1 <> 7 THEN 3340
3310 REM LEAVE HOUSE
3320 D = 7
3330 GOTO 1070
3340 IF L1 <> 69 THEN 3400
3350 REM LEAVE BARREN ROOM
3360 D = 7
3370 GOTO 1070
3400 FOR D = 1 TO 10
3410 Z2 = DIRS ( L1 , D )
3420 IF Z2 > 0 AND Z2 < 101 THEN 1150
3430 NEXT D
3440 GOTO 2200
3450 REM *** INVENTORY ***
3470 Z0 = 0
3480 PRINT "You are carrying:" ;
3490 FOR X = 1 TO T2
3510 IF S ( X ) <> - 1 THEN 3540
3511 RESTORE 9960 + X : READ B$
3520 PRINT B$
3530 Z0 = Z0 + 1
3540 NEXT X
3550 IF Z0 = 0 THEN 3551 ELSE 3560
3551 PRINT "nothing."
3560 PRINT
3570 GOTO 400
3590 REM *** GET ***
3630 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 3680
3640 GOSUB 8280
3650 IF Z8 > 0 THEN 3680
3660 PRINT "Get what?"
3670 GOTO 2040
3680 FOR Z3 = 1 TO T2
3710 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 3730
3720 IF K ( 1 ) <> Z3 AND K ( 2 ) <> Z3 THEN 3900
3730 IF S ( Z3 ) <> L1 THEN 3750
3740 IF S ( Z3 ) = L1 THEN 3790
3750 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 3900
3760 RESTORE 9960 + Z3 : READ A$ : PRINT A$ ; " not here."
3770 GOTO 3900
3780 REM MUST CHECK NOW FOR LEGALITY OF TAKING ITEM
3790 Z8 = 0
3800 FOR X = 1 TO T2
3810 IF S ( X ) <> - 1 THEN 3820
3811 Z8 = Z8 + 1
3820 NEXT X
3830 IF Z8 < 7 THEN 3870
3840 REM CARRYING TOO MUCH
3850 Z59 = 54 : GOSUB 7620
3860 GOTO 410
3870 GOTO 6880
3880 S ( Z3 ) = - 1
3890 RESTORE 9960 + Z3 : READ A$ : PRINT A$ ; ":taken."
3900 NEXT Z3
3910 GOTO 400
3920 REM *** DROP ***
3940 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 4000
3950 GOSUB 8280
3960 IF Z8 > 0 THEN 4000
3970 PRINT "Drop what?"
3980 GOTO 2040
4000 FOR Z3 = 1 TO T2
4030 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 4060
4040 IF K ( 1 ) <> Z3 AND K ( 2 ) <> Z3 THEN 4140
4050 IF S ( Z3 ) = 0 THEN 4140
4060 IF S ( Z3 ) = - 1 THEN 4100
4070 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 4140
4080 RESTORE 9960 + Z3 : READ B$ : PRINT "You don't have the " ; B$
4090 GOTO 4140
4100 REM STILL NEED TO ELABORATE ON DROP (BIRD IN CAGE, BOTTLE)
4110 GOTO 7380
4120 RESTORE 9960 + Z3 : READ B$ : PRINT B$ ; ":dropped."
4130 S ( Z3 ) = L1
4140 NEXT Z3
4150 GOTO 400
4160 REM *** THROW ***
4170 GOSUB 8280
4180 IF Z8 > 0 THEN 4210
4190 PRINT "Throw what?"
4200 GOTO 2040
4210 IF S ( Z3 ) <> - 1 THEN 2710
4220 IF NOT ( Z3 < 16 AND S ( 32 ) = L1 ) THEN 4260
4230 REM THROW TREASURE TO TROLL
4240 Z59 = 27 : GOSUB 7620
4241 S ( Z3 ) = 0 : T = 3 : GOTO 400
4260 IF NOT ( Z3 = 27 AND S ( 32 ) = L1 ) THEN 4300
4270 REM TRYING TO BUTCHER TROLL?
4280 Z59 = 26 : GOSUB 7620
4281 S ( 27 ) = L1 : GOTO 400
4300 IF NOT ( Z3 = 27 AND S ( 35 ) = L1 ) THEN 4380
4310 REM TRYING TO KILL DWARF
4320 IF RND > 0.5 THEN 4360
4330 Z59 = 29 : GOSUB 7620
4340 GOSUB 8650
4350 GOTO 4410
4360 Z59 = 30 : GOSUB 7620
4361 S ( 35 ) = 0 : GOTO 4410
4380 REM NOTHING SPECIAL, JUST DROP ITEM
4390 IF S ( 35 ) <> L1 THEN 4400
4391 GOSUB 8550
4400 PRINT "Thrown."
4410 S ( Z3 ) = L1
4415 IF DEAD = 1 THEN 9540
4420 GOTO 400
4430 REM *** ATTACK ***
4440 GOSUB 8280
4450 IF NOT ( Z3 = 33 AND S ( Z3 ) = L1 AND L1 = 82 ) THEN 4520
4460 REM HE CAN KILL DRAGON
4470 Z59 = 68 : GOSUB 7620
4480 GOTO 410
4490 IF L1 <> 82 THEN 2040
4500 Z59 = 69 : GOSUB 7620
4501 S ( 33 ) = 0 : D1 = 0 : GOTO 400
4520 IF S ( 32 ) <> L1 THEN 4560
4530 REM TRYING TO MUNGE TROLL
4540 Z9 = FNA ( 25 ) : GOTO 400
4560 IF NOT ( Z3 = 26 OR Z3 > 30 ) THEN 4600
4570 REM DANGEROUS TO ATTACK THESE
4580 Z59 = 70 : GOSUB 7620
4590 GOTO 400
4600 REM NOTHING TO ATTACK
4610 Z59 = 71 : GOSUB 7620
4620 GOTO 400
4630 REM *** FEED ***
4640 GOSUB 8280
4650 IF Z3 <> 35 THEN 4690
4660 REM CAN'T FEED DWARF!
4670 Z59 = 24 : GOSUB 7620
4680 GOTO 400
4690 IF S ( 20 ) = - 1 THEN 4720
4700 B$ = "FOOD" : GOTO 2710
4720 IF L1 = 69 THEN 4760
4730 PRINT "I can't feed it."
4740 Z59 = 23 : GOSUB 7620
4750 GOTO 400
4760 IF S ( 20 ) = L1 THEN 7600
4770 B1 = 1 : S ( 20 ) = 0 : Z59 = 6 : GOSUB 7620
4790 GOTO 400
4800 REM *** WATER ***
4810 IF S ( 16 ) = - 1 THEN 4840
4820 B$ = "water" : GOTO 2710
4840 IF L1 <> 50 THEN 2200
4850 REM GOTO P1+1 OF 4860,4890,4920
4851 IF P1 = 0 THEN 4860
4852 IF P1 = 1 THEN 4890
4853 IF P1 = 2 THEN 4920
4860 Z59 = 7 : GOSUB 7620
4870 P1 = 1 : S ( 16 ) = 0 : B0 = 0 : GOTO 400
4890 Z59 = 8 : GOSUB 7620
4900 P1 = 2 : S ( 16 ) = 0 : B0 = 0 : GOTO 400
4920 Z59 = 9 : GOSUB 7620
4930 P1 = 0 : S ( 16 ) = 0 : B0 = 0 : GOTO 400
4950 REM *** LOCK ***
4960 IF L1 = 10 OR L1 = 11 THEN 4990
4970 REM NOTHING LOCKABLE
4980 GOTO 2200
4990 IF S ( 19 ) = - 1 THEN 5020
5000 B$ = "keys" : GOTO 2710
5020 G = 0 : Z59 = 10 : GOSUB 7620
5040 GOTO 400
5060 REM *** UNLOCK ***
5070 IF S ( 19 ) <> - 1 THEN 5000
5080 IF L1 <> 10 AND L1 <> 11 THEN 5120
5090 G = 1 : Z59 = 11 : GOSUB 7620
5110 GOTO 400
5120 IF L1 <> 69 THEN 2200
5130 IF B1 > 0 THEN 5160
5140 Z59 = 12 : GOSUB 7620
5150 GOTO 400
5160 IF C <> 0 THEN 5170
5165 C = 1 : B1 = 2
5170 Z59 = 13 : GOSUB 7620
5180 GOTO 400
5190 REM *** FREE ***
5200 IF K ( 1 ) = 31 OR K ( 2 ) = 31 THEN 5240
5210 REM CAN'T FREE ANYTHING BUT BIRD
5220 Z59 = 2 : GOSUB 7620
5230 GOTO 410
5240 IF S ( 31 ) <> - 1 THEN 5220
5250 S ( 31 ) = L1 : B3 = 0
5260 PRINT "Freed."
5270 IF L1 <> 22 THEN 5350
5280 IF SN <> 1 THEN 400
5290 B$ = "snake"
5300 PRINT "The little bird attacks the green " ; B$ ; " and"
5310 IF L1 = 82 THEN 5380
5320 PRINT "drives it off"
5330 SN = 0 : S ( 34 ) = 0 : GOTO 400
5350 IF L1 <> 82 THEN 400
5360 B$ = "dragon" : GOTO 5300
5380 PRINT "gets burned to a crisp"
5381 S ( 20 ) = 0 : B0 = 0 : GOTO 400
5390 S ( 31 ) = 0
5400 GOTO 400
5410 REM *** WAVE ***
5420 IF K ( 1 ) <> 23 AND K ( 2 ) <> 23 THEN 2200
5430 IF S ( 23 ) = - 1 THEN 5460
5440 B$ = "rod" : GOTO 2710
5460 REM  IS HERE NEAR FISSURE
5470 IF L1 <> 19 AND L1 <> 20 THEN 2200
5480 REM yes
5490 REM GOTO B2+1 OF 5500,5530
5491 IF B2 = 0 THEN 5500
5492 IF B2 = 1 THEN 5530
5500 Z59 = 14 : GOSUB 7620
5510 B2 = 1 : GOTO 400
5530 Z59 = 15 : GOSUB 7620
5540 B2 = 0 : GOTO 400
5560 REM *** OPEN ***
5570 GOSUB 8280
5580 IF Z3 > 0 THEN 5610
5590 PRINT "Open " ; : GOTO 2040
5610 IF Z3 = 40 THEN 5070
5620 IF S ( Z3 ) = L1 THEN 5650
5630 PRINT "I see no " ; B$ ; " here." : GOTO 400
5650 IF Z3 = 24 THEN 5680
5660 PRINT "I don't know how to open a " ; B$ : GOTO 400
5680 IF S ( 9 ) = - 1 THEN 5710
5690 Z59 = 16 : GOSUB 7620
5700 GOTO 400
5710 IF S ( Z3 ) = 0 THEN 2200
5720 REM HE'S OPENED CLAM, SO PRINT DESCRIPTION OF THIS
5730 REM PUT PEARL IN CUL-DE-SAC
5740 S ( 7 ) = 43 : S ( 24 ) = 0 : S ( 30 ) = L1 : Z59 = 17 : GOSUB 7620
5750 GOTO 400
5760 REM *** CLOSE ***
5770 GOSUB 8280
5780 IF Z3 = 40 THEN 4960
5790 Z59 = 18 : GOSUB 7620
5800 GOTO 400
5810 REM OIL
5820 IF K ( 1 ) <> 17 AND K ( 2 ) <> 17 THEN 2200
5830 IF S ( 17 ) = - 1 THEN 5860
5840 B$ = "oil" : GOTO 5630
5860 IF L1 <> 73 THEN 2200
5870 REM IS DOOR STILL RUSTED
5880 IF D2 = 1 THEN 2200
5890 D2 = 1 : S ( 17 ) = 0 : B0 = 0 : Z59 = 19 : GOSUB 7620
5900 GOTO 400
5910 REM *** EAT ***
5920 IF K ( 1 ) = 20 OR K ( 2 ) = 20 THEN 5950
5930 Z59 = 20 : GOSUB 7620
5940 GOTO 410
5950 Z3 = 20 : GOSUB 8490
5970 IF Z5 = 0 THEN 410
5980 Z59 = 73 : GOSUB 7620
6000 REM *** DRINK ***
6010 IF K ( 1 ) = 16 OR K ( 2 ) = 16 THEN 6040
6020 Z59 = 21 : GOSUB 7620
6030 GOTO 410
6040 Z3 = 16 : GOSUB 8490
6060 IF Z5 = 0 THEN 410
6070 Z59 = 22 : GOSUB 7620
6071 S ( 17 ) = 0 : B0 = 0 : GOTO 400
6090 REM *** FEE FIE FOE FOO ***
6100 IF L1 = 71 THEN 6130
6110 Z59 = 2 : GOSUB 7620
6120 GOTO 410
6130 IF S ( 8 ) <> L1 THEN 6180
6140 REM MAKE NEST VANISH
6150 Z59 = 79 : GOSUB 7620
6160 S ( 8 ) = 0 : GOTO 400
6180 REM IF S(8)=0 THEN 6110
6190 S ( 8 ) = L1
6200 REM MAKE NEST RE-APPEAR
6210 Z59 = 81 : GOSUB 7620
6220 GOTO 400
6230 REM *** SHORT ***
6240 PRINT "Short descriptions"
6250 D0 = 0 : GOTO 400
6270 REM *** LONG ***
6280 PRINT "Long descriptions"
6290 D0 = 1 : GOTO 400
6310 REM *** BRIEF ***
6320 PRINT "OK, I'll only describe the room in detail the first time."
6330 D0 = 2 : GOTO 400
6350 REM *** QUIT ***
6360 PRINT "Save game" ;
6370 GOSUB 9860
6380 IF Z0 = 1 THEN 8970
6390 GOTO 9750
6400 REM SCORE ***
6410 GOSUB 6430
6420 GOTO 400
6430 REM PRINT OUT SCORE DATA
6440 GOSUB 6510
6450 PRINT "Your score is now " ; S0
6451 PRINT "You have explored " , ( Z9 / T1 ) * T1 , "% of the cave."
6460 RESTORE 6470
6470 DATA "beginner" , "novice" , "experienced" , "advanced" , "expert"
6480 Z9 = INT ( ( S0 - 1 ) / 100 )
6481 IF Z9 <= 4 THEN 6483
6482 Z9 = 4
6483 FOR Z0 = 0 TO Z9
6484 READ D$
6485 NEXT Z0
6490 PRINT "That makes you a " ; D$ ; " adventurer."
6500 RETURN
6510 REM COMPUTE CURRENT SCORE
6520 RESTORE 230
6530 Z9 = 0 : S0 = 0
6540 FOR Z0 = 1 TO 15
6550 READ Z1
6560 IF Z1 = 0 THEN 6590
6570 IF V ( Z1 ) <> 1 THEN 6580
6575 S0 = S0 + 4 * O ( Z0 )
6580 IF S ( Z0 ) <> 7 THEN 6590
6585 S0 = S0 + 4 * O ( Z0 )
6590 NEXT Z0
6600 S0 = ( G = 1 ) * 10 + S0 : S0 = ( SN = 0 ) * 20 + S0 : S0 = ( D1 = 0 ) * 30 + S0 : S0 = ( T = 0 ) * 30 + S0 : S0 = ( B1 = 2 ) * 20 + S0
6605 S0 = ( B2 = 1 ) * 20 + S0 : S0 = ( P1 = 2 ) * 20 + S0 : S0 = ( D2 = 1 ) * 20 + S0 : S0 = ( C = 1 ) * 20 + S0
6610 FOR Z0 = 1 TO T1
6620 IF V ( Z0 ) <> 1 THEN 6630
6621 S0 = S0 + 1 : Z9 = Z9 + 1
6630 NEXT Z0
6640 RETURN
6660 REM list items at location l1
6680 FSEEK # 2 , 0
6690 FOR Z1 = 1 TO T2
6700 INPUT # 2 , A$
6710 IF S ( Z1 ) <> L1 THEN 6720
6711 PRINT A$
6720 NEXT Z1
6721 IF S ( 26 ) <> - 1 THEN 6730
6722 Z59 = 67 : GOSUB 7620
6730 REM CHECK FOR DWARF,PIRATE
6740 GOSUB 8560
6745 IF DEAD = 1 THEN 6770
6750 GOSUB 8800
6760 PRINT
6770 RETURN
6775 REM Print Short room description
6780 FSEEK # 1 , 0
6820 FOR Z1 = 1 TO L1
6830 INPUT # 1 , A$
6840 NEXT Z1
6850 V ( L1 ) = 1
6860 PRINT A$
6870 RETURN
6880 REM SPECIAL GETS
6890 IF NOT ( Z3 = 24 OR Z3 = 30 OR Z3 > 31 ) THEN 6930
6900 REM CAN'T GET THESE FOR SOME REASON
6910 Z59 = 61 : GOSUB 7620
6920 GOTO 400
6930 IF NOT ( Z3 = 12 AND C = 0 ) THEN 6970
6940 REM CHAIN
6950 Z59 = 58 : GOSUB 7620
6960 GOTO 3900
6970 REM BEAR IS HE FED? UNLOCKED?
6980 IF NOT ( Z3 = 26 AND B1 <> 2 ) THEN 7010
6990 Z59 = 61 : GOSUB 7620
7000 GOTO 3900
7010 IF NOT ( Z3 = 14 AND D1 = 1 ) THEN 7050
7020 REM DRAGON AND RUG
7030 Z59 = 59 : GOSUB 7620
7040 GOTO 3900
7050 IF NOT ( Z3 = 16 OR Z3 = 17 ) THEN 7090
7060 REM OIL AND WATER DO SAME AS FILL
7070 PRINT "Why not say 'fill'?"
7080 GOTO 3900
7090 IF NOT ( Z3 = 22 AND B3 ) THEN 7140
7100 REM TAKE BIRD SINCE IT'S IN CAGE
7110 S ( 31 ) = - 1 : PRINT "Bird and " ; : GOTO 3880
7140 IF Z3 <> 31 THEN 7310
7150 REM GETTING BIRD
7160 IF B3 <> 1 THEN 7210
7170 REM TAKE CAGE, SINCE BIRD IS IN IT
7180 PRINT "Cage and " ; : S ( 22 ) = - 1 : GOTO 3880
7210 IF S ( 22 ) = - 1 THEN 7240
7220 B$ = "cage" : GOTO 2810
7240 IF S ( 23 ) = - 1 THEN 7280
7250 REM OK TO TAKE BIRD
7260 S ( 31 ) = - 1 : B3 = 1 : GOTO 3890
7280 REM ROD SCARES BIRD
7290 Z59 = 37 : GOSUB 7620
7300 GOTO 3900
7310 REM BOTTLE FULL? IF SO, GET CONTENTS
7320 IF NOT ( Z3 = 21 AND B0 ) THEN 7360
7330 PRINT "Contents and the " ;
7340 S ( B0 + 15 ) = - 1
7360 GOTO 3880
7370 REM SPECIAL "DROP"
7380 IF Z3 <> 31 THEN 7440
7390 REM BIRD IN CAGE
7400 S ( 31 ) = L1 : S ( 22 ) = L1 : B3 = 1
7410 IF Z3 <> 31 THEN 7420
7415 PRINT "Cage and " ;
7420 IF Z3 = 22 THEN 7430
7425 PRINT "Bird and " ;
7430 GOTO 4120
7440 IF Z3 = 22 AND B3 = 1 THEN 7400
7450 IF Z3 <> 21 THEN 7520
7460 REM BOTTLE
7470 IF B0 = 0 THEN 4120
7480 REM BOTTLE IS FULL, DO DROP CONTENTS TOO
7490 PRINT "Contents and " ;
7500 S ( 15 + B0 ) = L1 : GOTO 4120
7520 IF NOT ( Z3 = 16 OR Z3 = 17 ) THEN 7541
7530 PRINT "Try saying 'empty'" : GOTO 4140
7541 IF Z3 <> 26 OR T <> 1 OR ( L1 <> 60 AND L1 <> 61 ) THEN 7550
7542 Z59 = 28 : GOSUB 7620
7543 T = 0 : S ( 26 ) = L1 : S ( 32 ) = 0 : GOTO 400
7550 IF Z3 <> 6 THEN 4120
7560 IF S ( 28 ) = L1 THEN 7600
7570 REM GOODBYE, FRAGILE VASE!
7580 Z59 = 43 : GOSUB 7620
7581 S ( 6 ) = 0 : S ( 29 ) = L1 : GOTO 400
7600 Z59 = 60 : GOSUB 7620
7610 GOTO 4120
7619 REM PRINT MESSAGE
7620 IF INDX ( 1 ) >= 0 THEN 7640
7630 GOSUB 12500
7640 Z59 = INT ( Z59 ) : XTMP = INDX ( Z59 )
7645 IF Z59 <> 2 AND Z59 <> 61 THEN 7660
7650 XTMP = FRAINDX ( XTMP + MIN ( INT ( RND * 5 ) , 5 ) )
7660 FSEEK # 3 , XTMP
7670 INPUT # 3 , B1$
7672 IF LEN ( B1$ ) = 0 THEN 7673 ELSE 7690
7673 B1$ = " "
7690 IF INSTR ( B1$ , "#" ) = 0 THEN 7670
7700 Z4 = VAL ( MID$ ( B1$ , 2 ) )
7705 IF INT ( Z4 ) = Z59 THEN 7720
7710 IF INT ( Z4 ) < Z59 THEN 7670
7712 IF INT ( Z4 ) > Z59 THEN 7760
7720 INPUT # 3 , B1$
7730 IF MID$ ( B1$ , 1 , 1 ) = "#" THEN 7770
7740 PRINT B1$
7750 GOTO 7720
7760 PRINT "NO DESC. # " ; Z59 ; " IN FILE AMESSAGE"
7770 RETURN
7800 REM
7810 REM SITUATION DESCRIPTIONS
7820 REM
7830 REM GRATE
7840 IF L1 = 10 OR L1 = 11 THEN 7842 ELSE 7860
7842 Z59 = ( G + 10 ) : GOSUB 7620
7850 REM CRYSTAL BRIDGE
7860 IF ( L1 = 19 OR L1 = 20 ) AND B2 = 1 THEN 7861 ELSE 7880
7861 Z59 = 14 : GOSUB 7620
7870 REM PLUGH NOISE
7880 IF L1 = 26 AND RND > 0.3 THEN 7881 ELSE 7900
7881 Z59 = 41 : GOSUB 7620
7890 REM IRON DOOR
7900 IF L1 = 73 AND D2 = 0 THEN 7901 ELSE 7920
7901 Z59 = 57 : GOSUB 7620
7910 REM TROLL
7920 IF ( L1 = 60 OR L1 = 61 ) AND T = 1 THEN 7921 ELSE 7940
7921 Z59 = 63 : GOSUB 7620
7930 REM BEAR
7940 IF L1 = 69 AND B1 = 0 THEN 7941 ELSE 7950
7941 Z59 = 64 : GOSUB 7620
7950 IF L1 = 69 AND B1 = 1 THEN 7951 ELSE 7970
7951 Z59 = 66 : GOSUB 7620
7960 REM PLANT IN PIT
7970 IF L1 = 48 OR L1 = 50 THEN 7971 ELSE 7980
7971 Z59 = 47 + P1 : GOSUB 7620
7980 RETURN
7990 REM
8000 REM   print long room description from "amessage" file
8010 REM   description is noormally l1+200 except for
8020 REM   maze or forest
8030 REM set v(l1)=1 so as not to repeat long desc(brief mode
8040 V ( L1 ) = 1
8050 IF L1 > 4 THEN 8080
8060 Z59 = 200 : GOSUB 7620
8070 GOTO 8130
8080 IF NOT ( L1 > 88 AND L1 < 98 OR L1 = 99 ) THEN 8110
8090 Z59 = 288 : GOSUB 7620
8100 GOTO 8130
8110 REM normal description
8120 Z59 = 200 + L1 : GOSUB 7620
8130 RETURN
8180 REM always give long descriptio nfor forest and maze
8190 IF L1 < 5 OR ( L1 > 88 AND L1 < 98 ) OR L1 = 99 THEN 8220
8200 IF V ( L1 ) = 1 THEN 8201 ELSE 8220
8201 GOSUB 6780
8202 GOTO 8235
8210 REM he hassn't seen this room, so give a long desc.
8220 V ( L1 ) = 1
8230 GOSUB 7990
8235 RETURN
8240 REM
8250 REM   fetch first item code in k(1 to t2)
8260 REM   z8=total # of items found in list
8270 REM   z3=item code first found
8280 Z8 = 0 : Z3 = 0 : D$ = ""
8300 FOR Z5 = 1 TO 45
8320 IF K ( 1 ) <> Z5 AND K ( 2 ) <> Z5 THEN 8360
8330 Z8 = Z8 + 1
8340 RESTORE 9960 + Z5 : READ B$ : D$ = B$
8350 IF K ( 1 ) = Z5 AND Z8 = 1 THEN 8352
8351 IF K ( 2 ) = Z5 AND Z8 = 1 THEN 8352 ELSE 8360
8352 Z3 = Z5
8360 NEXT Z5
8370 B$ = D$
8380 RETURN
8390 REM FIND FIRST ITEM AT ROOM
8400 X1 = 0
8410 FOR Z1 = 1 TO 47
8415 IF X1 = 1 THEN 8440
8430 IF K ( 1 ) = Z1 OR K ( 2 ) = Z1 THEN 8431 ELSE 8440
8431 RESTORE 9960 + Z1 : READ D$ : X1 = 1
8440 NEXT Z1
8450 RETURN
8460 REM 
8470 REM MAKE SURE HE'S CARRYING ITEM * Z3
8480 REM
8490 IF S ( Z3 ) = - 1 THEN 8530
8500 PRINT "You don't have the " ; A$
8510 Z5 = 0
8520 RETURN
8530 Z5 = 1
8540 RETURN
8550 REM  *** DWARF ***
8560 IF D3 <> 0 THEN 8640
8570 REM SHOULD DWARF GIVE AWAY AXE?
8580 IF L1 < 13 THEN 8790
8590 IF RND > 0.05 THEN 8790
8600 REM GIVE AWAY AXE
8610 Z59 = 80 : GOSUB 7620
8620 S ( 27 ) = L1 : D3 = 1
8630 GOTO 8790
8640 REM SHOULD DWARF ATTACK?
8650 IF L1 >= 13 THEN 8660
8652 S ( 35 ) = 0 : GOTO 8790
8660 IF S ( 35 ) <> L1 THEN 8770
8661 IF ( L1 <> 60 AND L1 <> 61 ) OR T <> 1 THEN 8670
8662 Z59 = 299 : GOSUB 7620
8663 S ( 35 ) = 0 : GOTO 8790
8670 IF RND > 0.5 THEN 8790
8680 REM YES!
8690 Z59 = 32 : GOSUB 7620
8700 REM DOES THE KNIFE KILL THE PLAYER?
8705 KC = KC - 0.02
8706 IF KC >= 0.75 THEN 8710
8707 KC = 0.75
8710 IF RND <= KC THEN 8750
8720 REM YES
8730 PRINT "It gets you!"
8740 DEAD = 1 : GOTO 8790
8750 PRINT "It misses!"
8760 GOTO 8790
8770 REM SHOULD WE PUT A DWARF HERE?
8780 IF RND >= 0.05 THEN 8790
8781 IF ( L1 = 60 OR L1 = 61 ) AND T = 1 THEN 8790
8785 S ( 35 ) = L1
8786 Z59 = 31 : GOSUB 7620
8790 RETURN
8800 REM *** PIRATE ***
8810 REM FIRST, DOES HE HAVE ANYTHING WORTH STEALING?
8820 Z3 = 0
8830 IF L1 < 13 THEN 8960
8840 FOR X = 1 TO 15
8850 IF S ( X ) <> - 1 THEN 8860
8855 Z3 = Z3 + 1
8860 NEXT X
8870 IF Z3 < INT ( RND * 4 ) + 1 THEN 8960
8880 REM SHOULD WE RIP OFF HIS VALUABLES?
8890 IF RND < 0.05 THEN 8920
8900 Z59 = 34 : GOSUB 7620
8910 GOTO 8960
8920 Z59 = 33 : GOSUB 7620
8930 FOR X = 1 TO 15
8940 IF S ( X ) <> - 1 THEN 8950
8945 S ( X ) = 100
8950 NEXT X
8960 RETURN
8970 REM *** SAVE GAME ***
8980 INPUT "What do you want to call the save file? " , A$
8990 OPEN A$ FOR OUTPUT AS # 5 ELSE 9010
9000 GOTO 9030
9010 PRINT "File " , A$ , " not created"
9020 GOTO 410
9030 PRINT # 5 , T1 , "," , T2 , "," , T3 , "," , L1 , "," , L2 , "," , G , "," , B0 , "," , SN , "," , D1 , "," , D2 , "," , D0 , "," , T , "," , B1 , "," , B2 , "," , P1 , "," , L , "," , C , "," , D3 , "," , B3 , "," , R0 , "," , KC
9040 FOR X = 1 TO 99
9041 PRINT # 5 , S ( X ) , "," , V ( X )
9042 NEXT X
9043 PRINT # 5 , V ( 100 )
9044 CLOSE # 5
9050 PRINT "Game saved"
9051 C0 = 0
9060 IF K ( 1 ) = 143 OR K ( 2 ) = 143 THEN 9750
9070 GOTO 410
9080 REM *** LOAD OLD GAME ***
9090 IF C0 = 0 THEN 9120
9100 PRINT "You already have a loaded game!"
9110 GOTO 410
9120 INPUT "Save file name? " , A$
9130 OPEN A$ FOR INPUT AS # 5 ELSE 9150
9140 GOTO 9170
9150 PRINT "Unable to use file " ; A$
9160 GOTO 410
9170 INPUT # 5 , T1 , T2 , T3 , L1 , L2 , G , B0 , SN , D1 , D2 , D0 , T , B1 , B2 , P1 , L , C , D3 , B3 , R0 , KCX$
9171 KC = VAL ( KCX$ )
9180 FOR X = 1 TO 99
9191 INPUT # 5 , SX , VX : S ( X ) = SX : V ( X ) = VX
9192 NEXT X
9193 INPUT # 5 , VX : V ( 100 ) = VX
9194 CLOSE # 5
9200 C0 = 1
9210 GOTO 300
9220 REM *** READ THE MAGAZINE ***
9230 GOSUB 8280
9240 IF Z3 = 25 THEN 9270
9250 Z59 = 74 : GOSUB 7620
9260 GOTO 410
9270 IF S ( 25 ) = - 1 THEN 9300
9280 B$ = "magazine"
9290 GOTO 2710
9300 REM OK, LET HIM READ IT
9310 Z59 = 303 : GOSUB 7620
9320 GOTO 400
9330 REM *** BUG ***
9340 A$ = "ADVBUGS.TXT"
9341 OPEN A$ FOR APPEND AS # 5 ELSE 9150
9390 INPUT "Your name: " , A$
9400 A$ = A$ + " " + DATE$
9410 PRINT # 5 , A$
9420 PRINT "Enter your gripe in up to five lines (hit return to quit):"
9430 FOR Z0 = 1 TO 5
9440 PRINT Z0 ;
9450 INPUT A$
9460 IF A$ = "" THEN 9490
9470 PRINT # 5 , A$
9480 NEXT Z0
9490 PRINT "Message recorded. Thank you!"
9500 CLOSE # 5
9510 GOTO 410
9540 REM REINCARNATE HIM
9550 R0 = R0 + 1
9560 IF R0 = 1 THEN 9580
9561 IF R0 = 2 THEN 9610
9562 IF R0 = 3 THEN 9740
9570 REM ASK HIM IF HE WANTS TO BE REINCARNATED
9580 Z59 = 75 : GOSUB 7620
9590 GOSUB 9860
9600 GOTO 9630
9610 Z59 = 77 : GOSUB 7620
9620 GOTO 9580
9630 IF Z0 = 0 THEN 9750
9640 Z59 = 76 : GOSUB 7620
9650 REM PUT HIM BACK IN HOUSE, REARRANGE HIS STUFF
9660 S ( 18 ) = 7 : L = 0 : DEAD = 0 : KC = 1.03
9670 FOR X = 1 TO T2
9680 IF S ( X ) <> - 1 THEN 9690
9685 S ( X ) = L1
9690 NEXT X
9700 REM WE'VE PUT THE LAMP IN HOUSE AND OTHER ITEMS WHERE HE DIED
9710 L1 = INT ( RND * 4 ) + 1 : L2 = L1
9720 GOTO 320
9730 REM THIRD DEATH--END OF GAME
9740 Z59 = 78 : GOSUB 7620
9750 PRINT "Oh well..."
9760 GOSUB 6430
9762 CLOSE # 1 : CLOSE # 2 : CLOSE # 3
9770 STOP
9780 REM *** PITS ***
9790 IF L1 < 13 THEN 300
9791 IF L = 1 AND ( S ( 18 ) = - 1 OR S ( 18 ) = L1 ) THEN 300
9800 REM IS HE GOING TO FALL INTO A PIT?
9810 IF L1 = 16 OR L1 = 17 OR L1 = 19 OR L1 = 20 OR L1 = 25 OR L1 = 47 OR L1 = 48 OR L1 = 59 OR L1 = 60 OR L1 = 61 OR L1 = 75 OR L1 = 76 OR L1 = 98 THEN 9840
9820 GOTO 300
9830 REM he fell into a pit
9840 Z59 = 44 : GOSUB 7620
9850 GOTO 9540
9860 REM *** SEEK A "YES" OR "NO"
9870 INPUT A$
9875 IF LEN ( A$ ) <> 0 THEN 9880
9877 A$ = " "
9880 A$ = LOWER$ ( MID$ ( A$ , 1 , 1 ) )
9890 IF A$ <> "y" AND A$ <> "n" THEN 9930
9900 IF A$ = "y" THEN 9901 ELSE 9910
9901 Z0 = 1
9910 IF A$ = "n" THEN 9911 ELSE 9920
9911 Z0 = 0
9920 GOTO 9945
9930 PRINT "Yes or No-" ;
9940 GOTO 9870
9945 RETURN
9950 REM   ---- SHORT NAMES FOR STUFF ----
9961 DATA "large gold nugget"
9962 DATA "bars of silver"
9963 DATA "precious jewelry"
9964 DATA "many coins"
9965 DATA "several diamonds"
9966 DATA "fragile ming vase"
9967 DATA "glistening pearl"
9968 DATA "nest of golden eggs"
9969 DATA "jewel-encrusted trident"
9970 DATA "egg-sized emerald"
9971 DATA "platinum pyramid"
9972 DATA "golden chain"
9973 DATA "rare spices"
9974 DATA "persian rug"
9975 DATA "treasure chest"
9976 DATA "water"
9977 DATA "oil"
9978 DATA "brass lamp"
9979 DATA "keys"
9980 DATA "food"
9981 DATA "bottle"
9982 DATA "wicker cage"
9983 DATA "3-foot black rod"
9984 DATA "clam"
9985 DATA "magazine"
9986 DATA "bear"
9987 DATA "axe"
9988 DATA "velvet pillow"
9989 DATA "shards of pottery"
9990 DATA "oyster"
9991 DATA "bird"
9992 DATA "troll"
9993 DATA "dragon"
9994 DATA "snake"
9995 DATA "dwarf"
9996 DATA "rock"
9997 DATA "stairs"
9998 DATA "steps"
9999 DATA "house"
10000 DATA "grate"
10001 DATA "stream"
10002 DATA "room"
10003 DATA "bridge"
10004 DATA "pit"
10005 DATA "volcano"
10006 DATA "road"
10007 DATA "everything"
12500 REM INITIALIZE MESSAGE INDEX
12501 OPEN "AMESSAGE.IDX" FOR INPUT AS # 6 ELSE 12505
12502 GOTO 12610
12504 REM Message indx file doesn't exist, create it
12505 OPEN "AMESSAGE.IDX" FOR OUTPUT AS # 6
12506 FPOS = - 2 : B$ = "" : FRACNT = 0 : LASTFRA = - 1 : FSEEK # 3 , 0
12520 FPOS = FPOS + LEN ( B$ ) + 2
12522 INPUT # 3 , B$
12530 IF LEN ( B$ ) = 0 THEN 12531 ELSE 12540
12531 B$ = " " : FPOS = FPOS - 1
12540 IF B$ = "#" THEN 12591
12550 IF INSTR ( B$ , "#" ) = 0 THEN 12520
12560 Z4 = VAL ( MID$ ( B$ , 2 ) )
12570 IF INT ( Z4 ) = Z4 THEN 12580
12571 FRACNT = FRACNT + 1
12572 IF LASTFRA = INT ( Z4 ) THEN 12574
12573 INDX ( INT ( Z4 ) ) = FRACNT : LASTFRA = INT ( Z4 ) : PRINT # 6 , INT ( Z4 ) , "," , FRACNT
12574 FRAINDX ( FRACNT ) = FPOS
12576 GOTO 12585
12580 INDX ( INT ( Z4 ) ) = FPOS
12581 PRINT # 6 , INT ( Z4 ) , "," , FPOS
12585 PRINT "*" ;
12590 GOTO 12520
12591 PRINT # 6 , - 999 , "," , - 999
12592 FOR I = 1 TO FRACNT
12593 PRINT # 6 , FRAINDX ( I )
12594 NEXT I
12595 PRINT # 6 , - 999
12596 CLOSE # 3
12597 OPEN "AMESSAGE" FOR INPUT AS # 3
12600 GOTO 12670
12604 REM READ AMESSAGE.IDX FILE INTO ARRAYS
12610 INPUT # 6 , II , I
12612 PRINT "*" ;
12615 IF I = - 999 THEN 12630
12620 INDX ( II ) = I : GOTO 12610
12630 II = 0
12640 INPUT # 6 , I
12641 PRINT "*" ;
12650 IF I = - 999 THEN 12670
12660 II = II + 1 : FRAINDX ( II ) = I : GOTO 12640
12670 CLOSE # 6 : PRINT : PRINT
12680 RETURN
