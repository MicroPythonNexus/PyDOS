10,0
11,61
12,124
13,174
14,181
15,245
16,322
17,395
18,402
19,486
20,565
21,617
22,660
23,730
44,799
45,877
46,902
47,922
50,944
51,960
52,977
53,992
54,1008
70,2350
110,2385
130,2404
150,2444
160,2483
161,2589
162,2694
170,2708
171,2729
172,2761
175,2773
182,2805
190,2845
192,2897
193,2919
194,2993
195,3115
196,3238
197,3254
198,3266
200,3280
210,3296
220,3334
221,3362
222,3500
228,3516
230,-3528
231,-3560
232,-3591
233,-3624
234,-3652
235,-3683
236,-3712
240,3745
241,3773
242,3911
243,3927
245,-3939
246,-3966
247,-3993
260,4020
263,4055
264,4082
266,4097
267,4125
280,4152
300,4185
310,4211
320,4259
321,4294
330,4356
340,4382
350,4395
360,4434
370,4451
375,4466
380,4492
390,4507
400,4573
410,4605
420,4645
425,4669
431,4698
432,4727
433,4750
449,4790
450,4854
460,4882
470,4919
471,4995
480,5056
490,5067
500,5106
510,5206
520,5256
800,5280
870,5319
871,5372
872,5442
873,5470
874,5523
890,5593
900,5614
910,5626
920,5674
930,5731
940,5746
950,5802
980,5815
990,5865
1000,5915
1010,5947
1020,5968
1030,6023
1040,6035
1050,6068
1060,6083
1070,6114
1130,6140
1140,6167
1150,6204
1160,6227
1170,6270
1180,6285
1190,6308
1191,6350
1200,6369
1220,6384
1221,6397
1230,6413
1240,6427
1250,6460
1260,6475
1261,6525
1270,6584
1280,6625
1290,6649
1300,6676
1310,6690
1320,6727
1330,6789
1340,6816
1350,6830
1360,6866
1370,6931
1380,6952
1390,6978
1400,6992
1410,7018
1420,7074
1430,7099
1440,7126
1460,7140
1470,7180
1480,7207
1490,7235
1500,7262
1510,7276
1520,7294
1530,-7315
1540,7348
1550,7387
1560,7400
1570,7413
1580,7428
1590,7448
1600,7475
1610,7507
1620,7536
1630,7548
1640,7575
1650,7589
1660,7602
1670,7615
1680,7630
1690,7653
1691,7698
1700,7788
1710,7810
1720,7836
1730,7870
1740,7897
1750,7911
1760,7924
1770,7939
1780,7954
1781,7990
1790,8036
1800,8081
1810,8108
1820,8122
1821,8149
1830,8176
1840,8198
1850,8209
1860,8224
1870,8279
1880,8306
1890,8320
1900,8382
1910,8398
1920,8425
1940,8439
1950,8463
1960,8529
1980,8595
1990,8621
1991,8670
2000,8729
2020,8750
2021,8798
2022,8820
2023,8833
2030,8847
2040,8859
2050,8877
2051,8915
2052,8928
2060,8940
2070,-8954
2080,9053
2090,9067
2095,9086
2110,9380
2120,9395
2130,9418
2140,9444
2150,9484
2160,9497
2170,9512
2180,9539
2190,9551
2200,9566
2210,9592
2220,9606
2230,9629
2240,9655
2250,9695
2260,9708
2270,9723
2280,9750
2290,9762
2300,9777
2310,9832
2320,9858
2325,9891
2330,9909
2335,9943
2340,9962
2350,9975
2360,9990
2370,10017
2380,10030
2390,10045
2400,10068
2410,10095
2420,10121
2430,10147
2440,10161
2450,10172
2460,10223
2470,10238
2480,10265
2490,10290
2500,10301
2510,10316
2520,10343
2530,10354
2540,10369
2550,10396
2560,10407
2570,10422
2580,10445
2590,10472
2600,10505
2610,10530
2620,10543
2630,10556
2640,10571
2650,10611
2660,10677
2670,10703
2680,10718
2690,10732
2700,10765
2710,10784
2720,10822
2730,10836
2740,10861
2750,10887
2760,10901
2770,10990
2780,11019
2790,11034
2800,11060
2810,11076
2820,11115
2830,11129
2840,11158
2850,11197
2860,11211
2870,11234
2880,11267
2890,11282
2900,11319
2910,11351
2920,11372
2930,11386
2940,11408
2941,11445
2950,11509
2960,11536
2970,11550
2980,11566
2990,11582
3000,11596
3010,11619
3020,11652
3030,11669
3040,11684
3050,11695
3060,11710
3070,11745
3080,11760
3090,11794
3100,11827
3110,11842
3120,11866
3130,11881
3140,11904
3150,11930
3160,11948
3170,11959
3180,11974
3190,12001
3200,12025
3210,12036
3240,12051
3250,12081
3260,12107
3270,12145
3280,12157
3290,12172
3300,12194
3310,12220
3320,12241
3330,12252
3340,12267
3350,12294
3360,12321
3370,12332
3400,12347
3410,12368
3420,12394
3430,12432
3440,12444
3450,12459
3470,12486
3480,12498
3490,12531
3510,12552
3511,12585
3520,12617
3530,12631
3540,12648
3550,12660
3551,12695
3560,12717
3570,12728
3590,12742
3630,12763
3640,12810
3650,12826
3660,12851
3670,12874
3680,12889
3710,12911
3720,12958
3730,13008
3740,13041
3750,13073
3760,13120
3770,13179
3780,13194
3790,13246
3800,13258
3810,13279
3811,13312
3820,13329
3830,13341
3840,13366
3850,13393
3860,13420
3870,13434
3880,13449
3890,13469
3900,13525
3910,13538
3920,13552
3940,13574
3950,13621
3960,13637
3970,13662
3980,13686
4000,13701
4030,13723
4040,13770
4050,13820
4060,13851
4070,13884
4080,13931
4090,13999
4100,14014
4110,14078
4120,14093
4130,14151
4140,14170
4150,14183
4160,14197
4170,14220
4180,14236
4190,14261
4200,14286
4210,14301
4220,14335
4230,14387
4240,14420
4241,14447
4260,14484
4270,14536
4280,14570
4281,14597
4300,14627
4310,14679
4320,14709
4330,14737
4340,14764
4350,14780
4360,14795
4361,14822
4380,14852
4390,14893
4391,14926
4400,14942
4410,14963
4415,14982
4420,15009
4430,15023
4440,15047
4450,15063
4460,15127
4470,15155
4480,15182
4490,15196
4500,15223
4501,15250
4520,15288
4530,15321
4540,15352
4560,15384
4570,15429
4580,15464
4590,15491
4600,15505
4610,15532
4620,15559
4630,15573
4640,15595
4650,15611
4660,15638
4670,15665
4680,15692
4690,15706
4700,15739
4720,15768
4730,15794
4740,15824
4750,15851
4760,15865
4770,15897
4790,15947
4800,15961
4810,15984
4820,16017
4840,16047
4850,16074
4851,16111
4852,16136
4853,16161
4860,16186
4870,16212
4890,16259
4900,16285
4920,16332
4930,16358
4950,16405
4960,16427
4970,16464
4980,16490
4990,16505
5000,16538
5020,16567
5040,16602
5060,16616
5070,16640
5080,16674
5090,16714
5110,16749
5120,16763
5130,16790
5140,16815
5150,16842
5160,16856
5165,16881
5170,16901
5180,16928
5190,16942
5200,16964
5210,17011
5220,17049
5230,17075
5240,17089
5250,17123
5260,17151
5270,17171
5280,17198
5290,17223
5300,17241
5310,17303
5320,17329
5330,17356
5350,17394
5360,17420
5380,17451
5381,17487
5390,17525
5400,17543
5410,17557
5420,17579
5430,17629
5440,17662
5460,17690
5470,17721
5480,17761
5490,17774
5491,17806
5492,17831
5500,17856
5510,17883
5530,17906
5540,17933
5560,17956
5570,17978
5580,17994
5590,18019
5610,18052
5620,18078
5630,18110
5650,18160
5660,18186
5680,18243
5690,18275
5700,18302
5710,18316
5720,18347
5730,18403
5740,18436
5750,18509
5760,18523
5770,18546
5780,18562
5790,18588
5800,18615
5810,18629
5820,18642
5830,18692
5840,18725
5860,18753
5870,18780
5880,18810
5890,18835
5900,18895
5910,18909
5920,18930
5930,18977
5940,19004
5950,19018
5970,19044
5980,19068
6000,19095
6010,19118
6020,19165
6030,19192
6040,19206
6060,19232
6070,19256
6071,19283
6090,19321
6100,19354
6110,19380
6120,19406
6130,19420
6140,19452
6150,19478
6160,19505
6180,19533
6190,19562
6200,19580
6210,19609
6220,19636
6230,19650
6240,19673
6250,19705
6270,19728
6280,19750
6290,19781
6310,19804
6320,19827
6330,19898
6350,19921
6360,19943
6370,19968
6380,19984
6390,20009
6400,20024
6410,20043
6420,20059
6430,20073
6440,20103
6450,20119
6451,20156
6460,20226
6470,-20244
6480,20316
6481,20351
6482,20377
6483,20389
6484,20411
6485,20424
6490,20437
6500,20490
6510,20502
6520,20533
6530,20550
6540,20571
6550,20593
6560,20606
6570,20631
6575,20663
6580,20691
6585,20723
6590,20751
6600,20764
6605,20905
6610,21019
6620,21041
6621,21073
6630,21104
6640,21117
6660,21129
6680,21164
6690,21183
6700,21205
6710,21225
6711,21258
6720,21272
6721,21285
6722,21319
6730,21346
6740,21378
6745,21394
6750,21421
6760,21437
6770,21448
6775,21460
6780,21498
6820,21517
6830,21539
6840,21559
6850,21572
6860,21590
6870,21604
6880,21616
6890,21638
6900,21694
6910,21735
6920,21762
6930,21776
6940,21820
6950,21835
6960,21862
6970,21877
6980,21912
6990,21958
7000,21985
7010,22000
7020,22045
7030,22069
7040,22096
7050,22111
7060,22156
7070,22195
7080,22228
7090,22243
7100,22284
7110,22322
7140,22376
7150,22403
7160,22425
7170,22451
7180,22491
7210,22545
7220,22578
7240,22607
7250,22640
7260,22665
7280,22706
7290,22731
7300,22758
7310,22773
7320,22815
7330,22856
7340,22889
7360,22914
7370,22929
7380,22953
7390,22980
7400,23002
7410,23046
7415,23073
7420,23098
7425,23124
7430,23149
7440,23164
7450,23201
7460,23228
7470,23244
7480,23269
7490,23315
7500,23344
7520,23380
7530,23425
7541,23469
7542,23535
7543,23562
7550,23615
7560,23641
7570,23673
7580,23705
7581,23732
7600,23776
7610,23803
7619,23818
7620,23841
7630,23875
7640,23892
7645,23937
7650,23978
7660,24037
7670,24059
7672,24080
7673,24124
7690,24139
7700,24181
7705,24216
7710,24251
7712,24286
7720,24321
7730,24342
7740,24387
7750,24402
7760,24417
7770,24470
7800,24482
7810,24491
7820,24523
7830,24532
7840,24547
7842,24594
7850,24629
7860,24653
7861,24715
7870,24742
7880,24763
7881,24813
7890,24840
7900,24859
7901,24906
7910,24933
7920,24948
7921,25009
7930,25036
7940,25050
7941,25097
7950,25124
7951,25171
7960,25198
7970,25220
7971,25267
7980,25299
7990,25311
8000,25320
8010,25380
8020,25434
8030,25460
8040,25522
8050,25540
8060,25565
8070,25593
8080,25608
8090,25665
8100,25693
8110,25708
8120,25736
8130,25769
8180,25781
8190,25839
8200,25902
8201,25943
8202,25959
8210,25974
8220,26031
8230,26049
8235,26065
8240,26077
8250,26086
8260,26133
8270,26178
8280,26214
8300,26245
8320,26267
8330,26317
8340,26334
8350,26377
8351,26419
8352,26471
8360,26484
8370,26497
8380,26510
8390,26522
8400,26555
8410,26567
8415,26589
8430,26614
8431,26671
8440,26713
8450,26726
8460,26738
8470,26747
8480,26790
8490,26799
8500,26832
8510,26870
8520,26882
8530,26894
8540,26906
8550,26918
8560,26942
8570,26968
8580,27005
8590,27031
8600,27060
8610,27083
8620,27110
8630,27138
8640,27153
8650,27183
8652,27210
8660,27240
8661,27273
8662,27327
8663,27355
8670,27385
8680,27413
8690,27427
8700,27454
8705,27495
8706,27515
8707,27544
8710,27559
8720,27587
8730,27600
8740,27626
8750,27652
8760,27676
8770,27691
8780,27728
8781,27758
8785,27809
8786,27828
8790,27855
8800,27867
8810,27891
8820,27945
8830,27957
8840,27983
8850,28004
8855,28037
8860,28054
8870,28066
8880,28109
8890,28151
8900,28180
8910,28207
8920,28222
8930,28249
8940,28270
8945,28303
8950,28322
8960,28334
8970,28346
8980,28373
8990,28432
9000,28473
9010,28488
9020,28529
9030,28543
9040,28779
9041,28800
9042,28841
9043,28853
9044,28880
9050,28895
9051,28919
9060,28931
9070,28980
9080,28994
9090,29025
9100,29050
9110,29095
9120,29109
9130,29144
9140,29184
9150,29199
9160,29237
9170,29251
9171,29369
9180,29392
9191,29413
9192,29468
9193,29480
9194,29517
9200,29532
9210,29544
9220,29558
9230,29593
9240,29609
9250,29635
9260,29662
9270,29676
9280,29709
9290,29730
9300,29745
9310,29774
9320,29802
9330,29816
9340,29837
9341,29861
9390,29902
9400,29932
9410,29959
9420,29979
9430,30051
9440,30072
9450,30088
9460,30102
9470,30128
9480,30148
9490,30161
9500,30203
9510,30218
9540,30232
9550,30257
9560,30274
9561,30299
9562,30324
9570,30349
9580,30397
9590,30424
9600,30440
9610,30455
9620,30482
9630,30497
9640,30522
9650,30549
9660,30601
9670,30650
9680,30671
9685,30704
9690,30722
9700,30734
9710,30801
9720,30841
9730,30855
9740,30889
9750,30916
9760,30940
9762,30956
9770,30995
9780,31005
9790,31027
9791,31052
9800,31115
9810,31156
9820,31314
9830,31328
9840,31356
9850,31383
9860,31398
9870,31432
9875,31446
9877,31480
9880,31494
9890,31535
9900,31577
9901,31614
9910,31626
9911,31663
9920,31675
9930,31690
9940,31716
9945,31731
9950,31743
9961,-31786
9962,-31816
9963,-31843
9964,-31872
9965,-31895
9966,-31924
9967,-31954
9968,-31983
9969,-32015
9970,-32051
9971,-32081
9972,-32110
9973,-32135
9974,-32159
9975,-32183
9976,-32210
9977,-32228
9978,-32244
9979,-32267
9980,-32284
9981,-32301
9982,-32320
9983,-32344
9984,-32373
9985,-32390
9986,-32411
9987,-32428
9988,-32444
9989,-32470
9990,-32500
9991,-32519
9992,-32536
9993,-32554
9994,-32573
9995,-32591
9996,-32609
9997,-32626
9998,-32645
9999,-32663
10000,-32681
10001,-32700
10002,-32720
10003,-32738
10004,-32758
10005,-32775
10006,-32796
10007,-32814
12500,32838
12501,32873
12604,32916
12610,32961
12612,32986
12615,33004
12620,33034
12630,33069
12640,33082
12641,33102
12650,33120
12660,33150
12670,33202
12680,33234
-999,-999
10 REM ADVENTURE/3000 VERSION 3.2     27 FEB 1979 AT 5:30 PM
11 REM THIS PROGRAM IS RELATIVELY BUG-FREE, BUT ONE STILL MUST
12 REM realize that murphy 'S LAW STILL PREVAILS!
13 REM
14 REM ADVENTURE: PROGRAMMED IN HP/3000 BASIC BY BENJAMIN MOSER
15 REM JAMES MADISON HIGH SCHOOL, VIENNA, VIRGINIA.  THE BASIC LAYOUT OF THE
16 REM GAME WAS CONCEIVED BY DON WOODS & WILLIE CROWTHER, BOTH OF M.I.T.
17 REM
18 REM ADVENTURE WAS PORTED TO THE MACINTOSH PLUS BY THE ELIZABETH AND DAVID HUNTER
19 REM IN MARCH 1998 AND THEN TO PYBASIC FOR THE RASPBERRY RP2040 IN JUNE 2021
20 REM print "Adventure 3.2 on ";date$;" at ";time$
21 PRINT "Adventure 3.2 for micro PyBasic"
22 OPEN "AMESSAGE" FOR INPUT AS # 3 : OPEN "AMOVING" FOR INPUT AS # 4
23 OPEN "ADESCRIP" FOR INPUT AS # 1 : OPEN "AITEMS" FOR INPUT AS # 2
44 REM dirs is an array of possible room directions, it replaces file AMOVING
45 DIM DIRS ( 100 , 10 )
46 DIM INDX ( 303 )
47 DIM FRAINDX ( 10 )
50 DIM S ( 99 )
51 DIM V ( 100 )
52 DIM K ( 2 )
53 DIM O ( 15 )
54 STRING$ = "100 N 101 NE 102 E 103 SE 104 S 105 SW 106 W 107 NW 108 U 109 D 110 PLUGH 111 XYZZY 112 PLOVER 113 CROSS 114 CLIMB 115 JUMP 116 FILL 117 EMPTY 117 POUR 118 LOOK 118 L 119 LIGHT 119 ON 120 EXTINGUISH 120 OFF 121 IN 121 ENTER 122 LEAVE 122 OUT 123 INVENTORY 123 I 124 GET 124 CATCH 124 TAKE 125 DROP 125 DUMP 047 ALL 047 EVERYTHING 126 THROW 127 ATTACK 127 KILL 128 FEED 129 WATER 130 LOCK 131 UNLOCK 132 FREE 132 RELEASE 133 WAVE 134 OPEN 135 CLOSE 136 OIL 137 EAT 138 DRINK 139 FEE FIE FOE FOO 140 SHORT 141 LONG 142 BRIEF 143 QUIT 143 STOP 143 END 144 SCORE 145 SAVE 146 LOAD 147 READ 147 EXAMINE 148 YES 148 Y 149 BUG 001 GOLD 001 NUGGET 002 BARS 002 SILVER 003 JEWELRY 004 COINS 005 DIAMONDS 006 MING 006 VASE 007 PEARL 008 EGGS 008 NEST 009 TRIDENT 010 EMERALD 011 PLATINUM 011 PYRAMID 012 CHAIN 013 SPICES 014 PERSIAN 014 RUG 015 TREASURE 015 CHEST 016 WATER 017 OIL 018 LAMP 018 LANTERN 019 KEYS 020 FOOD 021 BOTTLE 022 CAGE 023 ROD 023 WAND 024 CLAM 025 MAGAZINE 026 BEAR 027 AXE 028 VELVET 028 PILLOW 029 SHARDS 030 OYSTER 031 BIRD 032 TROLL 033 DRAGON 034 SNAKE 035 DWARF 036 ROCK 036 BOULDER 037 STAIRS 038 STEPS 039 HOUSE 039 BUILDING 040 GRATE 041 STREAM 042 ROOM 043 BRIDGE 044 PIT 045 VOLCANO 046 ROAD 100 NORTH 101 NORTHEAST 102 EAST 103 SOUTHEAST 104 SOUTH 105 SOUTHWEST 106 WEST 107 NORTHWEST 108 UP 109 DOWN "
70 PRINT : PRINT "Initializing." ;
110 REM initialize
130 REM total rooms, items,and keywords
150 L1 = INT ( RND * 4 ) + 1 : L2 = L1
160 G = 0 : B0 = 1 : SN = 1 : D1 = 1 : D2 = 0 : T = 1 : B1 = 0 : B2 = 0 : P1 = 0 : DEAD = 0 : LASTC$ = ""
161 L = 0 : C = 0 : D3 = 0 : B3 = 0 : D0 = 2 : T1 = 100 : T2 = 35 : T3 = 149 : R0 = 0 : C0 = 0 : C$ = ""
162 KC = 1.02
170 FOR II = 1 TO 99
171 S ( II ) = 0 : V ( II ) = 0
172 NEXT II
175 PRINT "." ; : V ( 100 ) = 0
182 INDX ( 1 ) = - 1 : INDX ( 2 ) = - 1
190 REM   read in possible movement direction array
192 FOR Z2 = 1 TO 100
193 INPUT # 4 , DX1 , DX2 , DX3 , DX4 , DX5 , DX6 , DX7 , DX8 , DX9 , DX0
194 DIRS ( Z2 , 1 ) = DX1 : DIRS ( Z2 , 2 ) = DX2 : DIRS ( Z2 , 3 ) = DX3 : DIRS ( Z2 , 4 ) = DX4 : DIRS ( Z2 , 5 ) = DX5
195 DIRS ( Z2 , 6 ) = DX6 : DIRS ( Z2 , 7 ) = DX7 : DIRS ( Z2 , 8 ) = DX8 : DIRS ( Z2 , 9 ) = DX9 : DIRS ( Z2 , 10 ) = DX0
196 PRINT "." ;
197 NEXT Z2
198 CLOSE # 4
200 RESTORE 230
210 REM    read in locations of items
220 FOR Z2 = 1 TO T2 STEP 5
221 READ DX1 , DX2 , DX3 , DX4 , DX5 : S ( Z2 ) = DX1 : S ( Z2 + 1 ) = DX2 : S ( Z2 + 2 ) = DX3 : S ( Z2 + 3 ) = DX4 : S ( Z2 + 4 ) = DX5
222 PRINT "." ;
228 NEXT Z2
230 DATA 18 , 25 , 23 , 24 , 21
231 DATA 52 , 0 , 71 , 74 , 58
232 DATA 59 , 69 , 66 , 82 , 100
233 DATA 7 , 49 , 7 , 7 , 7
234 DATA 7 , 12 , 13 , 40 , 38
235 DATA 69 , 0 , 46 , 0 , 0
236 DATA 15 , 60 , 82 , 22 , 250
240 FOR II = 1 TO 15 STEP 5
241 READ DX1 , DX2 , DX3 , DX4 , DX5 : O ( II ) = DX1 : O ( II + 1 ) = DX2 : O ( II + 2 ) = DX3 : O ( II + 3 ) = DX4 : O ( II + 4 ) = DX5
242 PRINT "." ;
243 NEXT II
245 DATA 1 , 2 , 2 , 2 , 2
246 DATA 3 , 4 , 3 , 3 , 2
247 DATA 5 , 3 , 2 , 3 , 3
260 REM ASK IF HE WANTS DIRECTIONS
263 Z59 = 301 : GOSUB 7620
264 GOSUB 9860
266 IF Z0 THEN 267 ELSE 320
267 Z59 = 302 : GOSUB 7620
280 REM    command input routine
300 REM print room, items
310 REM If it's dark don't let him see anything
320 IF L1 < 13 OR L1 = 58 THEN 350
321 IF L = 1 AND ( S ( 18 ) = L1 OR S ( 18 ) = - 1 ) THEN 350
330 Z59 = 45 : GOSUB 7620
340 GOTO 400
350 ON D0 + 1 GOSUB 6780 , 7990 , 8180
360 V ( L1 ) = 1
370 GOSUB 6680
375 IF DEAD = 1 THEN 9540
380 GOSUB 7800
390 REM INPUT LOOP --- MULTIPLE COMMAANDS, REMOVE JUNK CHARACTERS
400 REM if len(c$) > 0 then 500
410 INPUT ">" , C$ : C$ = UPPER$ ( C$ )
420 IF C$ = "" THEN 410
425 PRINT : PRINT : NKEY = 0
431 IF C$ <> LASTC$ THEN 433
432 C$ = "" : GOTO 900
433 NUMKEYS = 1 : LASTC$ = C$ : A$ = ""
449 REM    65-90 = A-Z               48-57 = 0-9         46 = .
450 FOR X = 1 TO LEN ( C$ )
460 Z5 = ASC ( MID$ ( C$ , X , 1 ) )
470 IF ( Z5 > 64 AND Z5 < 91 ) OR ( Z5 > 47 AND Z5 < 58 ) THEN 480 ELSE 471
471 C$ = MID$ ( C$ , 1 , X - 1 ) + " " + MID$ ( C$ , X + 1 )
480 NEXT X
490 IF INSTR ( C$ , " " ) = 0 THEN 520
500 NUMKEYS = 2 : A$ = MID$ ( C$ , INSTR ( C$ , " " ) , LEN ( C$ ) - INSTR ( C$ , " " ) + 1 ) + " "
510 C$ = MID$ ( C$ , 1 , INSTR ( C$ , " " ) - 1 )
520 C$ = " " + C$ + " "
800 K ( 1 ) = 0 : K ( 2 ) = 0 : Z3 = 0
870 A1 = INSTR ( STRING$ , C$ ) : IF A1 = 0 THEN 872
871 C$ = MID$ ( STRING$ , A1 - 3 , 3 ) : K ( 1 ) = INT ( VAL ( C$ ) )
872 IF NUMKEYS = 1 THEN 900
873 A1 = INSTR ( STRING$ , A$ ) : IF A1 = 0 THEN 900
874 B$ = MID$ ( STRING$ , A1 - 3 , 3 ) : K ( 2 ) = INT ( VAL ( B$ ) )
890 REM EXOTIC WORDS
900 Z0 = 36
910 IF K ( 1 ) >= Z0 AND K ( 1 ) <= 46 THEN 930
920 IF K ( 2 ) >= Z0 AND K ( 2 ) <= 46 THEN 930 ELSE 980
930 GOSUB 8390
940 PRINT "What do you want to do with the " ; D$ ; "?"
950 GOTO 410
980 IF K ( 1 ) >= 110 AND K ( 1 ) <= T3 THEN 1950
990 IF K ( 2 ) >= 110 AND K ( 2 ) <= T3 THEN 1950
1000 REM THEN IS IT A DIRECTION
1010 FOR D = 1 TO 10
1020 IF K ( 1 ) = D + 99 OR K ( 2 ) = D + 99 THEN 1070
1030 NEXT D
1040 REM COMMAND NOT A DIRECTION
1050 GOTO 1950
1060 REM CAN HE MOVE THAT WAY?
1070 Z2 = DIRS ( L1 , D )
1130 IF Z2 = 255 THEN 1470
1140 IF Z2 < 1 OR Z2 > 254 THEN 1220
1150 REM NORMAL MOVING
1160 REM CHECK FOR SPECIAL MOVE CONDITIONS
1170 GOTO 1260
1180 L2 = L1 : L1 = Z2
1190 IF S ( 35 ) = L2 THEN 1191 ELSE 1200
1191 S ( 35 ) = L1
1200 GOTO 9780
1220 Z59 = 1
1221 GOSUB 7620
1230 GOTO 400
1240 REM SPECIAL ROOM DIRECTIONS
1250 REM GRATE
1260 IF L1 = 10 AND ( D = 10 OR D = 5 ) THEN 1280
1261 IF L1 = 11 AND ( D = 9 OR D = 3 ) THEN 1280 ELSE 1320
1270 REM IF GRATE IS OPEN (G=0) MOVE HIM
1280 IF G = 1 THEN 1180
1290 Z59 = 10 : GOSUB 7620
1300 GOTO 400
1310 REM CAN'T TAKE NUGGET UPPSTAIRS
1320 IF NOT ( L1 = 17 AND D = 9 AND S ( 1 ) = - 1 ) THEN 1360
1330 Z59 = 38 : GOSUB 7620
1340 GOTO 400
1350 REM CRYSTAL BRIDGE AND FISSURE
1360 IF NOT ( L1 = 19 AND D = 7 OR L1 = 20 AND D = 3 ) THEN 1410
1370 IF B2 THEN 1180
1380 Z59 = 3 : GOSUB 7620
1390 GOTO 400
1400 REM MT. KING & SNAKE
1410 IF NOT ( L1 = 22 AND D <> 3 AND D <> 9 ) THEN 1690
1420 IF SN = 0 THEN 1180
1430 Z59 = 50 : GOSUB 7620
1440 GOTO 400
1460 REM bedquilt and random directiosn
1470 IF L1 <> 44 THEN 1590
1480 IF RND > 0.5 THEN 1510
1490 Z59 = 52 : GOSUB 7620
1500 GOTO 400
1510 RESTORE 1530
1520 REM ROOMS TO JU
1530 DATA 33 , 37 , 45 , 92 , 76
1540 FOR Z3 = 1 TO INT ( RND * 5 ) + 1
1550 READ Z2
1560 NEXT Z3
1570 GOTO 1180
1580 REM WITT's END
1590 IF L1 <> 39 THEN 1220
1600 REM SHOULD WE LET HIM OUT?
1610 IF RND < 0.15 THEN 1650
1620 REM NO
1630 Z59 = 52 : GOSUB 7620
1640 GOTO 400
1650 REM YES
1660 Z2 = 38
1670 GOTO 1180
1680 REM Narrow Tunnel
1690 IF NOT ( L1 = 57 OR L1 = 58 ) THEN 1780
1691 IF K ( 1 ) <> 102 AND K ( 2 ) <> 102 AND K ( 1 ) <> 106 AND K ( 2 ) <> 106 THEN 1780
1700 FOR Z3 = 1 TO T2
1710 IF Z3 = 10 THEN 1750
1720 IF S ( Z3 ) <> - 1 THEN 1750
1730 Z59 = 53 : GOSUB 7620
1740 GOTO 400
1750 NEXT Z3
1760 GOTO 1180
1770 REM TROLL
1780 IF L1 = 60 AND D = 2 THEN 1790
1781 IF L1 = 61 AND D = 6 THEN 1790 ELSE 1860
1790 ON T + 1 GOTO 1180 , 1800 , 1820 , 1840
1800 Z59 = 55 : GOSUB 7620
1810 GOTO 400
1820 Z59 = 56 : GOSUB 7620
1821 Z59 = 55 : GOSUB 7620
1830 T = 1 : GOTO 400
1840 T = 2
1850 GOTO 1180
1860 IF NOT ( L1 = 73 AND D = 1 AND D2 = 0 ) THEN 1890
1870 Z59 = 57 : GOSUB 7620
1880 GOTO 400
1890 IF NOT ( L1 = 82 AND S ( 33 ) = L1 AND D = 1 ) THEN 1180
1900 REM DRAGON
1910 Z59 = 51 : GOSUB 7620
1920 GOTO 400
1940 REM OTHER COMMANDS
1950 Z1 = K ( 1 ) : IF K ( 1 ) >= 110 AND K ( 1 ) <= T3 THEN 2090
1960 Z1 = K ( 2 ) : IF K ( 2 ) >= 110 AND K ( 2 ) <= T3 THEN 2090
1980 REM ITEM BO NO VERB?
1990 IF K ( 1 ) >= 1 AND K ( 1 ) <= 35 THEN 2000
1991 IF K ( 2 ) >= 1 AND K ( 2 ) <= 35 THEN 2000 ELSE 2040
2000 FOR X = 1 TO 35
2020 IF K ( 1 ) <> X AND K ( 2 ) <> X THEN 2030
2021 RESTORE 9960 + X
2022 READ D$
2023 GOTO 940
2030 NEXT X
2040 RESTORE 2070
2050 FOR X = 1 TO INT ( RND * 4 ) + 1
2051 READ B$
2052 NEXT X
2060 PRINT B$
2070 DATA "What?" , "I don't understand." , "I can't understand that." , "I don't know that word."
2080 GOTO 400
2090 Z1 = Z1 - 109
2095 ON Z1 GOTO 2120 , 2220 , 2300 , 2390 , 2570 , 2640 , 2680 , 2860 , 2930 , 3000 , 3080 , 3130 , 3290 , 3450 , 3590 , 3920 , 4160 , 4430 , 4630 , 4800 , 4950 , 5060 , 5190 , 5410 , 5560 , 5750 , 5810 , 5920 , 6000 , 6090 , 6230 , 6270 , 6310 , 6350 , 6410 , 8970 , 9080 , 9220 , 4490 , 9330
2110 GOTO 2040
2120 REM *** PLUGH ***
2130 IF L1 <> 7 THEN 2170
2140 IF S ( 35 ) = L1 THEN S ( 35 ) = 0
2150 Z2 = 26
2160 GOTO 1180
2170 IF L1 <> 26 THEN 2200
2180 Z2 = 7
2190 GOTO 1180
2200 Z59 = 2 : GOSUB 7620
2210 GOTO 400
2220 REM *** XYZZY ***
2230 IF L1 <> 7 THEN 2270
2240 IF S ( 35 ) = L1 THEN S ( 35 ) = 0
2250 Z2 = 13
2260 GOTO 1180
2270 IF L1 <> 13 THEN 2200
2280 Z2 = 7
2290 GOTO 1180
2300 REM *** PLOVER *** (CAN'T BRING EMERALD WITH HIM)
2310 IF L1 > 26 THEN 2360
2320 IF S ( 35 ) <> L1 THEN 2330
2325 S ( 35 ) = 0
2330 IF S ( 10 ) <> - 1 THEN 2340
2335 S ( 10 ) = L1
2340 Z2 = 58
2350 GOTO 1180
2360 IF L1 <> 58 THEN 2200
2370 Z2 = 26
2380 GOTO 1180
2390 REM *** CROSS ***
2400 IF L1 <> 19 THEN 2470
2410 IF B2 <> 0 THEN 2440
2420 Z59 = 3 : GOSUB 7620
2430 GOTO 400
2440 D = 7
2450 REM JUST GIVE NEW DIRECTION, USE MOVE ROUTINE
2460 GOTO 1070
2470 IF L1 <> 20 THEN 2510
2480 IF B2 = 0 THEN 2420
2490 D = 3
2500 GOTO 1070
2510 IF L1 <> 60 THEN 2540
2520 D = 2
2530 GOTO 1070
2540 IF L1 <> 61 THEN 2200
2550 D = 6
2560 GOTO 1070
2570 REM *** CLIMB ***
2580 IF L1 <> 50 THEN 2200
2590 REM CAN HE CLIMB BEANSTALK?
2600 IF P1 < 2 THEN 2200
2610 REM YES
2620 Z2 = 70
2630 GOTO 1180
2640 REM *** JUMP *** STRICTLY SUICIDAL
2650 IF L1 <> 16 AND L1 <> 19 AND L1 <> 20 AND L1 <> 27 THEN 2200
2660 Z59 = 4 : GOSUB 7620
2670 GOTO 9550
2680 REM FILL
2690 IF S ( 21 ) = - 1 THEN 2730
2700 B$ = "bottle"
2710 PRINT "You don't have the " ; B$
2720 GOTO 410
2730 IF B0 = 0 THEN 2760
2740 Z59 = 5 : GOSUB 7620
2750 GOTO 410
2760 IF L1 <> 7 AND L1 <> 8 AND L1 <> 9 AND L1 <> 35 AND L1 <> 74 AND L1 <> 81 THEN 2790
2770 B0 = 1 : S ( 16 ) = - 1
2780 GOTO 2840
2790 IF L1 = 49 THEN 2830
2800 B$ = "oil"
2810 PRINT "I see no " ; B$ ; " here."
2820 GOTO 400
2830 B0 = 2 : S ( 17 ) = - 1
2840 PRINT "The bottle is now filled."
2850 GOTO 400
2860 REM *** EMPTY ***
2870 IF S ( 21 ) = - 1 THEN 2890
2880 GOTO 2700
2890 REM EMPTY BOTTLE (ASSUMED FULL)
2900 S ( B0 + 15 ) = 0 : B0 = 0
2910 PRINT "Emptied"
2920 GOTO 400
2930 REM *** LOOK ***
2940 IF L1 < 13 OR L1 = 58 THEN 2970
2941 IF L = 1 AND ( S ( 18 ) = L1 OR S ( 18 ) = - 1 ) THEN 2970
2950 Z59 = 45 : GOSUB 7620
2960 GOTO 400
2970 GOSUB 8050
2980 GOSUB 6680
2990 GOTO 400
3000 REM *** LIGHT ***
3010 IF S ( 18 ) = - 1 THEN 3040
3020 B$ = "lamp"
3030 GOTO 2710
3040 L = 1
3050 B$ = "on"
3060 PRINT "The lamp is now " ; B$
3070 GOTO 2940
3080 REM *** OFF (EXTINGUSIH) ***
3090 IF S ( 18 ) = - 1 THEN 3110
3100 GOTO 3020
3110 L = 0 : B$ = "off"
3120 GOTO 3060
3130 REM *** ENTER ***
3140 IF L1 <> 6 THEN 3180
3150 REM TO HOUSE
3160 D = 3
3170 GOTO 1070
3180 IF L1 <> 68 THEN 3240
3190 REM TO BARREN ROOM
3200 D = 3
3210 GOTO 1070
3240 FOR D = 10 TO 1 STEP - 1
3250 Z2 = DIRS ( L1 , D )
3260 IF Z2 > 0 AND Z2 < 101 THEN 1150
3270 NEXT D
3280 GOTO 2200
3290 REM ** LEAVE ***
3300 IF L1 <> 7 THEN 3340
3310 REM LEAVE HOUSE
3320 D = 7
3330 GOTO 1070
3340 IF L1 <> 69 THEN 3400
3350 REM LEAVE BARREN ROOM
3360 D = 7
3370 GOTO 1070
3400 FOR D = 1 TO 10
3410 Z2 = DIRS ( L1 , D )
3420 IF Z2 > 0 AND Z2 < 101 THEN 1150
3430 NEXT D
3440 GOTO 2200
3450 REM *** INVENTORY ***
3470 Z0 = 0
3480 PRINT "You are carrying:" ;
3490 FOR X = 1 TO T2
3510 IF S ( X ) <> - 1 THEN 3540
3511 RESTORE 9960 + X : READ B$
3520 PRINT B$
3530 Z0 = Z0 + 1
3540 NEXT X
3550 IF Z0 = 0 THEN 3551 ELSE 3560
3551 PRINT "nothing."
3560 PRINT
3570 GOTO 400
3590 REM *** GET ***
3630 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 3680
3640 GOSUB 8280
3650 IF Z8 > 0 THEN 3680
3660 PRINT "Get what?"
3670 GOTO 2040
3680 FOR Z3 = 1 TO T2
3710 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 3730
3720 IF K ( 1 ) <> Z3 AND K ( 2 ) <> Z3 THEN 3900
3730 IF S ( Z3 ) <> L1 THEN 3750
3740 IF S ( Z3 ) = L1 THEN 3790
3750 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 3900
3760 RESTORE 9960 + Z3 : READ A$ : PRINT A$ ; " not here."
3770 GOTO 3900
3780 REM MUST CHECK NOW FOR LEGALITY OF TAKING ITEM
3790 Z8 = 0
3800 FOR X = 1 TO T2
3810 IF S ( X ) <> - 1 THEN 3820
3811 Z8 = Z8 + 1
3820 NEXT X
3830 IF Z8 < 7 THEN 3870
3840 REM CARRYING TOO MUCH
3850 Z59 = 54 : GOSUB 7620
3860 GOTO 410
3870 GOTO 6880
3880 S ( Z3 ) = - 1
3890 RESTORE 9960 + Z3 : READ A$ : PRINT A$ ; ":taken."
3900 NEXT Z3
3910 GOTO 400
3920 REM *** DROP ***
3940 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 4000
3950 GOSUB 8280
3960 IF Z8 > 0 THEN 4000
3970 PRINT "Drop what?"
3980 GOTO 2040
4000 FOR Z3 = 1 TO T2
4030 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 4060
4040 IF K ( 1 ) <> Z3 AND K ( 2 ) <> Z3 THEN 4140
4050 IF S ( Z3 ) = 0 THEN 4140
4060 IF S ( Z3 ) = - 1 THEN 4100
4070 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 4140
4080 RESTORE 9960 + Z3 : READ B$ : PRINT "You don't have the " ; B$
4090 GOTO 4140
4100 REM STILL NEED TO ELABORATE ON DROP (BIRD IN CAGE, BOTTLE)
4110 GOTO 7380
4120 RESTORE 9960 + Z3 : READ B$ : PRINT B$ ; ":dropped."
4130 S ( Z3 ) = L1
4140 NEXT Z3
4150 GOTO 400
4160 REM *** THROW ***
4170 GOSUB 8280
4180 IF Z8 > 0 THEN 4210
4190 PRINT "Throw what?"
4200 GOTO 2040
4210 IF S ( Z3 ) <> - 1 THEN 2710
4220 IF NOT ( Z3 < 16 AND S ( 32 ) = L1 ) THEN 4260
4230 REM THROW TREASURE TO TROLL
4240 Z59 = 27 : GOSUB 7620
4241 S ( Z3 ) = 0 : T = 3 : GOTO 400
4260 IF NOT ( Z3 = 27 AND S ( 32 ) = L1 ) THEN 4300
4270 REM TRYING TO BUTCHER TROLL?
4280 Z59 = 26 : GOSUB 7620
4281 S ( 27 ) = L1 : GOTO 400
4300 IF NOT ( Z3 = 27 AND S ( 35 ) = L1 ) THEN 4380
4310 REM TRYING TO KILL DWARF
4320 IF RND > 0.5 THEN 4360
4330 Z59 = 29 : GOSUB 7620
4340 GOSUB 8650
4350 GOTO 4410
4360 Z59 = 30 : GOSUB 7620
4361 S ( 35 ) = 0 : GOTO 4410
4380 REM NOTHING SPECIAL, JUST DROP ITEM
4390 IF S ( 35 ) <> L1 THEN 4400
4391 GOSUB 8550
4400 PRINT "Thrown."
4410 S ( Z3 ) = L1
4415 IF DEAD = 1 THEN 9540
4420 GOTO 400
4430 REM *** ATTACK ***
4440 GOSUB 8280
4450 IF NOT ( Z3 = 33 AND S ( Z3 ) = L1 AND L1 = 82 ) THEN 4520
4460 REM HE CAN KILL DRAGON
4470 Z59 = 68 : GOSUB 7620
4480 GOTO 410
4490 IF L1 <> 82 THEN 2040
4500 Z59 = 69 : GOSUB 7620
4501 S ( 33 ) = 0 : D1 = 0 : GOTO 400
4520 IF S ( 32 ) <> L1 THEN 4560
4530 REM TRYING TO MUNGE TROLL
4540 Z9 = FNA ( 25 ) : GOTO 400
4560 IF NOT ( Z3 = 26 OR Z3 > 30 ) THEN 4600
4570 REM DANGEROUS TO ATTACK THESE
4580 Z59 = 70 : GOSUB 7620
4590 GOTO 400
4600 REM NOTHING TO ATTACK
4610 Z59 = 71 : GOSUB 7620
4620 GOTO 400
4630 REM *** FEED ***
4640 GOSUB 8280
4650 IF Z3 <> 35 THEN 4690
4660 REM CAN'T FEED DWARF!
4670 Z59 = 24 : GOSUB 7620
4680 GOTO 400
4690 IF S ( 20 ) = - 1 THEN 4720
4700 B$ = "FOOD" : GOTO 2710
4720 IF L1 = 69 THEN 4760
4730 PRINT "I can't feed it."
4740 Z59 = 23 : GOSUB 7620
4750 GOTO 400
4760 IF S ( 20 ) = L1 THEN 7600
4770 B1 = 1 : S ( 20 ) = 0 : Z59 = 6 : GOSUB 7620
4790 GOTO 400
4800 REM *** WATER ***
4810 IF S ( 16 ) = - 1 THEN 4840
4820 B$ = "water" : GOTO 2710
4840 IF L1 <> 50 THEN 2200
4850 REM GOTO P1+1 OF 4860,4890,4920
4851 IF P1 = 0 THEN 4860
4852 IF P1 = 1 THEN 4890
4853 IF P1 = 2 THEN 4920
4860 Z59 = 7 : GOSUB 7620
4870 P1 = 1 : S ( 16 ) = 0 : B0 = 0 : GOTO 400
4890 Z59 = 8 : GOSUB 7620
4900 P1 = 2 : S ( 16 ) = 0 : B0 = 0 : GOTO 400
4920 Z59 = 9 : GOSUB 7620
4930 P1 = 0 : S ( 16 ) = 0 : B0 = 0 : GOTO 400
4950 REM *** LOCK ***
4960 IF L1 = 10 OR L1 = 11 THEN 4990
4970 REM NOTHING LOCKABLE
4980 GOTO 2200
4990 IF S ( 19 ) = - 1 THEN 5020
5000 B$ = "keys" : GOTO 2710
5020 G = 0 : Z59 = 10 : GOSUB 7620
5040 GOTO 400
5060 REM *** UNLOCK ***
5070 IF S ( 19 ) <> - 1 THEN 5000
5080 IF L1 <> 10 AND L1 <> 11 THEN 5120
5090 G = 1 : Z59 = 11 : GOSUB 7620
5110 GOTO 400
5120 IF L1 <> 69 THEN 2200
5130 IF B1 > 0 THEN 5160
5140 Z59 = 12 : GOSUB 7620
5150 GOTO 400
5160 IF C <> 0 THEN 5170
5165 C = 1 : B1 = 2
5170 Z59 = 13 : GOSUB 7620
5180 GOTO 400
5190 REM *** FREE ***
5200 IF K ( 1 ) = 31 OR K ( 2 ) = 31 THEN 5240
5210 REM CAN'T FREE ANYTHING BUT BIRD
5220 Z59 = 2 : GOSUB 7620
5230 GOTO 410
5240 IF S ( 31 ) <> - 1 THEN 5220
5250 S ( 31 ) = L1 : B3 = 0
5260 PRINT "Freed."
5270 IF L1 <> 22 THEN 5350
5280 IF SN <> 1 THEN 400
5290 B$ = "snake"
5300 PRINT "The little bird attacks the green " ; B$ ; " and"
5310 IF L1 = 82 THEN 5380
5320 PRINT "drives it off"
5330 SN = 0 : S ( 34 ) = 0 : GOTO 400
5350 IF L1 <> 82 THEN 400
5360 B$ = "dragon" : GOTO 5300
5380 PRINT "gets burned to a crisp"
5381 S ( 20 ) = 0 : B0 = 0 : GOTO 400
5390 S ( 31 ) = 0
5400 GOTO 400
5410 REM *** WAVE ***
5420 IF K ( 1 ) <> 23 AND K ( 2 ) <> 23 THEN 2200
5430 IF S ( 23 ) = - 1 THEN 5460
5440 B$ = "rod" : GOTO 2710
5460 REM  IS HERE NEAR FISSURE
5470 IF L1 <> 19 AND L1 <> 20 THEN 2200
5480 REM yes
5490 REM GOTO B2+1 OF 5500,5530
5491 IF B2 = 0 THEN 5500
5492 IF B2 = 1 THEN 5530
5500 Z59 = 14 : GOSUB 7620
5510 B2 = 1 : GOTO 400
5530 Z59 = 15 : GOSUB 7620
5540 B2 = 0 : GOTO 400
5560 REM *** OPEN ***
5570 GOSUB 8280
5580 IF Z3 > 0 THEN 5610
5590 PRINT "Open " ; : GOTO 2040
5610 IF Z3 = 40 THEN 5070
5620 IF S ( Z3 ) = L1 THEN 5650
5630 PRINT "I see no " ; B$ ; " here." : GOTO 400
5650 IF Z3 = 24 THEN 5680
5660 PRINT "I don't know how to open a " ; B$ : GOTO 400
5680 IF S ( 9 ) = - 1 THEN 5710
5690 Z59 = 16 : GOSUB 7620
5700 GOTO 400
5710 IF S ( Z3 ) = 0 THEN 2200
5720 REM HE'S OPENED CLAM, SO PRINT DESCRIPTION OF THIS
5730 REM PUT PEARL IN CUL-DE-SAC
5740 S ( 7 ) = 43 : S ( 24 ) = 0 : S ( 30 ) = L1 : Z59 = 17 : GOSUB 7620
5750 GOTO 400
5760 REM *** CLOSE ***
5770 GOSUB 8280
5780 IF Z3 = 40 THEN 4960
5790 Z59 = 18 : GOSUB 7620
5800 GOTO 400
5810 REM OIL
5820 IF K ( 1 ) <> 17 AND K ( 2 ) <> 17 THEN 2200
5830 IF S ( 17 ) = - 1 THEN 5860
5840 B$ = "oil" : GOTO 5630
5860 IF L1 <> 73 THEN 2200
5870 REM IS DOOR STILL RUSTED
5880 IF D2 = 1 THEN 2200
5890 D2 = 1 : S ( 17 ) = 0 : B0 = 0 : Z59 = 19 : GOSUB 7620
5900 GOTO 400
5910 REM *** EAT ***
5920 IF K ( 1 ) = 20 OR K ( 2 ) = 20 THEN 5950
5930 Z59 = 20 : GOSUB 7620
5940 GOTO 410
5950 Z3 = 20 : GOSUB 8490
5970 IF Z5 = 0 THEN 410
5980 Z59 = 73 : GOSUB 7620
6000 REM *** DRINK ***
6010 IF K ( 1 ) = 16 OR K ( 2 ) = 16 THEN 6040
6020 Z59 = 21 : GOSUB 7620
6030 GOTO 410
6040 Z3 = 16 : GOSUB 8490
6060 IF Z5 = 0 THEN 410
6070 Z59 = 22 : GOSUB 7620
6071 S ( 17 ) = 0 : B0 = 0 : GOTO 400
6090 REM *** FEE FIE FOE FOO ***
6100 IF L1 = 71 THEN 6130
6110 Z59 = 2 : GOSUB 7620
6120 GOTO 410
6130 IF S ( 8 ) <> L1 THEN 6180
6140 REM MAKE NEST VANISH
6150 Z59 = 79 : GOSUB 7620
6160 S ( 8 ) = 0 : GOTO 400
6180 REM IF S(8)=0 THEN 6110
6190 S ( 8 ) = L1
6200 REM MAKE NEST RE-APPEAR
6210 Z59 = 81 : GOSUB 7620
6220 GOTO 400
6230 REM *** SHORT ***
6240 PRINT "Short descriptions"
6250 D0 = 0 : GOTO 400
6270 REM *** LONG ***
6280 PRINT "Long descriptions"
6290 D0 = 1 : GOTO 400
6310 REM *** BRIEF ***
6320 PRINT "OK, I'll only describe the room in detail the first time."
6330 D0 = 2 : GOTO 400
6350 REM *** QUIT ***
6360 PRINT "Save game" ;
6370 GOSUB 9860
6380 IF Z0 = 1 THEN 8970
6390 GOTO 9750
6400 REM SCORE ***
6410 GOSUB 6430
6420 GOTO 400
6430 REM PRINT OUT SCORE DATA
6440 GOSUB 6510
6450 PRINT "Your score is now " ; S0
6451 PRINT "You have explored " , ( Z9 / T1 ) * T1 , "% of the cave."
6460 RESTORE 6470
6470 DATA "beginner" , "novice" , "experienced" , "advanced" , "expert"
6480 Z9 = INT ( ( S0 - 1 ) / 100 )
6481 IF Z9 <= 4 THEN 6483
6482 Z9 = 4
6483 FOR Z0 = 0 TO Z9
6484 READ D$
6485 NEXT Z0
6490 PRINT "That makes you a " ; D$ ; " adventurer."
6500 RETURN
6510 REM COMPUTE CURRENT SCORE
6520 RESTORE 230
6530 Z9 = 0 : S0 = 0
6540 FOR Z0 = 1 TO 15
6550 READ Z1
6560 IF Z1 = 0 THEN 6590
6570 IF V ( Z1 ) <> 1 THEN 6580
6575 S0 = S0 + 4 * O ( Z0 )
6580 IF S ( Z0 ) <> 7 THEN 6590
6585 S0 = S0 + 4 * O ( Z0 )
6590 NEXT Z0
6600 S0 = ( G = 1 ) * 10 + S0 : S0 = ( SN = 0 ) * 20 + S0 : S0 = ( D1 = 0 ) * 30 + S0 : S0 = ( T = 0 ) * 30 + S0 : S0 = ( B1 = 2 ) * 20 + S0
6605 S0 = ( B2 = 1 ) * 20 + S0 : S0 = ( P1 = 2 ) * 20 + S0 : S0 = ( D2 = 1 ) * 20 + S0 : S0 = ( C = 1 ) * 20 + S0
6610 FOR Z0 = 1 TO T1
6620 IF V ( Z0 ) <> 1 THEN 6630
6621 S0 = S0 + 1 : Z9 = Z9 + 1
6630 NEXT Z0
6640 RETURN
6660 REM list items at location l1
6680 FSEEK # 2 , 0
6690 FOR Z1 = 1 TO T2
6700 INPUT # 2 , A$
6710 IF S ( Z1 ) <> L1 THEN 6720
6711 PRINT A$
6720 NEXT Z1
6721 IF S ( 26 ) <> - 1 THEN 6730
6722 Z59 = 67 : GOSUB 7620
6730 REM CHECK FOR DWARF,PIRATE
6740 GOSUB 8560
6745 IF DEAD = 1 THEN 6770
6750 GOSUB 8800
6760 PRINT
6770 RETURN
6775 REM Print Short room description
6780 FSEEK # 1 , 0
6820 FOR Z1 = 1 TO L1
6830 INPUT # 1 , A$
6840 NEXT Z1
6850 V ( L1 ) = 1
6860 PRINT A$
6870 RETURN
6880 REM SPECIAL GETS
6890 IF NOT ( Z3 = 24 OR Z3 = 30 OR Z3 > 31 ) THEN 6930
6900 REM CAN'T GET THESE FOR SOME REASON
6910 Z59 = 61 : GOSUB 7620
6920 GOTO 400
6930 IF NOT ( Z3 = 12 AND C = 0 ) THEN 6970
6940 REM CHAIN
6950 Z59 = 58 : GOSUB 7620
6960 GOTO 3900
6970 REM BEAR IS HE FED? UNLOCKED?
6980 IF NOT ( Z3 = 26 AND B1 <> 2 ) THEN 7010
6990 Z59 = 61 : GOSUB 7620
7000 GOTO 3900
7010 IF NOT ( Z3 = 14 AND D1 = 1 ) THEN 7050
7020 REM DRAGON AND RUG
7030 Z59 = 59 : GOSUB 7620
7040 GOTO 3900
7050 IF NOT ( Z3 = 16 OR Z3 = 17 ) THEN 7090
7060 REM OIL AND WATER DO SAME AS FILL
7070 PRINT "Why not say 'fill'?"
7080 GOTO 3900
7090 IF NOT ( Z3 = 22 AND B3 ) THEN 7140
7100 REM TAKE BIRD SINCE IT'S IN CAGE
7110 S ( 31 ) = - 1 : PRINT "Bird and " ; : GOTO 3880
7140 IF Z3 <> 31 THEN 7310
7150 REM GETTING BIRD
7160 IF B3 <> 1 THEN 7210
7170 REM TAKE CAGE, SINCE BIRD IS IN IT
7180 PRINT "Cage and " ; : S ( 22 ) = - 1 : GOTO 3880
7210 IF S ( 22 ) = - 1 THEN 7240
7220 B$ = "cage" : GOTO 2810
7240 IF S ( 23 ) = - 1 THEN 7280
7250 REM OK TO TAKE BIRD
7260 S ( 31 ) = - 1 : B3 = 1 : GOTO 3890
7280 REM ROD SCARES BIRD
7290 Z59 = 37 : GOSUB 7620
7300 GOTO 3900
7310 REM BOTTLE FULL? IF SO, GET CONTENTS
7320 IF NOT ( Z3 = 21 AND B0 ) THEN 7360
7330 PRINT "Contents and the " ;
7340 S ( B0 + 15 ) = - 1
7360 GOTO 3880
7370 REM SPECIAL "DROP"
7380 IF Z3 <> 31 THEN 7440
7390 REM BIRD IN CAGE
7400 S ( 31 ) = L1 : S ( 22 ) = L1 : B3 = 1
7410 IF Z3 <> 31 THEN 7420
7415 PRINT "Cage and " ;
7420 IF Z3 = 22 THEN 7430
7425 PRINT "Bird and " ;
7430 GOTO 4120
7440 IF Z3 = 22 AND B3 = 1 THEN 7400
7450 IF Z3 <> 21 THEN 7520
7460 REM BOTTLE
7470 IF B0 = 0 THEN 4120
7480 REM BOTTLE IS FULL, DO DROP CONTENTS TOO
7490 PRINT "Contents and " ;
7500 S ( 15 + B0 ) = L1 : GOTO 4120
7520 IF NOT ( Z3 = 16 OR Z3 = 17 ) THEN 7541
7530 PRINT "Try saying 'empty'" : GOTO 4140
7541 IF Z3 <> 26 OR T <> 1 OR ( L1 <> 60 AND L1 <> 61 ) THEN 7550
7542 Z59 = 28 : GOSUB 7620
7543 T = 0 : S ( 26 ) = L1 : S ( 32 ) = 0 : GOTO 400
7550 IF Z3 <> 6 THEN 4120
7560 IF S ( 28 ) = L1 THEN 7600
7570 REM GOODBYE, FRAGILE VASE!
7580 Z59 = 43 : GOSUB 7620
7581 S ( 6 ) = 0 : S ( 29 ) = L1 : GOTO 400
7600 Z59 = 60 : GOSUB 7620
7610 GOTO 4120
7619 REM PRINT MESSAGE
7620 IF INDX ( 1 ) >= 0 THEN 7640
7630 GOSUB 12500
7640 Z59 = INT ( Z59 ) : XTMP = INDX ( Z59 )
7645 IF Z59 <> 2 AND Z59 <> 61 THEN 7660
7650 XTMP = FRAINDX ( XTMP + MIN ( INT ( RND * 5 ) , 5 ) )
7660 FSEEK # 3 , XTMP
7670 INPUT # 3 , B1$
7672 IF LEN ( B1$ ) = 0 THEN 7673 ELSE 7690
7673 B1$ = " "
7690 IF INSTR ( B1$ , "#" ) = 0 THEN 7670
7700 Z4 = VAL ( MID$ ( B1$ , 2 ) )
7705 IF INT ( Z4 ) = Z59 THEN 7720
7710 IF INT ( Z4 ) < Z59 THEN 7670
7712 IF INT ( Z4 ) > Z59 THEN 7760
7720 INPUT # 3 , B1$
7730 IF MID$ ( B1$ , 1 , 1 ) = "#" THEN 7770
7740 PRINT B1$
7750 GOTO 7720
7760 PRINT "NO DESC. # " ; Z59 ; " IN FILE AMESSAGE"
7770 RETURN
7800 REM
7810 REM SITUATION DESCRIPTIONS
7820 REM
7830 REM GRATE
7840 IF L1 = 10 OR L1 = 11 THEN 7842 ELSE 7860
7842 Z59 = ( G + 10 ) : GOSUB 7620
7850 REM CRYSTAL BRIDGE
7860 IF ( L1 = 19 OR L1 = 20 ) AND B2 = 1 THEN 7861 ELSE 7880
7861 Z59 = 14 : GOSUB 7620
7870 REM PLUGH NOISE
7880 IF L1 = 26 AND RND > 0.3 THEN 7881 ELSE 7900
7881 Z59 = 41 : GOSUB 7620
7890 REM IRON DOOR
7900 IF L1 = 73 AND D2 = 0 THEN 7901 ELSE 7920
7901 Z59 = 57 : GOSUB 7620
7910 REM TROLL
7920 IF ( L1 = 60 OR L1 = 61 ) AND T = 1 THEN 7921 ELSE 7940
7921 Z59 = 63 : GOSUB 7620
7930 REM BEAR
7940 IF L1 = 69 AND B1 = 0 THEN 7941 ELSE 7950
7941 Z59 = 64 : GOSUB 7620
7950 IF L1 = 69 AND B1 = 1 THEN 7951 ELSE 7970
7951 Z59 = 66 : GOSUB 7620
7960 REM PLANT IN PIT
7970 IF L1 = 48 OR L1 = 50 THEN 7971 ELSE 7980
7971 Z59 = 47 + P1 : GOSUB 7620
7980 RETURN
7990 REM
8000 REM   print long room description from "amessage" file
8010 REM   description is noormally l1+200 except for
8020 REM   maze or forest
8030 REM set v(l1)=1 so as not to repeat long desc(brief mode
8040 V ( L1 ) = 1
8050 IF L1 > 4 THEN 8080
8060 Z59 = 200 : GOSUB 7620
8070 GOTO 8130
8080 IF NOT ( L1 > 88 AND L1 < 98 OR L1 = 99 ) THEN 8110
8090 Z59 = 288 : GOSUB 7620
8100 GOTO 8130
8110 REM normal description
8120 Z59 = 200 + L1 : GOSUB 7620
8130 RETURN
8180 REM always give long descriptio nfor forest and maze
8190 IF L1 < 5 OR ( L1 > 88 AND L1 < 98 ) OR L1 = 99 THEN 8220
8200 IF V ( L1 ) = 1 THEN 8201 ELSE 8220
8201 GOSUB 6780
8202 GOTO 8235
8210 REM he hassn't seen this room, so give a long desc.
8220 V ( L1 ) = 1
8230 GOSUB 7990
8235 RETURN
8240 REM
8250 REM   fetch first item code in k(1 to t2)
8260 REM   z8=total # of items found in list
8270 REM   z3=item code first found
8280 Z8 = 0 : Z3 = 0 : D$ = ""
8300 FOR Z5 = 1 TO 45
8320 IF K ( 1 ) <> Z5 AND K ( 2 ) <> Z5 THEN 8360
8330 Z8 = Z8 + 1
8340 RESTORE 9960 + Z5 : READ B$ : D$ = B$
8350 IF K ( 1 ) = Z5 AND Z8 = 1 THEN 8352
8351 IF K ( 2 ) = Z5 AND Z8 = 1 THEN 8352 ELSE 8360
8352 Z3 = Z5
8360 NEXT Z5
8370 B$ = D$
8380 RETURN
8390 REM FIND FIRST ITEM AT ROOM
8400 X1 = 0
8410 FOR Z1 = 1 TO 47
8415 IF X1 = 1 THEN 8440
8430 IF K ( 1 ) = Z1 OR K ( 2 ) = Z1 THEN 8431 ELSE 8440
8431 RESTORE 9960 + Z1 : READ D$ : X1 = 1
8440 NEXT Z1
8450 RETURN
8460 REM
8470 REM MAKE SURE HE'S CARRYING ITEM * Z3
8480 REM
8490 IF S ( Z3 ) = - 1 THEN 8530
8500 PRINT "You don't have the " ; A$
8510 Z5 = 0
8520 RETURN
8530 Z5 = 1
8540 RETURN
8550 REM  *** DWARF ***
8560 IF D3 <> 0 THEN 8640
8570 REM SHOULD DWARF GIVE AWAY AXE?
8580 IF L1 < 13 THEN 8790
8590 IF RND > 0.05 THEN 8790
8600 REM GIVE AWAY AXE
8610 Z59 = 80 : GOSUB 7620
8620 S ( 27 ) = L1 : D3 = 1
8630 GOTO 8790
8640 REM SHOULD DWARF ATTACK?
8650 IF L1 >= 13 THEN 8660
8652 S ( 35 ) = 0 : GOTO 8790
8660 IF S ( 35 ) <> L1 THEN 8770
8661 IF ( L1 <> 60 AND L1 <> 61 ) OR T <> 1 THEN 8670
8662 Z59 = 299 : GOSUB 7620
8663 S ( 35 ) = 0 : GOTO 8790
8670 IF RND > 0.5 THEN 8790
8680 REM YES!
8690 Z59 = 32 : GOSUB 7620
8700 REM DOES THE KNIFE KILL THE PLAYER?
8705 KC = KC - 0.02
8706 IF KC >= 0.75 THEN 8710
8707 KC = 0.75
8710 IF RND <= KC THEN 8750
8720 REM YES
8730 PRINT "It gets you!"
8740 DEAD = 1 : GOTO 8790
8750 PRINT "It misses!"
8760 GOTO 8790
8770 REM SHOULD WE PUT A DWARF HERE?
8780 IF RND >= 0.05 THEN 8790
8781 IF ( L1 = 60 OR L1 = 61 ) AND T = 1 THEN 8790
8785 S ( 35 ) = L1
8786 Z59 = 31 : GOSUB 7620
8790 RETURN
8800 REM *** PIRATE ***
8810 REM FIRST, DOES HE HAVE ANYTHING WORTH STEALING?
8820 Z3 = 0
8830 IF L1 < 13 THEN 8960
8840 FOR X = 1 TO 15
8850 IF S ( X ) <> - 1 THEN 8860
8855 Z3 = Z3 + 1
8860 NEXT X
8870 IF Z3 < INT ( RND * 4 ) + 1 THEN 8960
8880 REM SHOULD WE RIP OFF HIS VALUABLES?
8890 IF RND < 0.05 THEN 8920
8900 Z59 = 34 : GOSUB 7620
8910 GOTO 8960
8920 Z59 = 33 : GOSUB 7620
8930 FOR X = 1 TO 15
8940 IF S ( X ) <> - 1 THEN 8950
8945 S ( X ) = 100
8950 NEXT X
8960 RETURN
8970 REM *** SAVE GAME ***
8980 INPUT "What do you want to call the save file? " , A$
8990 OPEN A$ FOR OUTPUT AS # 5 ELSE 9010
9000 GOTO 9030
9010 PRINT "File " , A$ , " not created"
9020 GOTO 410
9030 PRINT # 5 , T1 , "," , T2 , "," , T3 , "," , L1 , "," , L2 , "," , G , "," , B0 , "," , SN , "," , D1 , "," , D2 , "," , D0 , "," , T , "," , B1 , "," , B2 , "," , P1 , "," , L , "," , C , "," , D3 , "," , B3 , "," , R0 , "," , KC
9040 FOR X = 1 TO 99
9041 PRINT # 5 , S ( X ) , "," , V ( X )
9042 NEXT X
9043 PRINT # 5 , V ( 100 )
9044 CLOSE # 5
9050 PRINT "Game saved"
9051 C0 = 0
9060 IF K ( 1 ) = 143 OR K ( 2 ) = 143 THEN 9750
9070 GOTO 410
9080 REM *** LOAD OLD GAME ***
9090 IF C0 = 0 THEN 9120
9100 PRINT "You already have a loaded game!"
9110 GOTO 410
9120 INPUT "Save file name? " , A$
9130 OPEN A$ FOR INPUT AS # 5 ELSE 9150
9140 GOTO 9170
9150 PRINT "Unable to use file " ; A$
9160 GOTO 410
9170 INPUT # 5 , T1 , T2 , T3 , L1 , L2 , G , B0 , SN , D1 , D2 , D0 , T , B1 , B2 , P1 , L , C , D3 , B3 , R0 , KCX$
9171 KC = VAL ( KCX$ )
9180 FOR X = 1 TO 99
9191 INPUT # 5 , SX , VX : S ( X ) = SX : V ( X ) = VX
9192 NEXT X
9193 INPUT # 5 , VX : V ( 100 ) = VX
9194 CLOSE # 5
9200 C0 = 1
9210 GOTO 300
9220 REM *** READ THE MAGAZINE ***
9230 GOSUB 8280
9240 IF Z3 = 25 THEN 9270
9250 Z59 = 74 : GOSUB 7620
9260 GOTO 410
9270 IF S ( 25 ) = - 1 THEN 9300
9280 B$ = "magazine"
9290 GOTO 2710
9300 REM OK, LET HIM READ IT
9310 Z59 = 303 : GOSUB 7620
9320 GOTO 400
9330 REM *** BUG ***
9340 A$ = "ADVBUGS.TXT"
9341 OPEN A$ FOR APPEND AS # 5 ELSE 9150
9390 INPUT "Your name: " , A$
9400 A$ = A$ + " " + DATE$
9410 PRINT # 5 , A$
9420 PRINT "Enter your gripe in up to five lines (hit return to quit):"
9430 FOR Z0 = 1 TO 5
9440 PRINT Z0 ;
9450 INPUT A$
9460 IF A$ = "" THEN 9490
9470 PRINT # 5 , A$
9480 NEXT Z0
9490 PRINT "Message recorded. Thank you!"
9500 CLOSE # 5
9510 GOTO 410
9540 REM REINCARNATE HIM
9550 R0 = R0 + 1
9560 IF R0 = 1 THEN 9580
9561 IF R0 = 2 THEN 9610
9562 IF R0 = 3 THEN 9740
9570 REM ASK HIM IF HE WANTS TO BE REINCARNATED
9580 Z59 = 75 : GOSUB 7620
9590 GOSUB 9860
9600 GOTO 9630
9610 Z59 = 77 : GOSUB 7620
9620 GOTO 9580
9630 IF Z0 = 0 THEN 9750
9640 Z59 = 76 : GOSUB 7620
9650 REM PUT HIM BACK IN HOUSE, REARRANGE HIS STUFF
9660 S ( 18 ) = 7 : L = 0 : DEAD = 0 : KC = 1.03
9670 FOR X = 1 TO T2
9680 IF S ( X ) <> - 1 THEN 9690
9685 S ( X ) = L1
9690 NEXT X
9700 REM WE'VE PUT THE LAMP IN HOUSE AND OTHER ITEMS WHERE HE DIED
9710 L1 = INT ( RND * 4 ) + 1 : L2 = L1
9720 GOTO 320
9730 REM THIRD DEATH--END OF GAME
9740 Z59 = 78 : GOSUB 7620
9750 PRINT "Oh well..."
9760 GOSUB 6430
9762 CLOSE # 1 : CLOSE # 2 : CLOSE # 3
9770 STOP
9780 REM *** PITS ***
9790 IF L1 < 13 THEN 300
9791 IF L = 1 AND ( S ( 18 ) = - 1 OR S ( 18 ) = L1 ) THEN 300
9800 REM IS HE GOING TO FALL INTO A PIT?
9810 IF L1 = 16 OR L1 = 17 OR L1 = 19 OR L1 = 20 OR L1 = 25 OR L1 = 47 OR L1 = 48 OR L1 = 59 OR L1 = 60 OR L1 = 61 OR L1 = 75 OR L1 = 76 OR L1 = 98 THEN 9840
9820 GOTO 300
9830 REM he fell into a pit
9840 Z59 = 44 : GOSUB 7620
9850 GOTO 9540
9860 REM *** SEEK A "YES" OR "NO"
9870 INPUT A$
9875 IF LEN ( A$ ) <> 0 THEN 9880
9877 A$ = " "
9880 A$ = LOWER$ ( MID$ ( A$ , 1 , 1 ) )
9890 IF A$ <> "y" AND A$ <> "n" THEN 9930
9900 IF A$ = "y" THEN 9901 ELSE 9910
9901 Z0 = 1
9910 IF A$ = "n" THEN 9911 ELSE 9920
9911 Z0 = 0
9920 GOTO 9945
9930 PRINT "Yes or No-" ;
9940 GOTO 9870
9945 RETURN
9950 REM   ---- SHORT NAMES FOR STUFF ----
9961 DATA "large gold nugget"
9962 DATA "bars of silver"
9963 DATA "precious jewelry"
9964 DATA "many coins"
9965 DATA "several diamonds"
9966 DATA "fragile ming vase"
9967 DATA "glistening pearl"
9968 DATA "nest of golden eggs"
9969 DATA "jewel-encrusted trident"
9970 DATA "egg-sized emerald"
9971 DATA "platinum pyramid"
9972 DATA "golden chain"
9973 DATA "rare spices"
9974 DATA "persian rug"
9975 DATA "treasure chest"
9976 DATA "water"
9977 DATA "oil"
9978 DATA "brass lamp"
9979 DATA "keys"
9980 DATA "food"
9981 DATA "bottle"
9982 DATA "wicker cage"
9983 DATA "3-foot black rod"
9984 DATA "clam"
9985 DATA "magazine"
9986 DATA "bear"
9987 DATA "axe"
9988 DATA "velvet pillow"
9989 DATA "shards of pottery"
9990 DATA "oyster"
9991 DATA "bird"
9992 DATA "troll"
9993 DATA "dragon"
9994 DATA "snake"
9995 DATA "dwarf"
9996 DATA "rock"
9997 DATA "stairs"
9998 DATA "steps"
9999 DATA "house"
10000 DATA "grate"
10001 DATA "stream"
10002 DATA "room"
10003 DATA "bridge"
10004 DATA "pit"
10005 DATA "volcano"
10006 DATA "road"
10007 DATA "everything"
12500 REM INITIALIZE MESSAGE INDEX
12501 OPEN "AMESSAGE.IDX" FOR INPUT AS # 6
12604 REM READ AMESSAGE.IDX FILE INTO ARRAYS
12610 INPUT # 6 , II , I
12612 PRINT "*" ;
12615 IF I = - 999 THEN 12630
12620 INDX ( II ) = I : GOTO 12610
12630 II = 0
12640 INPUT # 6 , I
12641 PRINT "*" ;
12650 IF I = - 999 THEN 12670
12660 II = II + 1 : FRAINDX ( II ) = I : GOTO 12640
12670 CLOSE # 6 : PRINT : PRINT
12680 RETURN
