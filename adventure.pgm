10,0
11,62
12,126
13,177
14,185
15,250
16,328
17,402
18,410
19,495
20,575
21,628
22,654
23,725
44,762
45,841
46,867
47,888
50,911
51,928
52,946
53,962
70,979
110,1015
130,1035
150,1076
160,1116
161,1223
162,1329
170,1344
171,1366
172,1399
175,1412
182,1445
190,1486
192,1537
193,1560
194,1635
195,1758
196,1882
197,1899
198,1912
200,1927
210,1944
220,1980
221,2009
222,2148
228,2165
230,-2178
231,-2211
232,-2243
233,-2277
234,-2306
235,-2338
236,-2368
240,2402
241,2432
242,2571
243,2588
245,-2601
246,-2629
247,-2657
260,2685
263,2721
264,2748
266,2764
267,2793
280,2820
300,2851
310,2878
320,2927
321,2963
330,3026
340,3052
350,3066
360,3106
365,3137
370,3155
380,3171
390,3187
400,3254
410,3286
420,3306
425,3331
431,3361
432,3391
433,3415
434,3446
435,3486
440,3503
449,3527
450,3593
460,3622
470,3660
471,3748
480,3810
560,3822
565,3877
780,3912
800,3931
810,3971
820,4008
830,4026
850,4069
860,4117
861,4167
890,4217
900,4239
910,4252
920,4301
930,4359
940,4375
950,4432
980,4446
990,4497
1000,4548
1010,4581
1020,4603
1030,4659
1040,4672
1050,4706
1060,4722
1070,4754
1130,4781
1140,4809
1150,4847
1160,4871
1170,4915
1180,4931
1190,4955
1191,4998
1200,5018
1210,5034
1220,5049
1221,5062
1230,5079
1240,5094
1250,5128
1260,5144
1261,5195
1270,5255
1280,5297
1290,5322
1300,5349
1310,5364
1320,5402
1330,5465
1340,5492
1350,5507
1360,5544
1370,5610
1380,5632
1390,5658
1400,5673
1410,5700
1420,5757
1430,5783
1440,5810
1460,5825
1470,5866
1480,5923
1490,5952
1500,5979
1510,5994
1520,6013
1530,-6035
1540,6069
1550,6109
1560,6123
1570,6137
1580,6153
1590,6174
1600,6202
1610,6235
1620,6265
1630,6278
1640,6305
1650,6320
1660,6334
1670,6348
1680,6364
1690,6388
1691,6434
1700,6525
1710,6548
1720,6575
1730,6610
1740,6637
1750,6652
1760,6666
1770,6682
1780,6698
1781,6735
1790,6782
1800,6828
1810,6855
1820,6870
1821,6897
1830,6924
1840,6947
1850,6959
1860,6975
1870,7031
1880,7058
1890,7073
1900,7136
1910,7153
1920,7180
1930,7195
1940,7211
1950,7236
1960,7303
1980,7370
1990,7397
1991,7447
2000,7507
2001,7526
2010,7548
2020,7562
2030,7607
2040,7620
2050,7639
2051,7678
2052,7692
2060,7705
2070,-7720
2080,7820
2090,7835
2095,7855
2110,8150
2120,8166
2130,8190
2140,8217
2150,8258
2160,8272
2170,8288
2180,8316
2190,8329
2200,8345
2210,8371
2220,8386
2230,8410
2240,8437
2250,8478
2260,8492
2270,8508
2280,8536
2290,8549
2300,8565
2310,8621
2320,8648
2325,8682
2330,8701
2335,8736
2340,8756
2350,8770
2360,8786
2370,8814
2380,8828
2390,8844
2400,8868
2410,8896
2420,8923
2430,8949
2440,8964
2450,8976
2460,9028
2470,9044
2480,9072
2490,9098
2500,9110
2510,9126
2520,9154
2530,9166
2540,9182
2550,9210
2560,9222
2570,9238
2580,9262
2590,9290
2600,9324
2610,9350
2620,9364
2630,9378
2640,9394
2650,9435
2660,9502
2670,9528
2680,9544
2690,9559
2700,9593
2710,9613
2720,9652
2730,9667
2740,9693
2750,9719
2760,9734
2770,9824
2780,9854
2790,9870
2800,9897
2810,9914
2820,9954
2830,9969
2840,9999
2850,10039
2860,10054
2870,10078
2880,10112
2890,10128
2900,10166
2910,10199
2920,10221
2930,10236
2940,10259
2941,10297
2950,10362
2960,10389
2970,10404
2980,10421
2990,10438
3000,10453
3010,10477
3020,10511
3030,10529
3040,10545
3050,10557
3060,10573
3070,10609
3080,10625
3090,10660
3100,10694
3110,10710
3120,10735
3130,10751
3140,10775
3150,10802
3160,10821
3170,10833
3180,10849
3190,10877
3200,10902
3210,10914
3240,10930
3250,10953
3260,10981
3270,11020
3280,11034
3290,11050
3300,11073
3310,11100
3320,11122
3330,11134
3340,11150
3350,11178
3360,11206
3370,11218
3400,11234
3410,11257
3420,11285
3430,11324
3440,11338
3450,11354
3460,11382
3470,11401
3480,11414
3490,11448
3500,11470
3510,11484
3520,11518
3530,11533
3540,11551
3550,11564
3551,11600
3560,11623
3570,11635
3590,11650
3630,11672
3640,11720
3650,11737
3660,11763
3670,11787
3680,11803
3690,11822
3700,11845
3710,11859
3720,11907
3730,11958
3740,11992
3750,12025
3760,12073
3770,12103
3780,12119
3790,12172
3800,12185
3810,12207
3811,12241
3820,12259
3830,12272
3840,12298
3850,12326
3860,12353
3870,12368
3880,12384
3890,12405
3900,12432
3910,12446
3920,12461
3940,12484
3950,12532
3960,12549
3970,12575
3980,12600
4000,12616
4010,12635
4020,12658
4030,12672
4040,12720
4050,12771
4060,12803
4070,12837
4080,12885
4090,12924
4100,12940
4110,13005
4120,13021
4130,13050
4140,13070
4150,13084
4160,13099
4170,13123
4180,13140
4190,13166
4200,13192
4210,13208
4220,13243
4230,13296
4240,13330
4241,13357
4260,13395
4270,13448
4280,13483
4281,13510
4300,13541
4310,13594
4320,13625
4330,13654
4340,13681
4350,13698
4360,13714
4361,13741
4380,13772
4390,13814
4391,13848
4400,13865
4410,13887
4415,13907
4420,13935
4430,13950
4440,13975
4450,13992
4460,14057
4470,14086
4480,14113
4490,14128
4500,14156
4501,14183
4520,14222
4530,14256
4540,14288
4560,14321
4570,14367
4580,14403
4590,14430
4600,14445
4610,14473
4620,14500
4630,14515
4640,14538
4650,14555
4660,14583
4670,14611
4680,14638
4690,14653
4700,14687
4720,14717
4730,14744
4740,14775
4750,14802
4760,14817
4770,14850
4790,14900
4800,14915
4810,14939
4820,14973
4840,15004
4850,15032
4851,15070
4852,15096
4853,15122
4860,15148
4870,15174
4890,15222
4900,15248
4920,15296
4930,15322
4950,15370
4960,15393
4970,15431
4980,15458
4990,15474
5000,15508
5020,15538
5040,15573
5045,15588
5050,15660
5060,15680
5070,15705
5080,15740
5090,15781
5110,15816
5120,15831
5130,15859
5140,15885
5150,15912
5160,15927
5165,15953
5170,15974
5180,16001
5190,16016
5200,16039
5210,16087
5220,16126
5230,16152
5240,16167
5250,16202
5260,16231
5270,16252
5280,16280
5290,16306
5300,16325
5310,16388
5320,16415
5330,16443
5350,16482
5360,16509
5380,16541
5381,16578
5390,16617
5400,16636
5410,16651
5420,16674
5430,16725
5440,16759
5460,16788
5470,16819
5480,16860
5490,16874
5491,16907
5492,16933
5500,16959
5510,16986
5530,17010
5540,17037
5560,17061
5570,17084
5580,17101
5590,17127
5610,17161
5620,17188
5630,17221
5650,17272
5660,17299
5680,17357
5690,17390
5700,17417
5710,17432
5720,17464
5730,17521
5740,17555
5750,17628
5760,17643
5770,17667
5780,17684
5790,17711
5800,17738
5810,17753
5820,17767
5830,17818
5840,17852
5860,17881
5870,17909
5880,17940
5890,17966
5900,18026
5910,18041
5920,18063
5930,18111
5940,18138
5950,18153
5970,18180
5980,18205
6000,18232
6010,18256
6020,18304
6030,18331
6040,18346
6060,18373
6070,18398
6071,18425
6090,18464
6100,18498
6110,18525
6120,18551
6130,18566
6140,18599
6150,18626
6160,18653
6180,18682
6190,18712
6200,18731
6210,18761
6220,18788
6230,18803
6240,18827
6250,18860
6270,18884
6280,18907
6290,18939
6310,18963
6320,18987
6330,19059
6350,19083
6360,19106
6370,19132
6380,19149
6390,19175
6400,19191
6410,19211
6420,19228
6430,19243
6440,19274
6450,19291
6451,19329
6460,19400
6470,-19419
6480,19492
6481,19528
6482,19555
6483,19568
6484,19591
6485,19605
6490,19619
6500,19673
6510,19686
6520,19718
6530,19736
6540,19758
6550,19781
6560,19795
6570,19821
6575,19854
6580,19883
6585,19916
6590,19945
6600,19959
6605,20101
6610,20216
6620,20239
6621,20272
6630,20304
6640,20318
6660,20331
6680,20367
6690,20387
6700,20410
6710,20424
6711,20458
6720,20473
6721,20487
6722,20522
6730,20549
6740,20582
6745,20599
6750,20627
6760,20644
6770,20656
6775,20669
6780,20708
6820,20728
6830,20751
6840,20772
6850,20786
6860,20805
6870,20820
6880,20833
6890,20856
6900,20913
6910,20955
6920,20982
6930,20997
6940,21042
6950,21058
6960,21085
6970,21101
6980,21137
6990,21184
7000,21211
7010,21227
7020,21273
7030,21298
7040,21325
7050,21341
7060,21387
7070,21427
7080,21461
7090,21477
7100,21519
7110,21558
7140,21613
7150,21641
7160,21664
7170,21691
7180,21732
7210,21787
7220,21821
7240,21851
7250,21885
7260,21911
7280,21953
7290,21979
7300,22006
7310,22022
7320,22065
7330,22107
7340,22141
7360,22167
7370,22183
7380,22208
7390,22236
7400,22259
7410,22304
7415,22332
7420,22358
7425,22385
7430,22411
7440,22427
7450,22465
7460,22493
7470,22510
7480,22536
7490,22583
7500,22613
7520,22650
7530,22696
7541,22741
7542,22808
7543,22835
7550,22889
7560,22916
7570,22949
7580,22982
7581,23009
7600,23054
7610,23081
7619,23097
7620,23121
7630,23156
7640,23174
7645,23217
7650,23257
7660,23317
7670,23340
7672,23362
7673,23407
7680,23423
7690,23453
7700,23496
7705,23532
7710,23567
7712,23602
7720,23637
7730,23659
7740,23705
7750,23721
7760,23737
7770,23790
7800,23803
7810,23813
7820,23846
7830,23856
7840,23872
7842,23920
7850,23955
7860,23980
7861,24043
7870,24070
7880,24092
7881,24143
7890,24170
7900,24190
7901,24238
7910,24265
7920,24281
7921,24343
7930,24370
7940,24385
7941,24433
7950,24460
7951,24508
7960,24535
7970,24558
7971,24606
7980,24638
7990,24651
8000,24661
8010,24720
8020,24773
8030,24798
8040,24861
8050,24880
8060,24906
8070,24934
8080,24950
8090,25008
8100,25036
8110,25052
8120,25081
8130,25114
8180,25127
8190,25186
8200,25250
8201,25288
8202,25305
8210,25321
8220,25379
8230,25398
8235,25415
8240,25428
8250,25438
8260,25484
8270,25528
8280,25563
8290,25595
8300,25614
8310,25637
8320,25651
8330,25702
8340,25720
8350,25734
8351,25777
8352,25830
8360,25844
8370,25858
8380,25872
8390,25885
8400,25919
8405,25938
8410,25951
8415,25974
8420,26000
8430,26014
8431,26072
8440,26085
8450,26099
8460,26112
8470,26123
8480,26167
8490,26177
8500,26211
8510,26250
8520,26263
8530,26276
8540,26289
8550,26302
8560,26326
8570,26353
8580,26391
8590,26418
8600,26448
8610,26472
8620,26499
8630,26528
8640,26544
8650,26575
8660,26602
8670,26636
8680,26665
8690,26680
8700,26707
8705,26749
8706,26770
8707,26799
8710,26814
8720,26843
8730,26857
8740,26884
8750,26911
8760,26936
8770,26952
8780,26990
8785,27020
8790,27040
8800,27053
8810,27078
8820,27133
8830,27146
8840,27173
8850,27195
8855,27229
8860,27247
8870,27260
8880,27304
8890,27347
8900,27377
8910,27404
8920,27420
8930,27447
8940,27469
8945,27503
8950,27523
8960,27536
8970,27549
8980,27577
8990,27637
9000,27679
9010,27695
9020,27737
9030,27752
9040,27989
9041,28011
9042,28053
9043,28066
9044,28094
9050,28110
9051,28135
9060,28148
9070,28198
9080,28213
9090,28245
9100,28271
9110,28317
9120,28332
9130,28368
9140,28409
9150,28425
9160,28464
9170,28479
9171,28598
9180,28622
9191,28644
9192,28700
9193,28713
9194,28751
9200,28767
9210,28780
9220,28795
9230,28831
9240,28848
9250,28875
9260,28902
9270,28917
9280,28951
9290,28973
9300,28989
9310,29019
9320,29047
9330,29062
9340,29084
9341,29109
9390,29151
9400,29182
9410,29210
9420,29231
9430,29304
9440,29326
9450,29343
9460,29358
9470,29385
9480,29406
9490,29420
9500,29463
9510,29479
9540,29494
9550,29520
9560,29538
9561,29564
9562,29590
9570,29616
9580,29665
9590,29692
9600,29709
9610,29725
9620,29752
9630,29768
9640,29794
9650,29821
9660,29874
9670,29924
9680,29946
9685,29980
9690,29999
9700,30012
9710,30080
9720,30121
9730,30136
9740,30171
9750,30198
9760,30223
9762,30240
9770,30268
9780,30279
9790,30302
9791,30329
9800,30394
9810,30436
9820,30595
9830,30611
9840,30640
9850,30667
9860,30683
9870,30718
9875,30733
9877,30768
9880,30783
9890,30825
9900,30868
9901,30906
9910,30919
9911,30957
9920,30970
9930,30986
9940,31013
9945,31029
9950,31042
9960,-31084
9962,-31155
9964,-31222
9966,-31304
9968,-31373
9970,-31451
9980,-31520
9982,-31607
9984,-31689
9986,-31789
10570,31827
10580,-31849
10590,32003
10600,-32020
10610,-32239
10620,-32457
10630,-32680
10640,-32906
10650,33051
10660,-33068
10670,-33289
10680,-33495
10690,-33722
10700,-33941
10710,34144
10720,-34171
12000,-34383
12010,-34444
12020,-34489
12030,-34535
12040,-34576
12050,-34623
12060,-34683
12070,-34734
12080,-34791
12090,-34846
12100,-34913
12110,-34985
12120,-35029
12130,-35071
12140,-35123
12150,-35187
12160,-35234
12170,-35283
12180,-35328
12190,-35371
12200,-35405
12210,-35449
12220,-35498
12230,-35546
12240,-35620
12250,-35685
12260,-35723
12270,-35765
12280,-35817
12290,-35876
12300,-35952
12310,-35995
12320,-36047
12330,-36102
12340,-36156
12500,36229
12501,36265
12502,36320
12504,36338
12505,36392
12506,36437
12520,36510
12522,36546
12530,36568
12531,36615
12540,36649
12550,36679
12560,36723
12561,36759
12570,36801
12571,36838
12572,36865
12573,36907
12574,37006
12576,37039
12580,37057
12581,37091
12585,37134
12590,37153
12591,37171
12592,37210
12593,37237
12594,37270
12595,37284
12596,37309
12597,37326
12600,37366
12604,37384
12610,37430
12612,37456
12615,37475
12620,37506
12630,37542
12640,37556
12641,37577
12650,37596
12660,37627
12670,37680
12680,37713
-999,-999
10 REM ADVENTURE/3000 VERSION 3.2     27 FEB 1979 AT 5:30 PM
11 REM THIS PROGRAM IS RELATIVELY BUG-FREE, BUT ONE STILL MUST
12 REM realize that murphy 'S LAW STILL PREVAILS!
13 REM
14 REM ADVENTURE: PROGRAMMED IN HP/3000 BASIC BY BENJAMIN MOSER
15 REM JAMES MADISON HIGH SCHOOL, VIENNA, VIRGINIA.  THE BASIC LAYOUT OF THE
16 REM GAME WAS CONCEIVED BY DON WOODS & WILLIE CROWTHER, BOTH OF M.I.T.
17 REM
18 REM ADVENTURE WAS PORTED TO THE MACINTOSH PLUS BY THE ELIZABETH AND DAVID HUNTER
19 REM IN MARCH 1998 AND THEN TO PYBASIC FOR THE RASPBERRY RP2040 IN JUNE 2021
20 REM print "Adventure 3.2 on ";date$;" at ";time$
21 PRINT "Adventure 3.2"
22 OPEN "AMESSAGE" FOR INPUT AS # 3 : OPEN "AMOVING" FOR INPUT AS # 4
23 OPEN "ADESCRIP" FOR INPUT AS # 1
44 REM dirs is an array of possible room directions, it replaces file AMOVING
45 DIM DIRS ( 100 , 10 )
46 DIM INDX ( 303 )
47 DIM FRAINDX ( 10 )
50 DIM S ( 99 )
51 DIM V ( 100 )
52 DIM K ( 2 )
53 DIM O ( 15 )
70 PRINT : PRINT "Initializing." ;
110 REM initialize
130 REM total rooms, items,and keywords
150 L1 = INT ( RND * 4 ) + 1 : L2 = L1
160 G = 0 : B0 = 1 : SN = 1 : D1 = 1 : D2 = 0 : T = 1 : B1 = 0 : B2 = 0 : P1 = 0 : DEAD = 0 : LASTC$ = ""
161 L = 0 : C = 0 : D3 = 0 : B3 = 0 : D0 = 2 : T1 = 100 : T2 = 35 : T3 = 149 : R0 = 0 : C0 = 0 : C$ = ""
162 KC = 1.03
170 FOR II = 1 TO 99
171 S ( II ) = 0 : V ( II ) = 0
172 NEXT II
175 PRINT "." ; : V ( 100 ) = 0
182 INDX ( 1 ) = - 1 : INDX ( 2 ) = - 1
190 REM read in possible movement direction array
192 FOR Z2 = 1 TO 100
193 INPUT # 4 , DX1 , DX2 , DX3 , DX4 , DX5 , DX6 , DX7 , DX8 , DX9 , DX0
194 DIRS ( Z2 , 1 ) = DX1 : DIRS ( Z2 , 2 ) = DX2 : DIRS ( Z2 , 3 ) = DX3 : DIRS ( Z2 , 4 ) = DX4 : DIRS ( Z2 , 5 ) = DX5
195 DIRS ( Z2 , 6 ) = DX6 : DIRS ( Z2 , 7 ) = DX7 : DIRS ( Z2 , 8 ) = DX8 : DIRS ( Z2 , 9 ) = DX9 : DIRS ( Z2 , 10 ) = DX0
196 PRINT "." ;
197 NEXT Z2
198 CLOSE # 4
200 RESTORE 230
210 REM read in locations of items
220 FOR Z2 = 1 TO T2 STEP 5
221 READ DX1 , DX2 , DX3 , DX4 , DX5 : S ( Z2 ) = DX1 : S ( Z2 + 1 ) = DX2 : S ( Z2 + 2 ) = DX3 : S ( Z2 + 3 ) = DX4 : S ( Z2 + 4 ) = DX5
222 PRINT "." ;
228 NEXT Z2
230 DATA 18 , 25 , 23 , 24 , 21
231 DATA 52 , 0 , 71 , 74 , 58
232 DATA 59 , 69 , 66 , 82 , 100
233 DATA 7 , 49 , 7 , 7 , 7
234 DATA 7 , 12 , 13 , 40 , 38
235 DATA 69 , 0 , 46 , 0 , 0
236 DATA 15 , 60 , 82 , 22 , 250
240 FOR II = 1 TO 15 STEP 5 
241 READ DX1 , DX2 , DX3 , DX4 , DX5 : O ( II ) = DX1 : O ( II + 1 ) = DX2 : O ( II + 2 ) = DX3 : O ( II + 3 ) = DX4 : O ( II + 4 ) = DX5
242 PRINT "." ;
243 NEXT II
245 DATA 1 , 2 , 2 , 2 , 2
246 DATA 3 , 4 , 3 , 3 , 2
247 DATA 5 , 3 , 2 , 3 , 3
260 REM ASK IF HE WANTS DIRECTIONS
263 Z5 = 301 : GOSUB 7620
264 GOSUB 9860
266 IF Z0 THEN 267 ELSE 320
267 Z5 = 302 : GOSUB 7620
280 REM command input routine
300 REM print room, items
310 REM If it's dark don't let him see anything
320 IF L1 < 13 OR L1 = 58 THEN 350
321 IF L = 1 AND ( S ( 18 ) = L1 OR S ( 18 ) = - 1 ) THEN 350
330 Z5 = 45 : GOSUB 7620
340 GOTO 400
350 ON D0 + 1 GOSUB 6780 , 7990 , 8180
360 IF V ( L1 ) <> 0 THEN 370
365 V ( L1 ) = 1
370 GOSUB 6680
380 GOSUB 7800
390 REM INPUT LOOP --- MULTIPLE COMMAANDS, REMOVE JUNK CHARACTERS
400 IF LEN ( C$ ) > 0 THEN 500
410 INPUT ">" , C$
420 IF C$ = "" THEN 410
425 PRINT : PRINT : NKEY = 0
431 IF C$ <> LASTC$ THEN 433
432 C$ = "" : GOTO 900
433 NUMKEYS = 1 : LASTC$ = C$
434 IF INSTR ( C$ , " " ) = 0 THEN 440
435 NUMKEYS = 2
440 C$ = UPPER$ ( C$ )
449 REM 65-90 = A-Z               48-57 = 0-9         46 = .    
450 FOR X = 1 TO LEN ( C$ )
460 Z5 = ASC ( MID$ ( C$ , X , 1 ) )
470 IF ( Z5 > 64 AND Z5 < 91 ) OR ( Z5 > 47 AND Z5 < 58 ) OR Z5 = 46 THEN 480 ELSE 471
471 C$ = MID$ ( C$ , 1 , X - 1 ) + " " + MID$ ( C$ , X + 1 )
480 NEXT X
560 REM search a$ for keywords,put kwd code into k(x)
565 A$ = " " + C$ + " " : C$ = ""
780 RESTORE 10580
800 K ( 1 ) = 0 : K ( 2 ) = 0 : Z3 = 0
810 REM T3=TOTAL NUMBER OF KEYWORDS
820 READ Z1 , B$
830 IF Z1 > T3 OR NKEY = NUMKEYS THEN 900
850 IF INSTR ( A$ , B$ ) > 0 THEN 861 ELSE 820
860 REM IF KEYWORD WAS FOUND, NOTE THIS IN K(Z1)
861 NKEY = NKEY + 1 : K ( NKEY ) = Z1 : GOTO 820
890 REM EXOTIC WORDS
900 Z0 = 36
910 IF K ( 1 ) >= Z0 AND K ( 1 ) <= 46 THEN 930
920 IF K ( 2 ) >= Z0 AND K ( 2 ) <= 46 THEN 930 ELSE 980
930 GOSUB 8390
940 PRINT "What do you want to do with the " ; D$ ; "?"
950 GOTO 410
980 IF K ( 1 ) >= 110 AND K ( 1 ) <= T3 THEN 1950
990 IF K ( 2 ) >= 110 AND K ( 2 ) <= T3 THEN 1950
1000 REM THEN IS IT A DIRECTION
1010 FOR D = 1 TO 10
1020 IF K ( 1 ) = D + 99 OR K ( 2 ) = D + 99 THEN 1070
1030 NEXT D
1040 REM COMMAND NOT A DIRECTION
1050 GOTO 1950
1060 REM CAN HE MOVE THAT WAY?
1070 Z2 = DIRS ( L1 , D )
1130 IF Z2 = 255 THEN 1240
1140 IF Z2 < 1 OR Z2 > 254 THEN 1220
1150 REM NORMAL MOVING
1160 REM CHECK FOR SPECIAL MOVE CONDITIONS
1170 GOTO 1240
1180 L2 = L1 : L1 = Z2
1190 IF S ( 35 ) = L2 THEN 1191 ELSE 1200
1191 S ( 35 ) = L1
1200 GOTO 9780
1210 GOTO 300
1220 Z5 = 1
1221 GOSUB 7620
1230 GOTO 400
1240 REM SPECIAL ROOM DIRECTIONS
1250 REM GRATE
1260 IF L1 = 10 AND ( D = 10 OR D = 5 ) THEN 1270
1261 IF L1 = 11 AND ( D = 9 OR D = 3 ) THEN 1270 ELSE 1310
1270 REM IF GRATE IS OPEN (G=0) MOVE HIM
1280 IF G = 1 THEN 1180
1290 Z5 = 10 : GOSUB 7620
1300 GOTO 400
1310 REM CAN'T TAKE NUGGET UPPSTAIRS
1320 IF NOT ( L1 = 17 AND D = 9 AND S ( 1 ) = - 1 ) THEN 1350
1330 Z5 = 38 : GOSUB 7620
1340 GOTO 400
1350 REM CRYSTAL BRIDGE AND FISSURE
1360 IF NOT ( L1 = 19 AND D = 7 OR L1 = 20 AND D = 3 ) THEN 1400
1370 IF B2 THEN 1180
1380 Z5 = 3 : GOSUB 7620
1390 GOTO 400
1400 REM MT. KING & SNAKE
1410 IF NOT ( L1 = 22 AND D <> 3 AND D <> 9 ) THEN 1460
1420 IF SN = 0 THEN 1180
1430 Z5 = 50 : GOSUB 7620
1440 GOTO 400
1460 REM bedquilt and random directiosn
1470 IF NOT ( L1 = 44 AND D <> 3 AND D <> 7 ) THEN 1580
1480 IF RND > 0.5 THEN 1510
1490 Z5 = 52 : GOSUB 7620
1500 GOTO 400
1510 RESTORE 1530
1520 REM ROOMS TO JU
1530 DATA 33 , 37 , 45 , 92 , 76
1540 FOR Z3 = 1 TO INT ( RND * 5 ) + 1
1550 READ Z2
1560 NEXT Z3
1570 GOTO 1180
1580 REM WITT's END
1590 IF L1 <> 39 THEN 1680
1600 REM SHOULD WE LET HIM OUT?
1610 IF RND < 0.15 THEN 1650
1620 REM NO
1630 Z5 = 52 : GOSUB 7620
1640 GOTO 400
1650 REM YES
1660 Z2 = 38
1670 GOTO 1180
1680 REM Narrow Tunnel
1690 IF NOT ( L1 = 57 OR L1 = 58 ) THEN 1770
1691 IF K ( 1 ) <> 102 AND K ( 2 ) <> 102 AND K ( 1 ) <> 106 AND K ( 2 ) <> 106 THEN 1770
1700 FOR Z3 = 1 TO T2
1710 IF Z3 = 10 THEN 1750
1720 IF S ( Z3 ) <> - 1 THEN 1750
1730 Z5 = 53 : GOSUB 7620
1740 GOTO 400
1750 NEXT Z3
1760 GOTO 1180
1770 REM TROLL
1780 IF L1 = 60 AND D = 2 THEN 1790
1781 IF L1 = 61 AND D = 6 THEN 1790 ELSE 1860
1790 ON T + 1 GOTO 1180 , 1800 , 1820 , 1840
1800 Z5 = 55 : GOSUB 7620
1810 GOTO 400
1820 Z5 = 56 : GOSUB 7620
1821 Z5 = 55 : GOSUB 7620
1830 T = 1 : GOTO 400
1840 T = 2
1850 GOTO 1180
1860 IF NOT ( L1 = 73 AND D = 1 AND D2 = 0 ) THEN 1890
1870 Z5 = 57 : GOSUB 7620
1880 GOTO 400
1890 IF NOT ( L1 = 82 AND S ( 33 ) = L1 AND D = 1 ) THEN 1930
1900 REM DRAGON
1910 Z5 = 51 : GOSUB 7620
1920 GOTO 400
1930 GOTO 1180
1940 REM OTHER COMMANDS
1950 Z1 = K ( 1 ) : IF K ( 1 ) >= 110 AND K ( 1 ) <= T3 THEN 2090
1960 Z1 = K ( 2 ) : IF K ( 2 ) >= 110 AND K ( 2 ) <= T3 THEN 2090
1980 REM ITEM BO NO VERB?
1990 IF K ( 1 ) >= 1 AND K ( 1 ) <= 35 THEN 2000
1991 IF K ( 2 ) >= 1 AND K ( 2 ) <= 35 THEN 2000 ELSE 2040
2000 RESTORE 9960
2001 FOR X = 1 TO 35
2010 READ D$
2020 IF K ( 1 ) = X OR K ( 2 ) = X THEN 940
2030 NEXT X
2040 RESTORE 2070
2050 FOR X = 1 TO INT ( RND * 4 ) + 1
2051 READ B$
2052 NEXT X
2060 PRINT B$
2070 DATA "What?" , "I don't understand." , "I can't understand that." , "I don't know that word."
2080 GOTO 400
2090 Z1 = Z1 - 109
2095 ON Z1 GOTO 2120 , 2220 , 2300 , 2390 , 2570 , 2640 , 2680 , 2860 , 2930 , 3000 , 3080 , 3130 , 3290 , 3450 , 3590 , 3920 , 4160 , 4430 , 4630 , 4800 , 4950 , 5060 , 5190 , 5410 , 5560 , 5750 , 5810 , 5920 , 6000 , 6090 , 6230 , 6270 , 6310 , 6350 , 6410 , 8970 , 9080 , 9220 , 4490 , 9330
2110 GOTO 2040
2120 REM *** PLUGH ***
2130 IF L1 <> 7 THEN 2170
2140 IF S ( 35 ) = L1 THEN S ( 35 ) = 0
2150 Z2 = 26
2160 GOTO 1180
2170 IF L1 <> 26 THEN 2200
2180 Z2 = 7
2190 GOTO 1180
2200 Z5 = 2 : GOSUB 7620
2210 GOTO 400
2220 REM *** XYZZY ***
2230 IF L1 <> 7 THEN 2270
2240 IF S ( 35 ) = L1 THEN S ( 35 ) = 0
2250 Z2 = 13
2260 GOTO 1180
2270 IF L1 <> 13 THEN 2200
2280 Z2 = 7
2290 GOTO 1180
2300 REM *** PLOVER *** (CAN'T BRING EMERALD WITH HIM)
2310 IF L1 > 26 THEN 2360
2320 IF S ( 35 ) <> L1 THEN 2330
2325 S ( 35 ) = 0
2330 IF S ( 10 ) <> - 1 THEN 2340
2335 S ( 10 ) = L1
2340 Z2 = 58
2350 GOTO 1180
2360 IF L1 <> 58 THEN 2200
2370 Z2 = 26
2380 GOTO 1180
2390 REM *** CROSS ***
2400 IF L1 <> 19 THEN 2470
2410 IF B2 <> 0 THEN 2440
2420 Z5 = 3 : GOSUB 7620
2430 GOTO 400
2440 D = 7
2450 REM JUST GIVE NEW DIRECTION, USE MOVE ROUTINE
2460 GOTO 1070
2470 IF L1 <> 20 THEN 2510
2480 IF B2 = 0 THEN 2420
2490 D = 3
2500 GOTO 1070
2510 IF L1 <> 60 THEN 2540
2520 D = 2
2530 GOTO 1070
2540 IF L1 <> 61 THEN 2200
2550 D = 6
2560 GOTO 1070
2570 REM *** CLIMB ***
2580 IF L1 <> 50 THEN 2200
2590 REM CAN HE CLIMB BEANSTALK?
2600 IF P1 < 2 THEN 2200
2610 REM YES
2620 Z2 = 70
2630 GOTO 1180
2640 REM *** JUMP *** STRICTLY SUICIDAL
2650 IF L1 <> 16 AND L1 <> 19 AND L1 <> 20 AND L1 <> 27 THEN 2200
2660 Z5 = 4 : GOSUB 7620
2670 GOTO 9550
2680 REM FILL
2690 IF S ( 21 ) = - 1 THEN 2730
2700 B$ = "bottle"
2710 PRINT "You don't have the " ; B$
2720 GOTO 410
2730 IF B0 = 0 THEN 2760
2740 Z5 = 5 : GOSUB 7620
2750 GOTO 410
2760 IF L1 <> 7 AND L1 <> 8 AND L1 <> 9 AND L1 <> 35 AND L1 <> 74 AND L1 <> 81 THEN 2790
2770 B0 = 1 : S ( 16 ) = - 1
2780 GOTO 2840
2790 IF L1 = 49 THEN 2830
2800 B$ = "oil"
2810 PRINT "I see no " ; B$ ; " here."
2820 GOTO 400
2830 B0 = 2 : S ( 17 ) = - 1
2840 PRINT "The bottle is now filled."
2850 GOTO 400
2860 REM *** EMPTY ***
2870 IF S ( 21 ) = - 1 THEN 2890
2880 GOTO 2700
2890 REM EMPTY BOTTLE (ASSUMED FULL)
2900 S ( B0 + 15 ) = 0 : B0 = 0
2910 PRINT "Emptied"
2920 GOTO 400
2930 REM *** LOOK ***
2940 IF L1 < 13 OR L1 = 58 THEN 2970
2941 IF L = 1 AND ( S ( 18 ) = L1 OR S ( 18 ) = - 1 ) THEN 2970
2950 Z5 = 45 : GOSUB 7620
2960 GOTO 400
2970 GOSUB 8050
2980 GOSUB 6680
2990 GOTO 400
3000 REM *** LIGHT ***
3010 IF S ( 18 ) = - 1 THEN 3040
3020 B$ = "lamp"
3030 GOTO 2710
3040 L = 1
3050 B$ = "on"
3060 PRINT "The lamp is now " ; B$
3070 GOTO 2940
3080 REM *** OFF (EXTINGUSIH) ***
3090 IF S ( 18 ) = - 1 THEN 3110
3100 GOTO 3020
3110 L = 0 : B$ = "off"
3120 GOTO 3060
3130 REM *** ENTER ***
3140 IF L1 <> 6 THEN 3180
3150 REM TO HOUSE
3160 D = 3
3170 GOTO 1070
3180 IF L1 <> 68 THEN 3240
3190 REM TO BARREN ROOM
3200 D = 3
3210 GOTO 1070
3240 FOR Z0 = 1 TO 10
3250 Z2 = DIRS ( L1 , Z0 )
3260 IF Z2 > 0 AND Z2 < 101 THEN 1150
3270 NEXT Z0
3280 GOTO 2200
3290 REM ** LEAVE ***
3300 IF L1 <> 7 THEN 3340
3310 REM LEAVE HOUSE
3320 D = 7
3330 GOTO 1070
3340 IF L1 <> 69 THEN 3400
3350 REM LEAVE BARREN ROOM
3360 D = 7
3370 GOTO 1070
3400 FOR Z0 = 1 TO 10
3410 Z2 = DIRS ( L1 , Z0 )
3420 IF Z2 > 0 AND Z2 < 101 THEN 1150
3430 NEXT Z0
3440 GOTO 2200
3450 REM *** INVENTORY ***
3460 RESTORE 9960
3470 Z0 = 0
3480 PRINT "You are carrying:" ;
3490 FOR X = 1 TO T2
3500 READ B$
3510 IF S ( X ) <> - 1 THEN 3540
3520 PRINT B$
3530 Z0 = Z0 + 1
3540 NEXT X
3550 IF Z0 = 0 THEN 3551 ELSE 3560
3551 PRINT "nothing."
3560 PRINT
3570 GOTO 400
3590 REM *** GET ***
3630 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 3680
3640 GOSUB 8280
3650 IF Z8 > 0 THEN 3680
3660 PRINT "Get what?"
3670 GOTO 2040
3680 RESTORE 9960
3690 FOR Z3 = 1 TO T2
3700 READ A$
3710 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 3730
3720 IF K ( 1 ) <> Z3 AND K ( 2 ) <> Z3 THEN 3900
3730 IF S ( Z3 ) <> L1 THEN 3750
3740 IF S ( Z3 ) = L1 THEN 3790
3750 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 3900
3760 PRINT A$ ; " not here."
3770 GOTO 3900
3780 REM MUST CHECK NOW FOR LEGALITY OF TAKING ITEM
3790 Z8 = 0
3800 FOR X = 1 TO T2
3810 IF S ( X ) <> - 1 THEN 3820
3811 Z8 = Z8 + 1
3820 NEXT X
3830 IF Z8 < 7 THEN 3870
3840 REM CARRYING TOO MUCH
3850 Z5 = 54 : GOSUB 7620
3860 GOTO 410
3870 GOTO 6880
3880 S ( Z3 ) = - 1
3890 PRINT A$ ; ":taken."
3900 NEXT Z3
3910 GOTO 400
3920 REM *** DROP ***
3940 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 4000
3950 GOSUB 8280
3960 IF Z8 > 0 THEN 4000
3970 PRINT "Drop what?"
3980 GOTO 2040
4000 RESTORE 9960
4010 FOR Z3 = 1 TO T2
4020 READ B$
4030 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 4060
4040 IF K ( 1 ) <> Z3 AND K ( 2 ) <> Z3 THEN 4140
4050 IF S ( Z3 ) = 0 THEN 4140
4060 IF S ( Z3 ) = - 1 THEN 4100
4070 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 4140
4080 PRINT "You don't have the " ; B$
4090 GOTO 4140
4100 REM STILL NEED TO ELABORATE ON DROP (BIRD IN CAGE, BOTTLE)
4110 GOTO 7380
4120 PRINT B$ ; ":dropped."
4130 S ( Z3 ) = L1
4140 NEXT Z3
4150 GOTO 400
4160 REM *** THROW ***
4170 GOSUB 8280
4180 IF Z8 > 0 THEN 4210
4190 PRINT "Throw what?"
4200 GOTO 2040
4210 IF S ( Z3 ) <> - 1 THEN 2710
4220 IF NOT ( Z3 < 16 AND S ( 32 ) = L1 ) THEN 4260
4230 REM THROW TREASURE TO TROLL
4240 Z5 = 27 : GOSUB 7620
4241 S ( Z3 ) = 0 : T = 3 : GOTO 400
4260 IF NOT ( Z3 = 27 AND S ( 32 ) = L1 ) THEN 4300
4270 REM TRYING TO BUTCHER TROLL?
4280 Z5 = 26 : GOSUB 7620
4281 S ( 27 ) = L1 : GOTO 400
4300 IF NOT ( Z3 = 27 AND S ( 35 ) = L1 ) THEN 4380
4310 REM TRYING TO KILL DWARF
4320 IF RND > 0.5 THEN 4360
4330 Z5 = 29 : GOSUB 7620
4340 GOSUB 8650
4350 GOTO 4410
4360 Z5 = 30 : GOSUB 7620
4361 S ( 35 ) = 0 : GOTO 4410
4380 REM NOTHING SPECIAL, JUST DROP ITEM
4390 IF S ( 35 ) <> L1 THEN 4400
4391 GOSUB 8550
4400 PRINT "Thrown."
4410 S ( Z3 ) = L1
4415 IF DEAD = 1 THEN 9540
4420 GOTO 400
4430 REM *** ATTACK ***
4440 GOSUB 8280
4450 IF NOT ( Z3 = 33 AND S ( Z3 ) = L1 AND L1 = 82 ) THEN 4520
4460 REM HE CAN KILL DRAGON
4470 Z5 = 68 : GOSUB 7620
4480 GOTO 410
4490 IF L1 <> 82 THEN 2040
4500 Z5 = 69 : GOSUB 7620
4501 S ( 33 ) = 0 : D1 = 0 : GOTO 400
4520 IF S ( 32 ) <> L1 THEN 4560
4530 REM TRYING TO MUNGE TROLL
4540 Z9 = FNA ( 25 ) : GOTO 400
4560 IF NOT ( Z3 = 26 OR Z3 > 30 ) THEN 4600
4570 REM DANGEROUS TO ATTACK THESE
4580 Z5 = 70 : GOSUB 7620
4590 GOTO 400
4600 REM NOTHING TO ATTACK
4610 Z5 = 71 : GOSUB 7620
4620 GOTO 400
4630 REM *** FEED ***
4640 GOSUB 8280
4650 IF Z3 <> 35 THEN 4690
4660 REM CAN'T FEED DWARF!
4670 Z5 = 24 : GOSUB 7620
4680 GOTO 400
4690 IF S ( 20 ) = - 1 THEN 4720
4700 B$ = "FOOD" : GOTO 2710
4720 IF L1 = 69 THEN 4760
4730 PRINT "I can't feed it."
4740 Z5 = 23 : GOSUB 7620
4750 GOTO 400
4760 IF S ( 20 ) = L1 THEN 7600
4770 B1 = 1 : S ( 20 ) = 0 : Z5 = 6 : GOSUB 7620
4790 GOTO 400
4800 REM *** WATER ***
4810 IF S ( 16 ) = - 1 THEN 4840
4820 B$ = "water" : GOTO 2710
4840 IF L1 <> 50 THEN 2200
4850 REM GOTO P1+1 OF 4860,4890,4920
4851 IF P1 = 0 THEN 4860
4852 IF P1 = 1 THEN 4890
4853 IF P1 = 2 THEN 4920
4860 Z5 = 7 : GOSUB 7620
4870 P1 = 1 : S ( 16 ) = 0 : B0 = 0 : GOTO 400
4890 Z5 = 8 : GOSUB 7620
4900 P1 = 2 : S ( 16 ) = 0 : B0 = 0 : GOTO 400
4920 Z5 = 9 : GOSUB 7620
4930 P1 = 0 : S ( 16 ) = 0 : B0 = 0 : GOTO 400
4950 REM *** LOCK ***
4960 IF L1 = 10 OR L1 = 11 THEN 4990
4970 REM NOTHING LOCKABLE
4980 GOTO 2200
4990 IF S ( 19 ) = - 1 THEN 5020
5000 B$ = "keys" : GOTO 2710
5020 G = 0 : Z5 = 10 : GOSUB 7620
5040 GOTO 400
5045 REM *** line 5050 no reachable, try and figure out what was meant
5050 S ( Z3 ) = L1
5060 REM *** UNLOCK ***
5070 IF S ( 19 ) <> - 1 THEN 5000
5080 IF L1 <> 10 AND L1 <> 11 THEN 5120
5090 G = 1 : Z5 = 11 : GOSUB 7620
5110 GOTO 400
5120 IF L1 <> 69 THEN 2200
5130 IF B1 > 0 THEN 5160
5140 Z5 = 12 : GOSUB 7620
5150 GOTO 400
5160 IF C <> 0 THEN 5170
5165 C = 1 : B1 = 2
5170 Z5 = 13 : GOSUB 7620
5180 GOTO 400
5190 REM *** FREE ***
5200 IF K ( 1 ) = 31 OR K ( 2 ) = 31 THEN 5240
5210 REM CAN'T FREE ANYTHING BUT BIRD
5220 Z5 = 2 : GOSUB 7620
5230 GOTO 410
5240 IF S ( 31 ) <> - 1 THEN 5220
5250 S ( 31 ) = L1 : B3 = 0
5260 PRINT "Freed."
5270 IF L1 <> 22 THEN 5350
5280 IF SN <> 1 THEN 400
5290 B$ = "snake"
5300 PRINT "The little bird attacks the green " ; B$ ; " and"
5310 IF L1 = 82 THEN 5380
5320 PRINT "drives it off"
5330 SN = 0 : S ( 34 ) = 0 : GOTO 400
5350 IF L1 <> 82 THEN 400
5360 B$ = "dragon" : GOTO 5300
5380 PRINT "gets burned to a crisp"
5381 S ( 20 ) = 0 : B0 = 0 : GOTO 400
5390 S ( 31 ) = 0
5400 GOTO 400
5410 REM *** WAVE ***
5420 IF K ( 1 ) <> 23 AND K ( 2 ) <> 23 THEN 2200
5430 IF S ( 23 ) = - 1 THEN 5460
5440 B$ = "rod" : GOTO 2710
5460 REM IS HERE NEAR FISSURE
5470 IF L1 <> 19 AND L1 <> 20 THEN 2200
5480 REM yes
5490 REM GOTO B2+1 OF 5500,5530
5491 IF B2 = 0 THEN 5500
5492 IF B2 = 1 THEN 5530
5500 Z5 = 14 : GOSUB 7620
5510 B2 = 1 : GOTO 400
5530 Z5 = 15 : GOSUB 7620
5540 B2 = 0 : GOTO 400
5560 REM *** OPEN ***
5570 GOSUB 8280
5580 IF Z3 > 0 THEN 5610
5590 PRINT "Open " ; : GOTO 2040
5610 IF Z3 = 40 THEN 5070
5620 IF S ( Z3 ) = L1 THEN 5650
5630 PRINT "I see no " ; B$ ; " here." : GOTO 400
5650 IF Z3 = 24 THEN 5680
5660 PRINT "I don't know how to open a " ; B$ : GOTO 400
5680 IF S ( 9 ) = - 1 THEN 5710
5690 Z5 = 16 : GOSUB 7620
5700 GOTO 400
5710 IF S ( Z3 ) = 0 THEN 2200
5720 REM HE'S OPENED CLAM, SO PRINT DESCRIPTION OF THIS
5730 REM PUT PEARL IN CUL-DE-SAC
5740 S ( 7 ) = 43 : S ( 24 ) = 0 : S ( 30 ) = L1 : Z5 = 17 : GOSUB 7620
5750 GOTO 400
5760 REM *** CLOSE ***
5770 GOSUB 8280
5780 IF Z3 = 40 THEN 4960
5790 Z5 = 18 : GOSUB 7620
5800 GOTO 400
5810 REM OIL
5820 IF K ( 1 ) <> 17 AND K ( 2 ) <> 17 THEN 2200
5830 IF S ( 17 ) = - 1 THEN 5860
5840 B$ = "oil" : GOTO 5630
5860 IF L1 <> 73 THEN 2200
5870 REM IS DOOR STILL RUSTED
5880 IF D2 = 1 THEN 2200
5890 D2 = 1 : S ( 17 ) = 0 : B0 = 0 : Z5 = 19 : GOSUB 7620
5900 GOTO 400
5910 REM *** EAT ***
5920 IF K ( 1 ) = 20 OR K ( 2 ) = 20 THEN 5950
5930 Z5 = 20 : GOSUB 7620
5940 GOTO 410
5950 Z3 = 20 : GOSUB 8490
5970 IF Z5 = 0 THEN 410
5980 Z5 = 73 : GOSUB 7620
6000 REM *** DRINK ***
6010 IF K ( 1 ) = 16 OR K ( 2 ) = 16 THEN 6040
6020 Z5 = 21 : GOSUB 7620
6030 GOTO 410
6040 Z3 = 16 : GOSUB 8490
6060 IF Z5 = 0 THEN 410
6070 Z5 = 22 : GOSUB 7620
6071 S ( 17 ) = 0 : B0 = 0 : GOTO 400
6090 REM *** FEE FIE FOE FOO ***
6100 IF L1 = 71 THEN 6130
6110 Z5 = 2 : GOSUB 7620
6120 GOTO 410
6130 IF S ( 8 ) <> L1 THEN 6180
6140 REM MAKE NEST VANISH
6150 Z5 = 79 : GOSUB 7620
6160 S ( 8 ) = 0 : GOTO 400
6180 REM IF S(8)=0 THEN 6110
6190 S ( 8 ) = L1
6200 REM MAKE NEST RE-APPEAR
6210 Z5 = 81 : GOSUB 7620
6220 GOTO 400
6230 REM *** SHORT ***
6240 PRINT "Short descriptions"
6250 D0 = 0 : GOTO 400
6270 REM *** LONG ***
6280 PRINT "Long descriptions"
6290 D0 = 1 : GOTO 400
6310 REM *** BRIEF ***
6320 PRINT "OK, I'll only describe the room in detail the first time."
6330 D0 = 2 : GOTO 400
6350 REM *** QUIT ***
6360 PRINT "Save game" ;
6370 GOSUB 9860
6380 IF Z0 = 1 THEN 8970
6390 GOTO 9750
6400 REM SCORE ***
6410 GOSUB 6430
6420 GOTO 400
6430 REM PRINT OUT SCORE DATA
6440 GOSUB 6510
6450 PRINT "Your score is now " ; S0
6451 PRINT "You have explored " , ( Z9 / T1 ) * T1 , "% of the cave."
6460 RESTORE 6470
6470 DATA "beginner" , "novice" , "experienced" , "advanced" , "expert"
6480 Z9 = INT ( ( S0 - 1 ) / 100 )
6481 IF Z9 <= 4 THEN 6483
6482 Z9 = 4
6483 FOR Z0 = 0 TO Z9
6484 READ D$
6485 NEXT Z0
6490 PRINT "That makes you a " ; D$ ; " adventurer."
6500 RETURN
6510 REM COMPUTE CURRENT SCORE
6520 RESTORE 230
6530 Z9 = 0 : S0 = 0
6540 FOR Z0 = 1 TO 15
6550 READ Z1
6560 IF Z1 = 0 THEN 6590
6570 IF V ( Z1 ) <> 1 THEN 6580
6575 S0 = S0 + 4 * O ( Z0 )
6580 IF S ( Z0 ) <> 7 THEN 6590
6585 S0 = S0 + 4 * O ( Z0 )
6590 NEXT Z0
6600 S0 = ( G = 1 ) * 10 + S0 : S0 = ( SN = 0 ) * 20 + S0 : S0 = ( D1 = 0 ) * 30 + S0 : S0 = ( T = 0 ) * 30 + S0 : S0 = ( B1 = 2 ) * 20 + S0
6605 S0 = ( B2 = 1 ) * 20 + S0 : S0 = ( P1 = 2 ) * 20 + S0 : S0 = ( D2 = 1 ) * 20 + S0 : S0 = ( C = 1 ) * 20 + S0
6610 FOR Z0 = 1 TO T1
6620 IF V ( Z0 ) <> 1 THEN 6630
6621 S0 = S0 + 1 : Z9 = Z9 + 1
6630 NEXT Z0
6640 RETURN
6660 REM list items at location l1
6680 RESTORE 12000
6690 FOR Z1 = 1 TO T2
6700 READ A$
6710 IF S ( Z1 ) <> L1 THEN 6720
6711 PRINT A$
6720 NEXT Z1
6721 IF S ( 26 ) <> - 1 THEN 6730
6722 Z5 = 67 : GOSUB 7620
6730 REM CHECK FOR DWARF,PIRATE
6740 GOSUB 8560
6745 IF DEAD = 1 THEN 9540
6750 GOSUB 8800
6760 PRINT
6770 RETURN
6775 REM Print Short room description
6780 FSEEK # 1 , 0
6820 FOR Z1 = 1 TO L1
6830 INPUT # 1 , A$
6840 NEXT Z1
6850 V ( L1 ) = 1
6860 PRINT A$
6870 RETURN
6880 REM SPECIAL GETS
6890 IF NOT ( Z3 = 24 OR Z3 = 30 OR Z3 > 31 ) THEN 6930
6900 REM CAN'T GET THESE FOR SOME REASON
6910 Z5 = 61 : GOSUB 7620
6920 GOTO 400
6930 IF NOT ( Z3 = 12 AND C = 0 ) THEN 6970
6940 REM CHAIN
6950 Z5 = 58 : GOSUB 7620
6960 GOTO 3900
6970 REM BEAR IS HE FED? UNLOCKED?
6980 IF NOT ( Z3 = 26 AND B1 <> 2 ) THEN 7010
6990 Z5 = 61 : GOSUB 7620
7000 GOTO 3900
7010 IF NOT ( Z3 = 14 AND D1 = 1 ) THEN 7050
7020 REM DRAGON AND RUG
7030 Z5 = 59 : GOSUB 7620
7040 GOTO 3900
7050 IF NOT ( Z3 = 16 OR Z3 = 17 ) THEN 7090
7060 REM OIL AND WATER DO SAME AS FILL
7070 PRINT "Why not say 'fill'?"
7080 GOTO 3900
7090 IF NOT ( Z3 = 22 AND B3 ) THEN 7140
7100 REM TAKE BIRD SINCE IT'S IN CAGE
7110 S ( 31 ) = - 1 : PRINT "Bird and " ; : GOTO 3880
7140 IF Z3 <> 31 THEN 7310
7150 REM GETTING BIRD
7160 IF B3 <> 1 THEN 7210
7170 REM TAKE CAGE, SINCE BIRD IS IN IT
7180 PRINT "Cage and " ; : S ( 22 ) = - 1 : GOTO 3880
7210 IF S ( 22 ) = - 1 THEN 7240
7220 B$ = "cage" : GOTO 2810
7240 IF S ( 23 ) = - 1 THEN 7280
7250 REM OK TO TAKE BIRD
7260 S ( 31 ) = - 1 : B3 = 1 : GOTO 3890
7280 REM ROD SCARES BIRD
7290 Z5 = 37 : GOSUB 7620
7300 GOTO 3900
7310 REM BOTTLE FULL? IF SO, GET CONTENTS
7320 IF NOT ( Z3 = 21 AND B0 ) THEN 7360
7330 PRINT "Contents and the " ;
7340 S ( B0 + 15 ) = - 1
7360 GOTO 3880
7370 REM SPECIAL "DROP"
7380 IF Z3 <> 31 THEN 7440
7390 REM BIRD IN CAGE
7400 S ( 31 ) = L1 : S ( 22 ) = L1 : B3 = 1
7410 IF Z3 <> 31 THEN 7420
7415 PRINT "Cage and " ;
7420 IF Z3 = 22 THEN 7430
7425 PRINT "Bird and " ;
7430 GOTO 4120
7440 IF Z3 = 22 AND B3 = 1 THEN 7400
7450 IF Z3 <> 21 THEN 7520
7460 REM BOTTLE
7470 IF B0 = 0 THEN 4120
7480 REM BOTTLE IS FULL, DO DROP CONTENTS TOO
7490 PRINT "Contents and " ;
7500 S ( 15 + B0 ) = L1 : GOTO 4120
7520 IF NOT ( Z3 = 16 OR Z3 = 17 ) THEN 7541
7530 PRINT "Try saying 'empty'" : GOTO 4140
7541 IF Z3 <> 26 OR T <> 1 OR ( L1 <> 60 AND L1 <> 61 ) THEN 7550
7542 Z5 = 28 : GOSUB 7620
7543 T = 0 : S ( 26 ) = L1 : S ( 32 ) = 0 : GOTO 400
7550 IF Z3 <> 6 THEN 4120
7560 IF S ( 28 ) = L1 THEN 7600
7570 REM GOODBYE, FRAGILE VASE!
7580 Z5 = 43 : GOSUB 7620
7581 S ( 6 ) = 0 : S ( 29 ) = L1 : GOTO 400
7600 Z5 = 60 : GOSUB 7620
7610 GOTO 4120
7619 REM PRINT MESSAGE
7620 IF INDX ( 1 ) >= 0 THEN 7640
7630 GOSUB 12500
7640 Z5 = INT ( Z5 ) : XTMP = INDX ( Z5 )
7645 IF Z5 <> 2 AND Z5 <> 61 THEN 7660
7650 XTMP = FRAINDX ( XTMP + MIN ( INT ( RND * 5 ) , 5 ) )
7660 FSEEK # 3 , XTMP
7670 INPUT # 3 , B1$
7672 IF LEN ( B1$ ) = 0 THEN 7673 ELSE 7680
7673 B1$ = " "
7680 REM if eof(3) then 7760
7690 IF INSTR ( B1$ , "#" ) = 0 THEN 7670
7700 Z4 = VAL ( MID$ ( B1$ , 2 ) )
7705 IF INT ( Z4 ) = Z5 THEN 7720
7710 IF INT ( Z4 ) < Z5 THEN 7670
7712 IF INT ( Z4 ) > Z5 THEN 7760
7720 INPUT # 3 , B1$
7730 IF MID$ ( B1$ , 1 , 1 ) = "#" THEN 7770
7740 PRINT B1$
7750 GOTO 7720
7760 PRINT "NO DESC. # " ; Z5 ; " IN FILE AMESSAGE"
7770 RETURN
7800 REM
7810 REM SITUATION DESCRIPTIONS
7820 REM
7830 REM GRATE
7840 IF L1 = 10 OR L1 = 11 THEN 7842 ELSE 7850
7842 Z5 = ( G + 10 ) : GOSUB 7620
7850 REM CRYSTAL BRIDGE
7860 IF ( L1 = 19 OR L1 = 20 ) AND B2 = 1 THEN 7861 ELSE 7870
7861 Z5 = 14 : GOSUB 7620
7870 REM PLUGH NOISE
7880 IF L1 = 26 AND RND > 0.3 THEN 7881 ELSE 7890
7881 Z5 = 41 : GOSUB 7620
7890 REM IRON DOOR
7900 IF L1 = 73 AND D2 = 0 THEN 7901 ELSE 7910
7901 Z5 = 57 : GOSUB 7620
7910 REM TROLL
7920 IF ( L1 = 60 OR L1 = 61 ) AND T = 1 THEN 7921 ELSE 7930
7921 Z5 = 63 : GOSUB 7620
7930 REM BEAR
7940 IF L1 = 69 AND B1 = 0 THEN 7941 ELSE 7950
7941 Z5 = 64 : GOSUB 7620
7950 IF L1 = 69 AND B1 = 1 THEN 7951 ELSE 7960
7951 Z5 = 66 : GOSUB 7620
7960 REM PLANT IN PIT
7970 IF L1 = 48 OR L1 = 50 THEN 7971 ELSE 7980
7971 Z5 = 47 + P1 : GOSUB 7620
7980 RETURN
7990 REM
8000 REM print long room description from "amessage" file
8010 REM description is noormally l1+200 except for
8020 REM maze or forest
8030 REM set v(l1)=1 so as not to repeat long desc(brief mode
8040 V ( L1 ) = 1
8050 IF L1 > 4 THEN 8080
8060 Z5 = 200 : GOSUB 7620
8070 GOTO 8130
8080 IF NOT ( L1 > 88 AND L1 < 98 OR L1 = 99 ) THEN 8110
8090 Z5 = 288 : GOSUB 7620
8100 GOTO 8130
8110 REM normal description
8120 Z5 = 200 + L1 : GOSUB 7620
8130 RETURN
8180 REM always give long descriptio nfor forest and maze
8190 IF L1 < 5 OR ( L1 > 88 AND L1 < 98 ) OR L1 = 99 THEN 8220
8200 IF V ( L1 ) THEN 8201 ELSE 8220
8201 GOSUB 6780
8202 GOTO 8235
8210 REM he hassn't seen this room, so give a long desc.
8220 V ( L1 ) = 1
8230 GOSUB 7990
8235 RETURN
8240 REM
8250 REM fetch first item code in k(1 to t2)
8260 REM z8=total # of items found in list
8270 REM z3=item code first found
8280 Z8 = 0 : Z3 = 0 : D$ = ""
8290 RESTORE 9960
8300 FOR Z5 = 1 TO 45
8310 READ B$
8320 IF K ( 1 ) <> Z5 AND K ( 2 ) <> Z5 THEN 8360
8330 Z8 = Z8 + 1
8340 D$ = B$
8350 IF K ( 1 ) = Z5 AND Z8 = 1 THEN 8352
8351 IF K ( 2 ) = Z5 AND Z8 = 1 THEN 8352 ELSE 8360
8352 Z3 = Z5
8360 NEXT Z5
8370 B$ = D$
8380 RETURN
8390 REM FIND FIRST ITEM AT ROOM
8400 RESTORE 9960
8405 X1 = 0
8410 FOR Z1 = 1 TO 47
8415 IF X1 = 1 THEN 8440
8420 READ D$
8430 IF K ( 1 ) = Z1 OR K ( 2 ) = Z1 THEN 8431 ELSE 8440
8431 X1 = 1
8440 NEXT Z1
8450 RETURN
8460 REM 
8470 REM MAKE SURE HE'S CARRYING ITEM * Z3
8480 REM
8490 IF S ( Z3 ) = - 1 THEN 8530
8500 PRINT "You don't have the " ; A$
8510 Z5 = 0
8520 RETURN
8530 Z5 = 1
8540 RETURN
8550 REM *** DWARF ***
8560 IF D3 <> 0 THEN 8640
8570 REM SHOULD DWARF GIVE AWAY AXE?
8580 IF L1 < 13 THEN 8790
8590 IF RND > 0.05 THEN 8790
8600 REM GIVE AWAY AXE
8610 Z5 = 80 : GOSUB 7620
8620 S ( 27 ) = L1 : D3 = 1
8630 GOTO 8790
8640 REM SHOULD DWARF ATTACK?
8650 IF L1 < 13 THEN 8790
8660 IF S ( 35 ) <> L1 THEN 8770
8670 IF RND > 0.5 THEN 8790
8680 REM YES!
8690 Z5 = 32 : GOSUB 7620
8700 REM DOES THE KNIFE KILL THE PLAYER?
8705 KC = KC - 0.02
8706 IF KC >= 0.5 THEN 8710
8707 KC = 0.5
8710 IF RND <= KC THEN 8750
8720 REM YES
8730 PRINT "It gets you!"
8740 DEAD = 1 : GOTO 8790
8750 PRINT "It misses!"
8760 GOTO 8790
8770 REM SHOULD WE PUT A DWARF HERE?
8780 IF RND >= 0.1 THEN 8790
8785 S ( 35 ) = L1
8790 RETURN
8800 REM *** PIRATE ***
8810 REM FIRST, DOES HE HAVE ANYTHING WORTH STEALING?
8820 Z3 = 0
8830 IF L1 < 13 THEN 8960
8840 FOR X = 1 TO 15
8850 IF S ( X ) <> - 1 THEN 8860
8855 Z3 = Z3 + 1
8860 NEXT X
8870 IF Z3 < INT ( RND * 4 ) + 1 THEN 8960
8880 REM SHOULD WE RIP OFF HIS VALUABLES?
8890 IF RND < 0.05 THEN 8920
8900 Z5 = 34 : GOSUB 7620
8910 GOTO 8960
8920 Z5 = 33 : GOSUB 7620
8930 FOR X = 1 TO 15
8940 IF S ( X ) <> - 1 THEN 8950
8945 S ( X ) = 100
8950 NEXT X
8960 RETURN
8970 REM *** SAVE GAME ***
8980 INPUT "What do you want to call the save file? " , A$
8990 OPEN A$ FOR OUTPUT AS # 5 ELSE 9010
9000 GOTO 9030
9010 PRINT "File " , A$ , " not created"
9020 GOTO 410
9030 PRINT # 5 , T1 , "," , T2 , "," , T3 , "," , L1 , "," , L2 , "," , G , "," , B0 , "," , SN , "," , D1 , "," , D2 , "," , D0 , "," , T , "," , B1 , "," , B2 , "," , P1 , "," , L , "," , C , "," , D3 , "," , B3 , "," , R0 , "," , KC
9040 FOR X = 1 TO 99
9041 PRINT # 5 , S ( X ) , "," , V ( X )
9042 NEXT X
9043 PRINT # 5 , V ( 100 )
9044 CLOSE # 5
9050 PRINT "Game saved"
9051 C0 = 0
9060 IF K ( 1 ) = 143 OR K ( 2 ) = 143 THEN 9750
9070 GOTO 410
9080 REM *** LOAD OLD GAME ***
9090 IF C0 = 0 THEN 9120
9100 PRINT "You already have a loaded game!"
9110 GOTO 410
9120 INPUT "Save file name? " , A$
9130 OPEN A$ FOR INPUT AS # 5 ELSE 9150
9140 GOTO 9170
9150 PRINT "Unable to use file " ; A$
9160 GOTO 410
9170 INPUT # 5 , T1 , T2 , T3 , L1 , L2 , G , B0 , SN , D1 , D2 , D0 , T , B1 , B2 , P1 , L , C , D3 , B3 , R0 , KCX$
9171 KC = VAL ( KCX$ )
9180 FOR X = 1 TO 99
9191 INPUT # 5 , SX , VX : S ( X ) = SX : V ( X ) = VX
9192 NEXT X
9193 INPUT # 5 , VX : V ( 100 ) = VX
9194 CLOSE # 5
9200 C0 = 1
9210 GOTO 300
9220 REM *** READ THE MAGAZINE ***
9230 GOSUB 8280
9240 IF Z3 = 25 THEN 9270
9250 Z5 = 74 : GOSUB 7620
9260 GOTO 410
9270 IF S ( 25 ) = - 1 THEN 9300
9280 B$ = "magazine"
9290 GOTO 2710
9300 REM OK, LET HIM READ IT
9310 Z5 = 303 : GOSUB 7620
9320 GOTO 400
9330 REM *** BUG ***
9340 A$ = "ADVBUGS.TXT"
9341 OPEN A$ FOR APPEND AS # 5 ELSE 9150
9390 INPUT "Your name: " , A$
9400 A$ = A$ + " " + DATE$
9410 PRINT # 5 , A$
9420 PRINT "Enter your gripe in up to five lines (hit return to quit):"
9430 FOR Z0 = 1 TO 5
9440 PRINT Z0 ;
9450 INPUT A$
9460 IF A$ = "" THEN 9490
9470 PRINT # 5 , A$
9480 NEXT Z0
9490 PRINT "Message recorded. Thank you!"
9500 CLOSE # 5
9510 GOTO 410
9540 REM REINCARNATE HIM
9550 R0 = R0 + 1
9560 IF R0 = 1 THEN 9580
9561 IF R0 = 2 THEN 9610
9562 IF R0 = 3 THEN 9740
9570 REM ASK HIM IF HE WANTS TO BE REINCARNATED
9580 Z5 = 75 : GOSUB 7620
9590 GOSUB 9860
9600 GOTO 9630
9610 Z5 = 77 : GOSUB 7620
9620 GOTO 9580
9630 IF Z0 = 0 THEN 9750
9640 Z5 = 76 : GOSUB 7620
9650 REM PUT HIM BACK IN HOUSE, REARRANGE HIS STUFF
9660 S ( 18 ) = 7 : L = 0 : DEAD = 0 : KC = 1.03
9670 FOR X = 1 TO T2
9680 IF S ( X ) <> - 1 THEN 9690
9685 S ( X ) = L1
9690 NEXT X
9700 REM WE'VE PUT THE LAMP IN HOUSE AND OTHER ITEMS WHERE HE DIED
9710 L1 = INT ( RND * 4 ) + 1 : L2 = L1
9720 GOTO 320
9730 REM THIRD DEATH--END OF GAME
9740 Z5 = 78 : GOSUB 7620
9750 PRINT "Oh well..."
9760 GOSUB 6430
9762 CLOSE # 1 : CLOSE # 3
9770 STOP
9780 REM *** PITS ***
9790 IF L1 < 13 THEN 1210
9791 IF L = 1 AND ( S ( 18 ) = - 1 OR S ( 18 ) = L1 ) THEN 1210
9800 REM IS HE GOING TO FALL INTO A PIT?
9810 IF L1 = 16 OR L1 = 17 OR L1 = 19 OR L1 = 20 OR L1 = 25 OR L1 = 47 OR L1 = 48 OR L1 = 59 OR L1 = 60 OR L1 = 61 OR L1 = 75 OR L1 = 76 OR L1 = 98 THEN 9840
9820 GOTO 1210
9830 REM he fell into a pit
9840 Z5 = 44 : GOSUB 7620
9850 GOTO 9540
9860 REM *** SEEK A "YES" OR "NO"
9870 INPUT A$
9875 IF LEN ( A$ ) <> 0 THEN 9880
9877 A$ = " "
9880 A$ = LOWER$ ( MID$ ( A$ , 1 , 1 ) )
9890 IF A$ <> "y" AND A$ <> "n" THEN 9930
9900 IF A$ = "y" THEN 9901 ELSE 9910
9901 Z0 = 1
9910 IF A$ = "n" THEN 9911 ELSE 9920
9911 Z0 = 0
9920 GOTO 9945
9930 PRINT "Yes or No-" ;
9940 GOTO 9870
9945 RETURN
9950 REM ---- SHORT NAMES FOR STUFF ----
9960 DATA "large gold nugget" , "bars of silver" , "precious jewelry"
9962 DATA "many coins" , "several diamonds" , "fragile ming vase"
9964 DATA "glistening pearl" , "nest of golden eggs" , "jewel-encrusted trident"
9966 DATA "egg-sized emerald" , "platinum pyramid" , "golden chain"
9968 DATA "rare spices" , "persian rug" , "treasure chest" , "water" , "oil"
9970 DATA "brass lamp" , "keys" , "food" , "bottle" , "wicker cage"
9980 DATA "3-foot black rod" , "clam" , "magazine" , "bear" , "axe" , "velvet pillow"
9982 DATA "shards of pottery" , "oyster" , "bird" , "troll" , "dragon" , "snake"
9984 DATA "dwarf" , "rock" , "stairs" , "steps" , "house" , "grate" , "stream" , "room" , "bridge"
9986 DATA "pit" , "volcano" , "road"
10570 REM DIRECTIONS
10580 DATA 100 , " N " , 101 , " NE " , 102 , " E " , 103 , " SE " , 104 , " S " , 105 , " SW " , 106 , " W " , 107 , " NW " , 108 , " U " , 109 , " D "
10590 REM VERBS
10600 DATA 110 , " PLUGH " , 111 , " XYZZY " , 112 , " PLOVER " , 113 , " CROSS " , 114 , " CLIMB " , 115 , " JUMP " , 116 , " FILL " , 117 , " EMPTY " , 117 , " POUR " , 118 , " LOOK " , 118 , " L " , 119 , " LIGHT "
10610 DATA 119 , " ON " , 120 , " EXTINGUISH " , 120 , " OFF " , 121 , " IN " , 121 , " ENTER " , 122 , " LEAVE " , 122 , " OUT " , 123 , " INVENTORY " , 123 , " I " , 124 , " GET " , 124 , " CATCH " , 124 , " TAKE "
10620 DATA 125 , " DROP " , 125 , " DUMP " , 126 , " THROW " , 127 , " ATTACK " , 127 , " KILL " , 128 , " FEED " , 129 , " WATER " , 130 , " LOCK " , 131 , " UNLOCK " , 132 , " FREE " , 132 , " RELEASE " , 133 , " WAVE "
10630 DATA 134 , " OPEN " , 135 , " CLOSE " , 136 , " OIL " , 137 , " EAT " , 138 , " DRINK " , 139 , " FEE FIE FOE FOO " , 140 , " SHORT " , 141 , " LONG " , 142 , " BRIEF " , 143 , " QUIT " , 143 , " STOP " , 143 , " END "
10640 DATA 144 , " SCORE " , 145 , " SAVE " , 146 , " LOAD " , 147 , " READ " , 147 , " EXAMINE " , 148 , " YES " , 148 , " Y " , 149 , " BUG "
10650 REM items
10660 DATA 1 , " GOLD " , 1 , " NUGGET " , 2 , " BARS " , 2 , " SILVER " , 3 , " JEWELRY " , 4 , " COINS " , 5 , " DIAMONDS " , 6 , " MING " , 6 , " VASE " , 7 , " PEARL " , 8 , " EGGS " , 8 , " NEST " , 9 , " TRIDENT "
10670 DATA 10 , " EMERALD " , 11 , " PLATINUM " , 11 , " PYRAMID " , 12 , " CHAIN " , 13 , " SPICES " , 14 , " PERSIAN " , 14 , " RUG " , 15 , " TREASURE " , 15 , " CHEST " , 16 , " WATER " , 17 , " OIL "
10680 DATA 18 , " LAMP " , 18 , " LANTERN " , 19 , " KEYS " , 20 , " FOOD " , 21 , " BOTTLE " , 22 , " CAGE " , 23 , " ROD " , 23 , " WAND " , 24 , " CLAM " , 25 , " MAGAZINE " , 26 , " BEAR " , 27 , " AXE " , 28 , " VELVET "
10690 DATA 28 , " PILLOW " , 29 , " SHARDS " , 30 , " OYSTER " , 31 , " BIRD " , 32 , " TROLL " , 33 , " DRAGON " , 34 , " SNAKE " , 35 , " DWARF " , 36 , " ROCK " , 36 , " BOULDER " , 37 , " STAIRS " , 38 , " STEPS "
10700 DATA 39 , " HOUSE " , 39 , " BUILDING " , 40 , " GRATE " , 41 , " STREAM " , 42 , " ROOM " , 43 , " BRIDGE " , 44 , " PIT " , 45 , " VOLCANO " , 46 , " ROAD " , 47 , " ALL " , 47 , " EVERYTHING "
10710 REM LONG DIRECTIONS
10720 DATA 100 , " NORTH " , 101 , " NORTHEAST " , 102 , " EAST " , 103 , " SOUTHEAST " , 104 , " SOUTH " , 105 , " SOUTHWEST " , 106 , " WEST " , 107 , " NORTHWEST " , 108 , " UP " , 109 , " DOWN " , 150 , "*"
12000 DATA "There is a large sparking nugget of gold here!"
12010 DATA "There are bars of silver here!"
12020 DATA "There is precious jewelry here!"
12030 DATA "There are many coins here!"
12040 DATA "There are several diamonds here!"
12050 DATA "There is a delicate, precious ming vase here!"
12060 DATA "To one side lies a glistening Pearl!"
12070 DATA "There is a nest here, full of golden eggs!"
12080 DATA "There is a jewel-encrusted trident here!"
12090 DATA "There is an emerald the size of a plover's egg here!"
12100 DATA "There is a platinum pyramid here, eight inches on a side!"
12110 DATA "There is a golden chain here!"
12120 DATA "There are rare spices here!"
12130 DATA "There is a valuable persian rug here!"
12140 DATA "There is a chest here, full of various treasures!"
12150 DATA "There is a bottle of water here."
12160 DATA "There is a small pool of oil here."
12170 DATA "There is a brass lantern here."
12180 DATA "There is a set of keys here."
12190 DATA "There is food here."
12200 DATA "There is a glass bottle here."
12210 DATA "There is a small wicker cage here."
12220 DATA "There is a 3-foot black rod here."
12230 DATA "There is an enormous clam here with its shell tightly shut."
12240 DATA "There is a recent issue of 'Spelunker Today' here."
12250 DATA "There is a bear nearby."
12260 DATA "There is a little axe here."
12270 DATA "There is a purple velvet pillow here."
12280 DATA "There are shards of pottery scattered about."
12290 DATA "There is an enormous oyster here with its shell tightly shut."
12300 DATA "There is a little bird here."
12310 DATA "A burly troll stands in front of you."
12320 DATA "A huge fierce green dragon bars the way!"
12330 DATA "A huge fierce green snake bars the way!"
12340 DATA "There is a threatening little dwarf  in the room with you!"
12500 REM INITIALIZE MESSAGE INDEX
12501 OPEN "AMESSAGE.IDX" FOR INPUT AS # 6 ELSE 12505
12502 GOTO 12610
12504 REM Message indx file doesn't exist, create it
12505 OPEN "AMESSAGE.IDX" FOR OUTPUT AS # 6
12506 FPOS = - 2 : B$ = "" : FRACNT = 0 : LASTFRA = - 1 : FSEEK # 3 , 0
12520 FPOS = FPOS + LEN ( B$ ) + 2
12522 INPUT # 3 , B$
12530 IF LEN ( B$ ) = 0 THEN 12531 ELSE 12540
12531 B$ = " " : FPOS = FPOS - 1
12540 IF B$ = "#" THEN 12591
12550 IF INSTR ( B$ , "#" ) = 0 THEN 12520
12560 Z4 = VAL ( MID$ ( B$ , 2 ) )
12561 REM print b$," ->",z4,"<-",len(b$)
12570 IF INT ( Z4 ) = Z4 THEN 12580
12571 FRACNT = FRACNT + 1
12572 IF LASTFRA = INT ( Z4 ) THEN 12574
12573 INDX ( INT ( Z4 ) ) = FRACNT : LASTFRA = INT ( Z4 ) : PRINT # 6 , INT ( Z4 ) , "," , FRACNT
12574 FRAINDX ( FRACNT ) = FPOS
12576 GOTO 12585
12580 INDX ( INT ( Z4 ) ) = FPOS
12581 PRINT # 6 , INT ( Z4 ) , "," , FPOS
12585 PRINT "*" ;
12590 GOTO 12520
12591 PRINT # 6 , - 999 , "," , - 999
12592 FOR I = 1 TO FRACNT
12593 PRINT # 6 , FRAINDX ( I )
12594 NEXT I
12595 PRINT # 6 , - 999
12596 CLOSE # 3
12597 OPEN "AMESSAGE" FOR INPUT AS # 3
12600 GOTO 12670
12604 REM READ AMESSAGE.IDX FILE INTO ARRAYS
12610 INPUT # 6 , II , I
12612 PRINT "*" ;
12615 IF I = - 999 THEN 12630
12620 INDX ( II ) = I : GOTO 12610
12630 II = 0
12640 INPUT # 6 , I
12641 PRINT "*" ;
12650 IF I = - 999 THEN 12670
12660 II = II + 1 : FRAINDX ( II ) = I : GOTO 12640
12670 CLOSE # 6 : PRINT : PRINT
12680 RETURN
