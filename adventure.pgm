10,0
11,62
12,126
13,177
14,185
15,250
16,328
17,402
18,410
19,495
20,575
21,628
22,654
23,725
24,795
44,831
45,910
46,936
47,957
50,980
51,997
52,1015
53,1031
70,1048
110,1084
130,1104
150,1145
160,1185
161,1292
162,1398
170,1413
171,1435
172,1468
175,1481
182,1514
190,1555
192,1606
193,1629
194,1704
195,1827
196,1951
197,1968
198,1981
200,1996
210,2013
220,2049
221,2078
222,2217
228,2234
230,-2247
231,-2280
232,-2312
233,-2346
234,-2375
235,-2407
236,-2437
240,2471
241,2501
242,2640
243,2657
245,-2670
246,-2698
247,-2726
260,2754
263,2790
264,2817
266,2833
267,2862
280,2889
300,2920
310,2947
320,2996
321,3032
330,3095
340,3121
350,3135
360,3175
365,3206
370,3224
375,3240
380,3267
390,3283
400,3350
410,3382
420,3402
425,3427
431,3457
432,3487
433,3511
434,3542
435,3582
440,3599
449,3623
450,3689
460,3718
470,3756
471,3844
480,3906
560,3918
565,3973
780,4008
800,4028
810,4068
820,4105
830,4131
850,4174
860,4222
861,4272
890,4322
900,4344
910,4357
920,4406
930,4464
940,4480
950,4537
980,4551
990,4602
1000,4653
1010,4686
1020,4708
1030,4764
1040,4777
1050,4811
1060,4827
1070,4859
1130,4886
1140,4914
1150,4952
1160,4976
1170,5020
1180,5036
1190,5060
1191,5103
1200,5123
1210,5139
1220,5154
1221,5167
1230,5184
1240,5199
1250,5233
1260,5249
1261,5300
1270,5360
1280,5402
1290,5427
1300,5454
1310,5469
1320,5507
1330,5570
1340,5597
1350,5612
1360,5649
1370,5715
1380,5737
1390,5763
1400,5778
1410,5805
1420,5862
1430,5888
1440,5915
1460,5930
1470,5971
1480,6028
1490,6057
1500,6084
1510,6099
1520,6118
1530,-6140
1540,6174
1550,6214
1560,6228
1570,6242
1580,6258
1590,6279
1600,6307
1610,6340
1620,6370
1630,6383
1640,6410
1650,6425
1660,6439
1670,6453
1680,6469
1690,6493
1691,6539
1700,6630
1710,6653
1720,6680
1730,6715
1740,6742
1750,6757
1760,6771
1770,6787
1780,6803
1781,6840
1790,6887
1800,6933
1810,6960
1820,6975
1821,7002
1830,7029
1840,7052
1850,7064
1860,7080
1870,7136
1880,7163
1890,7178
1900,7241
1910,7258
1920,7285
1930,7300
1940,7316
1950,7341
1960,7408
1980,7475
1990,7502
1991,7552
2000,7612
2001,7635
2010,7657
2020,7675
2021,7724
2022,7747
2023,7761
2030,7776
2040,7789
2050,7808
2051,7847
2052,7861
2060,7874
2070,-7889
2080,7989
2090,8004
2095,8024
2110,8319
2120,8335
2130,8359
2140,8386
2150,8427
2160,8441
2170,8457
2180,8485
2190,8498
2200,8514
2210,8540
2220,8555
2230,8579
2240,8606
2250,8647
2260,8661
2270,8677
2280,8705
2290,8718
2300,8734
2310,8790
2320,8817
2325,8851
2330,8870
2335,8905
2340,8925
2350,8939
2360,8955
2370,8983
2380,8997
2390,9013
2400,9037
2410,9065
2420,9092
2430,9118
2440,9133
2450,9145
2460,9197
2470,9213
2480,9241
2490,9267
2500,9279
2510,9295
2520,9323
2530,9335
2540,9351
2550,9379
2560,9391
2570,9407
2580,9431
2590,9459
2600,9493
2610,9519
2620,9533
2630,9547
2640,9563
2650,9604
2660,9671
2670,9697
2680,9713
2690,9728
2700,9762
2710,9782
2720,9821
2730,9836
2740,9862
2750,9888
2760,9903
2770,9993
2780,10023
2790,10039
2800,10066
2810,10083
2820,10123
2830,10138
2840,10168
2850,10208
2860,10223
2870,10247
2880,10281
2890,10297
2900,10335
2910,10368
2920,10390
2930,10405
2940,10428
2941,10466
2950,10531
2960,10558
2970,10573
2980,10590
2990,10607
3000,10622
3010,10646
3020,10680
3030,10698
3040,10714
3050,10726
3060,10742
3070,10778
3080,10794
3090,10829
3100,10863
3110,10879
3120,10904
3130,10920
3140,10944
3150,10971
3160,10990
3170,11002
3180,11018
3190,11046
3200,11071
3210,11083
3240,11099
3250,11122
3260,11150
3270,11189
3280,11203
3290,11219
3300,11242
3310,11269
3320,11291
3330,11303
3340,11319
3350,11347
3360,11375
3370,11387
3400,11403
3410,11426
3420,11454
3430,11493
3440,11507
3450,11523
3460,11551
3470,11574
3480,11587
3490,11621
3500,11643
3510,11661
3511,11695
3520,11728
3530,11743
3540,11761
3550,11774
3551,11810
3560,11833
3570,11845
3590,11860
3630,11882
3640,11930
3650,11947
3660,11973
3670,11997
3680,12013
3690,12036
3700,12059
3710,12077
3720,12125
3730,12176
3740,12210
3750,12243
3760,12291
3770,12351
3780,12367
3790,12420
3800,12433
3810,12455
3811,12489
3820,12507
3830,12520
3840,12546
3850,12574
3860,12601
3870,12616
3880,12632
3890,12653
3900,12710
3910,12724
3920,12739
3940,12762
3950,12810
3960,12827
3970,12853
3980,12878
4000,12894
4010,12917
4020,12940
4030,12958
4040,13006
4050,13057
4060,13089
4070,13123
4080,13171
4090,13240
4100,13256
4110,13321
4120,13337
4130,13396
4140,13416
4150,13430
4160,13445
4170,13469
4180,13486
4190,13512
4200,13538
4210,13554
4220,13589
4230,13642
4240,13676
4241,13703
4260,13741
4270,13794
4280,13829
4281,13856
4300,13887
4310,13940
4320,13971
4330,14000
4340,14027
4350,14044
4360,14060
4361,14087
4380,14118
4390,14160
4391,14194
4400,14211
4410,14233
4415,14253
4420,14281
4430,14296
4440,14321
4450,14338
4460,14403
4470,14432
4480,14459
4490,14474
4500,14502
4501,14529
4520,14568
4530,14602
4540,14634
4560,14667
4570,14713
4580,14749
4590,14776
4600,14791
4610,14819
4620,14846
4630,14861
4640,14884
4650,14901
4660,14929
4670,14957
4680,14984
4690,14999
4700,15033
4720,15063
4730,15090
4740,15121
4750,15148
4760,15163
4770,15196
4790,15246
4800,15261
4810,15285
4820,15319
4840,15350
4850,15378
4851,15416
4852,15442
4853,15468
4860,15494
4870,15520
4890,15568
4900,15594
4920,15642
4930,15668
4950,15716
4960,15739
4970,15777
4980,15804
4990,15820
5000,15854
5020,15884
5040,15919
5045,15934
5050,16006
5060,16026
5070,16051
5080,16086
5090,16127
5110,16162
5120,16177
5130,16205
5140,16231
5150,16258
5160,16273
5165,16299
5170,16320
5180,16347
5190,16362
5200,16385
5210,16433
5220,16472
5230,16498
5240,16513
5250,16548
5260,16577
5270,16598
5280,16626
5290,16652
5300,16671
5310,16734
5320,16761
5330,16789
5350,16828
5360,16855
5380,16887
5381,16924
5390,16963
5400,16982
5410,16997
5420,17020
5430,17071
5440,17105
5460,17134
5470,17165
5480,17206
5490,17220
5491,17253
5492,17279
5500,17305
5510,17332
5530,17356
5540,17383
5560,17407
5570,17430
5580,17447
5590,17473
5610,17507
5620,17534
5630,17567
5650,17618
5660,17645
5680,17703
5690,17736
5700,17763
5710,17778
5720,17810
5730,17867
5740,17901
5750,17974
5760,17989
5770,18013
5780,18030
5790,18057
5800,18084
5810,18099
5820,18113
5830,18164
5840,18198
5860,18227
5870,18255
5880,18286
5890,18312
5900,18372
5910,18387
5920,18409
5930,18457
5940,18484
5950,18499
5970,18526
5980,18551
6000,18578
6010,18602
6020,18650
6030,18677
6040,18692
6060,18719
6070,18744
6071,18771
6090,18810
6100,18844
6110,18871
6120,18897
6130,18912
6140,18945
6150,18972
6160,18999
6180,19028
6190,19058
6200,19077
6210,19107
6220,19134
6230,19149
6240,19173
6250,19206
6270,19230
6280,19253
6290,19285
6310,19309
6320,19333
6330,19405
6350,19429
6360,19452
6370,19478
6380,19495
6390,19521
6400,19537
6410,19557
6420,19574
6430,19589
6440,19620
6450,19637
6451,19675
6460,19746
6470,-19765
6480,19838
6481,19874
6482,19901
6483,19914
6484,19937
6485,19951
6490,19965
6500,20019
6510,20032
6520,20064
6530,20082
6540,20104
6550,20127
6560,20141
6570,20167
6575,20200
6580,20229
6585,20262
6590,20291
6600,20305
6605,20447
6610,20562
6620,20585
6621,20618
6630,20650
6640,20664
6660,20677
6680,20713
6690,20733
6700,20756
6710,20777
6711,20811
6720,20826
6721,20840
6722,20875
6730,20902
6740,20935
6745,20952
6750,20980
6760,20997
6770,21009
6775,21022
6780,21061
6820,21081
6830,21104
6840,21125
6850,21139
6860,21158
6870,21173
6880,21186
6890,21209
6900,21266
6910,21308
6920,21335
6930,21350
6940,21395
6950,21411
6960,21438
6970,21454
6980,21490
6990,21537
7000,21564
7010,21580
7020,21626
7030,21651
7040,21678
7050,21694
7060,21740
7070,21780
7080,21814
7090,21830
7100,21872
7110,21911
7140,21966
7150,21994
7160,22017
7170,22044
7180,22085
7210,22140
7220,22174
7240,22204
7250,22238
7260,22264
7280,22306
7290,22332
7300,22359
7310,22375
7320,22418
7330,22460
7340,22494
7360,22520
7370,22536
7380,22561
7390,22589
7400,22612
7410,22657
7415,22685
7420,22711
7425,22738
7430,22764
7440,22780
7450,22818
7460,22846
7470,22863
7480,22889
7490,22936
7500,22966
7520,23003
7530,23049
7541,23094
7542,23161
7543,23188
7550,23242
7560,23269
7570,23302
7580,23335
7581,23362
7600,23407
7610,23434
7619,23450
7620,23474
7630,23509
7640,23527
7645,23570
7650,23610
7660,23670
7670,23693
7672,23715
7673,23760
7680,23776
7690,23806
7700,23849
7705,23885
7710,23920
7712,23955
7720,23990
7730,24012
7740,24058
7750,24074
7760,24090
7770,24143
7800,24156
7810,24166
7820,24199
7830,24209
7840,24225
7842,24273
7850,24308
7860,24333
7861,24396
7870,24423
7880,24445
7881,24496
7890,24523
7900,24543
7901,24591
7910,24618
7920,24634
7921,24696
7930,24723
7940,24738
7941,24786
7950,24813
7951,24861
7960,24888
7970,24911
7971,24959
7980,24991
7990,25004
8000,25014
8010,25073
8020,25126
8030,25151
8040,25214
8050,25233
8060,25259
8070,25287
8080,25303
8090,25361
8100,25389
8110,25405
8120,25434
8130,25467
8180,25480
8190,25539
8200,25603
8201,25641
8202,25658
8210,25674
8220,25732
8230,25751
8235,25768
8240,25781
8250,25791
8260,25837
8270,25881
8280,25916
8290,25948
8300,25971
8310,25994
8320,26012
8330,26063
8340,26081
8350,26125
8351,26168
8352,26221
8360,26235
8370,26249
8380,26263
8390,26276
8400,26310
8405,26333
8410,26346
8415,26369
8420,26395
8430,26413
8431,26471
8440,26514
8450,26528
8460,26541
8470,26552
8480,26596
8490,26606
8500,26640
8510,26679
8520,26692
8530,26705
8540,26718
8550,26731
8560,26755
8570,26782
8580,26820
8590,26847
8600,26877
8610,26901
8620,26928
8630,26957
8640,26973
8650,27004
8652,27032
8660,27063
8670,27097
8680,27126
8690,27141
8700,27168
8705,27210
8706,27231
8707,27260
8710,27275
8720,27304
8730,27318
8740,27345
8750,27372
8760,27397
8770,27413
8780,27451
8785,27481
8786,27501
8790,27528
8800,27541
8810,27566
8820,27621
8830,27634
8840,27661
8850,27683
8855,27717
8860,27735
8870,27748
8880,27792
8890,27835
8900,27865
8910,27892
8920,27908
8930,27935
8940,27957
8945,27991
8950,28011
8960,28024
8970,28037
8980,28065
8990,28125
9000,28167
9010,28183
9020,28225
9030,28240
9040,28477
9041,28499
9042,28541
9043,28554
9044,28582
9050,28598
9051,28623
9060,28636
9070,28686
9080,28701
9090,28733
9100,28759
9110,28805
9120,28820
9130,28856
9140,28897
9150,28913
9160,28952
9170,28967
9171,29086
9180,29110
9191,29132
9192,29188
9193,29201
9194,29239
9200,29255
9210,29268
9220,29283
9230,29319
9240,29336
9250,29363
9260,29390
9270,29405
9280,29439
9290,29461
9300,29477
9310,29507
9320,29535
9330,29550
9340,29572
9341,29597
9390,29639
9400,29670
9410,29698
9420,29719
9430,29792
9440,29814
9450,29831
9460,29846
9470,29873
9480,29894
9490,29908
9500,29951
9510,29967
9540,29982
9550,30008
9560,30026
9561,30052
9562,30078
9570,30104
9580,30153
9590,30180
9600,30197
9610,30213
9620,30240
9630,30256
9640,30282
9650,30309
9660,30362
9670,30412
9680,30434
9685,30468
9690,30487
9700,30500
9710,30568
9720,30609
9730,30624
9740,30659
9750,30686
9760,30711
9762,30728
9770,30781
9780,30792
9790,30815
9791,30842
9800,30907
9810,30949
9820,31108
9830,31124
9840,31153
9850,31180
9860,31196
9870,31231
9875,31246
9877,31281
9880,31296
9890,31338
9900,31381
9901,31419
9910,31432
9911,31470
9920,31483
9930,31499
9940,31526
9945,31542
9950,31555
9961,-31597
9962,-31628
9963,-31656
9964,-31686
9965,-31710
9966,-31740
9967,-31771
9968,-31801
9969,-31834
9970,-31871
9971,-31902
9972,-31932
9973,-31958
9974,-31983
9975,-32008
9976,-32036
9977,-32055
9978,-32072
9979,-32096
9980,-32114
9981,-32132
9982,-32152
9983,-32177
9984,-32207
9985,-32225
9986,-32247
9987,-32265
9988,-32282
9989,-32309
9990,-32340
9991,-32360
9992,-32378
9993,-32397
9994,-32417
9995,-32436
9996,-32455
9997,-32473
9998,-32493
9999,-32512
10000,-32531
10001,-32551
10002,-32572
10003,-32591
10004,-32612
10005,-32630
10006,-32652
10007,-32671
12500,32696
12501,32732
12502,32787
12504,32805
12505,32859
12506,32904
12520,32977
12522,33013
12530,33035
12531,33082
12540,33116
12550,33146
12560,33190
12561,33226
12570,33268
12571,33305
12572,33332
12573,33374
12574,33473
12576,33506
12580,33524
12581,33558
12585,33601
12590,33620
12591,33638
12592,33677
12593,33704
12594,33737
12595,33751
12596,33776
12597,33793
12600,33833
12604,33851
12610,33897
12612,33923
12615,33942
12620,33973
12630,34009
12640,34023
12641,34044
12650,34063
12660,34094
12670,34147
12680,34180
-999,-999
10 REM ADVENTURE/3000 VERSION 3.2     27 FEB 1979 AT 5:30 PM
11 REM THIS PROGRAM IS RELATIVELY BUG-FREE, BUT ONE STILL MUST
12 REM realize that murphy 'S LAW STILL PREVAILS!
13 REM
14 REM ADVENTURE: PROGRAMMED IN HP/3000 BASIC BY BENJAMIN MOSER
15 REM JAMES MADISON HIGH SCHOOL, VIENNA, VIRGINIA.  THE BASIC LAYOUT OF THE
16 REM GAME WAS CONCEIVED BY DON WOODS & WILLIE CROWTHER, BOTH OF M.I.T.
17 REM
18 REM ADVENTURE WAS PORTED TO THE MACINTOSH PLUS BY THE ELIZABETH AND DAVID HUNTER
19 REM IN MARCH 1998 AND THEN TO PYBASIC FOR THE RASPBERRY RP2040 IN JUNE 2021
20 REM print "Adventure 3.2 on ";date$;" at ";time$
21 PRINT "Adventure 3.2"
22 OPEN "AMESSAGE" FOR INPUT AS # 3 : OPEN "AMOVING" FOR INPUT AS # 4
23 OPEN "ADESCRIP" FOR INPUT AS # 1 : OPEN "AITEMS" FOR INPUT AS # 2
24 OPEN "BITEMS" FOR INPUT AS # 10
44 REM dirs is an array of possible room directions, it replaces file AMOVING
45 DIM DIRS ( 100 , 10 )
46 DIM INDX ( 303 )
47 DIM FRAINDX ( 10 )
50 DIM S ( 99 )
51 DIM V ( 100 )
52 DIM K ( 2 )
53 DIM O ( 15 )
70 PRINT : PRINT "Initializing." ;
110 REM initialize
130 REM total rooms, items,and keywords
150 L1 = INT ( RND * 4 ) + 1 : L2 = L1
160 G = 0 : B0 = 1 : SN = 1 : D1 = 1 : D2 = 0 : T = 1 : B1 = 0 : B2 = 0 : P1 = 0 : DEAD = 0 : LASTC$ = ""
161 L = 0 : C = 0 : D3 = 0 : B3 = 0 : D0 = 2 : T1 = 100 : T2 = 35 : T3 = 149 : R0 = 0 : C0 = 0 : C$ = ""
162 KC = 1.03
170 FOR II = 1 TO 99
171 S ( II ) = 0 : V ( II ) = 0
172 NEXT II
175 PRINT "." ; : V ( 100 ) = 0
182 INDX ( 1 ) = - 1 : INDX ( 2 ) = - 1
190 REM read in possible movement direction array
192 FOR Z2 = 1 TO 100
193 INPUT # 4 , DX1 , DX2 , DX3 , DX4 , DX5 , DX6 , DX7 , DX8 , DX9 , DX0
194 DIRS ( Z2 , 1 ) = DX1 : DIRS ( Z2 , 2 ) = DX2 : DIRS ( Z2 , 3 ) = DX3 : DIRS ( Z2 , 4 ) = DX4 : DIRS ( Z2 , 5 ) = DX5
195 DIRS ( Z2 , 6 ) = DX6 : DIRS ( Z2 , 7 ) = DX7 : DIRS ( Z2 , 8 ) = DX8 : DIRS ( Z2 , 9 ) = DX9 : DIRS ( Z2 , 10 ) = DX0
196 PRINT "." ;
197 NEXT Z2
198 CLOSE # 4
200 RESTORE 230
210 REM read in locations of items
220 FOR Z2 = 1 TO T2 STEP 5
221 READ DX1 , DX2 , DX3 , DX4 , DX5 : S ( Z2 ) = DX1 : S ( Z2 + 1 ) = DX2 : S ( Z2 + 2 ) = DX3 : S ( Z2 + 3 ) = DX4 : S ( Z2 + 4 ) = DX5
222 PRINT "." ;
228 NEXT Z2
230 DATA 18 , 25 , 23 , 24 , 21
231 DATA 52 , 0 , 71 , 74 , 58
232 DATA 59 , 69 , 66 , 82 , 100
233 DATA 7 , 49 , 7 , 7 , 7
234 DATA 7 , 12 , 13 , 40 , 38
235 DATA 69 , 0 , 46 , 0 , 0
236 DATA 15 , 60 , 82 , 22 , 250
240 FOR II = 1 TO 15 STEP 5 
241 READ DX1 , DX2 , DX3 , DX4 , DX5 : O ( II ) = DX1 : O ( II + 1 ) = DX2 : O ( II + 2 ) = DX3 : O ( II + 3 ) = DX4 : O ( II + 4 ) = DX5
242 PRINT "." ;
243 NEXT II
245 DATA 1 , 2 , 2 , 2 , 2
246 DATA 3 , 4 , 3 , 3 , 2
247 DATA 5 , 3 , 2 , 3 , 3
260 REM ASK IF HE WANTS DIRECTIONS
263 Z5 = 301 : GOSUB 7620
264 GOSUB 9860
266 IF Z0 THEN 267 ELSE 320
267 Z5 = 302 : GOSUB 7620
280 REM command input routine
300 REM print room, items
310 REM If it's dark don't let him see anything
320 IF L1 < 13 OR L1 = 58 THEN 350
321 IF L = 1 AND ( S ( 18 ) = L1 OR S ( 18 ) = - 1 ) THEN 350
330 Z5 = 45 : GOSUB 7620
340 GOTO 400
350 ON D0 + 1 GOSUB 6780 , 7990 , 8180
360 IF V ( L1 ) <> 0 THEN 370
365 V ( L1 ) = 1
370 GOSUB 6680
375 IF DEAD = 1 THEN 9540
380 GOSUB 7800
390 REM INPUT LOOP --- MULTIPLE COMMAANDS, REMOVE JUNK CHARACTERS
400 IF LEN ( C$ ) > 0 THEN 500
410 INPUT ">" , C$
420 IF C$ = "" THEN 410
425 PRINT : PRINT : NKEY = 0
431 IF C$ <> LASTC$ THEN 433
432 C$ = "" : GOTO 900
433 NUMKEYS = 1 : LASTC$ = C$
434 IF INSTR ( C$ , " " ) = 0 THEN 440
435 NUMKEYS = 2
440 C$ = UPPER$ ( C$ )
449 REM 65-90 = A-Z               48-57 = 0-9         46 = .    
450 FOR X = 1 TO LEN ( C$ )
460 Z5 = ASC ( MID$ ( C$ , X , 1 ) )
470 IF ( Z5 > 64 AND Z5 < 91 ) OR ( Z5 > 47 AND Z5 < 58 ) OR Z5 = 46 THEN 480 ELSE 471
471 C$ = MID$ ( C$ , 1 , X - 1 ) + " " + MID$ ( C$ , X + 1 )
480 NEXT X
560 REM search a$ for keywords,put kwd code into k(x)
565 A$ = " " + C$ + " " : C$ = ""
780 FSEEK # 10 , 0
800 K ( 1 ) = 0 : K ( 2 ) = 0 : Z3 = 0
810 REM T3=TOTAL NUMBER OF KEYWORDS
820 INPUT # 10 , Z1 , B$
830 IF Z1 > T3 OR NKEY = NUMKEYS THEN 900
850 IF INSTR ( A$ , B$ ) > 0 THEN 861 ELSE 820
860 REM IF KEYWORD WAS FOUND, NOTE THIS IN K(Z1)
861 NKEY = NKEY + 1 : K ( NKEY ) = Z1 : GOTO 820
890 REM EXOTIC WORDS
900 Z0 = 36
910 IF K ( 1 ) >= Z0 AND K ( 1 ) <= 46 THEN 930
920 IF K ( 2 ) >= Z0 AND K ( 2 ) <= 46 THEN 930 ELSE 980
930 GOSUB 8390
940 PRINT "What do you want to do with the " ; D$ ; "?"
950 GOTO 410
980 IF K ( 1 ) >= 110 AND K ( 1 ) <= T3 THEN 1950
990 IF K ( 2 ) >= 110 AND K ( 2 ) <= T3 THEN 1950
1000 REM THEN IS IT A DIRECTION
1010 FOR D = 1 TO 10
1020 IF K ( 1 ) = D + 99 OR K ( 2 ) = D + 99 THEN 1070
1030 NEXT D
1040 REM COMMAND NOT A DIRECTION
1050 GOTO 1950
1060 REM CAN HE MOVE THAT WAY?
1070 Z2 = DIRS ( L1 , D )
1130 IF Z2 = 255 THEN 1240
1140 IF Z2 < 1 OR Z2 > 254 THEN 1220
1150 REM NORMAL MOVING
1160 REM CHECK FOR SPECIAL MOVE CONDITIONS
1170 GOTO 1240
1180 L2 = L1 : L1 = Z2
1190 IF S ( 35 ) = L2 THEN 1191 ELSE 1200
1191 S ( 35 ) = L1
1200 GOTO 9780
1210 GOTO 300
1220 Z5 = 1
1221 GOSUB 7620
1230 GOTO 400
1240 REM SPECIAL ROOM DIRECTIONS
1250 REM GRATE
1260 IF L1 = 10 AND ( D = 10 OR D = 5 ) THEN 1270
1261 IF L1 = 11 AND ( D = 9 OR D = 3 ) THEN 1270 ELSE 1310
1270 REM IF GRATE IS OPEN (G=0) MOVE HIM
1280 IF G = 1 THEN 1180
1290 Z5 = 10 : GOSUB 7620
1300 GOTO 400
1310 REM CAN'T TAKE NUGGET UPPSTAIRS
1320 IF NOT ( L1 = 17 AND D = 9 AND S ( 1 ) = - 1 ) THEN 1350
1330 Z5 = 38 : GOSUB 7620
1340 GOTO 400
1350 REM CRYSTAL BRIDGE AND FISSURE
1360 IF NOT ( L1 = 19 AND D = 7 OR L1 = 20 AND D = 3 ) THEN 1400
1370 IF B2 THEN 1180
1380 Z5 = 3 : GOSUB 7620
1390 GOTO 400
1400 REM MT. KING & SNAKE
1410 IF NOT ( L1 = 22 AND D <> 3 AND D <> 9 ) THEN 1460
1420 IF SN = 0 THEN 1180
1430 Z5 = 50 : GOSUB 7620
1440 GOTO 400
1460 REM bedquilt and random directiosn
1470 IF NOT ( L1 = 44 AND D <> 3 AND D <> 7 ) THEN 1580
1480 IF RND > 0.5 THEN 1510
1490 Z5 = 52 : GOSUB 7620
1500 GOTO 400
1510 RESTORE 1530
1520 REM ROOMS TO JU
1530 DATA 33 , 37 , 45 , 92 , 76
1540 FOR Z3 = 1 TO INT ( RND * 5 ) + 1
1550 READ Z2
1560 NEXT Z3
1570 GOTO 1180
1580 REM WITT's END
1590 IF L1 <> 39 THEN 1680
1600 REM SHOULD WE LET HIM OUT?
1610 IF RND < 0.15 THEN 1650
1620 REM NO
1630 Z5 = 52 : GOSUB 7620
1640 GOTO 400
1650 REM YES
1660 Z2 = 38
1670 GOTO 1180
1680 REM Narrow Tunnel
1690 IF NOT ( L1 = 57 OR L1 = 58 ) THEN 1770
1691 IF K ( 1 ) <> 102 AND K ( 2 ) <> 102 AND K ( 1 ) <> 106 AND K ( 2 ) <> 106 THEN 1770
1700 FOR Z3 = 1 TO T2
1710 IF Z3 = 10 THEN 1750
1720 IF S ( Z3 ) <> - 1 THEN 1750
1730 Z5 = 53 : GOSUB 7620
1740 GOTO 400
1750 NEXT Z3
1760 GOTO 1180
1770 REM TROLL
1780 IF L1 = 60 AND D = 2 THEN 1790
1781 IF L1 = 61 AND D = 6 THEN 1790 ELSE 1860
1790 ON T + 1 GOTO 1180 , 1800 , 1820 , 1840
1800 Z5 = 55 : GOSUB 7620
1810 GOTO 400
1820 Z5 = 56 : GOSUB 7620
1821 Z5 = 55 : GOSUB 7620
1830 T = 1 : GOTO 400
1840 T = 2
1850 GOTO 1180
1860 IF NOT ( L1 = 73 AND D = 1 AND D2 = 0 ) THEN 1890
1870 Z5 = 57 : GOSUB 7620
1880 GOTO 400
1890 IF NOT ( L1 = 82 AND S ( 33 ) = L1 AND D = 1 ) THEN 1930
1900 REM DRAGON
1910 Z5 = 51 : GOSUB 7620
1920 GOTO 400
1930 GOTO 1180
1940 REM OTHER COMMANDS
1950 Z1 = K ( 1 ) : IF K ( 1 ) >= 110 AND K ( 1 ) <= T3 THEN 2090
1960 Z1 = K ( 2 ) : IF K ( 2 ) >= 110 AND K ( 2 ) <= T3 THEN 2090
1980 REM ITEM BO NO VERB?
1990 IF K ( 1 ) >= 1 AND K ( 1 ) <= 35 THEN 2000
1991 IF K ( 2 ) >= 1 AND K ( 2 ) <= 35 THEN 2000 ELSE 2040
2000 REM restore 9960
2001 FOR X = 1 TO 35
2010 REM read d$
2020 IF K ( 1 ) <> X AND K ( 2 ) <> X THEN 2030
2021 RESTORE 9960 + X
2022 READ D$
2023 GOTO 940
2030 NEXT X
2040 RESTORE 2070
2050 FOR X = 1 TO INT ( RND * 4 ) + 1
2051 READ B$
2052 NEXT X
2060 PRINT B$
2070 DATA "What?" , "I don't understand." , "I can't understand that." , "I don't know that word."
2080 GOTO 400
2090 Z1 = Z1 - 109
2095 ON Z1 GOTO 2120 , 2220 , 2300 , 2390 , 2570 , 2640 , 2680 , 2860 , 2930 , 3000 , 3080 , 3130 , 3290 , 3450 , 3590 , 3920 , 4160 , 4430 , 4630 , 4800 , 4950 , 5060 , 5190 , 5410 , 5560 , 5750 , 5810 , 5920 , 6000 , 6090 , 6230 , 6270 , 6310 , 6350 , 6410 , 8970 , 9080 , 9220 , 4490 , 9330
2110 GOTO 2040
2120 REM *** PLUGH ***
2130 IF L1 <> 7 THEN 2170
2140 IF S ( 35 ) = L1 THEN S ( 35 ) = 0
2150 Z2 = 26
2160 GOTO 1180
2170 IF L1 <> 26 THEN 2200
2180 Z2 = 7
2190 GOTO 1180
2200 Z5 = 2 : GOSUB 7620
2210 GOTO 400
2220 REM *** XYZZY ***
2230 IF L1 <> 7 THEN 2270
2240 IF S ( 35 ) = L1 THEN S ( 35 ) = 0
2250 Z2 = 13
2260 GOTO 1180
2270 IF L1 <> 13 THEN 2200
2280 Z2 = 7
2290 GOTO 1180
2300 REM *** PLOVER *** (CAN'T BRING EMERALD WITH HIM)
2310 IF L1 > 26 THEN 2360
2320 IF S ( 35 ) <> L1 THEN 2330
2325 S ( 35 ) = 0
2330 IF S ( 10 ) <> - 1 THEN 2340
2335 S ( 10 ) = L1
2340 Z2 = 58
2350 GOTO 1180
2360 IF L1 <> 58 THEN 2200
2370 Z2 = 26
2380 GOTO 1180
2390 REM *** CROSS ***
2400 IF L1 <> 19 THEN 2470
2410 IF B2 <> 0 THEN 2440
2420 Z5 = 3 : GOSUB 7620
2430 GOTO 400
2440 D = 7
2450 REM JUST GIVE NEW DIRECTION, USE MOVE ROUTINE
2460 GOTO 1070
2470 IF L1 <> 20 THEN 2510
2480 IF B2 = 0 THEN 2420
2490 D = 3
2500 GOTO 1070
2510 IF L1 <> 60 THEN 2540
2520 D = 2
2530 GOTO 1070
2540 IF L1 <> 61 THEN 2200
2550 D = 6
2560 GOTO 1070
2570 REM *** CLIMB ***
2580 IF L1 <> 50 THEN 2200
2590 REM CAN HE CLIMB BEANSTALK?
2600 IF P1 < 2 THEN 2200
2610 REM YES
2620 Z2 = 70
2630 GOTO 1180
2640 REM *** JUMP *** STRICTLY SUICIDAL
2650 IF L1 <> 16 AND L1 <> 19 AND L1 <> 20 AND L1 <> 27 THEN 2200
2660 Z5 = 4 : GOSUB 7620
2670 GOTO 9550
2680 REM FILL
2690 IF S ( 21 ) = - 1 THEN 2730
2700 B$ = "bottle"
2710 PRINT "You don't have the " ; B$
2720 GOTO 410
2730 IF B0 = 0 THEN 2760
2740 Z5 = 5 : GOSUB 7620
2750 GOTO 410
2760 IF L1 <> 7 AND L1 <> 8 AND L1 <> 9 AND L1 <> 35 AND L1 <> 74 AND L1 <> 81 THEN 2790
2770 B0 = 1 : S ( 16 ) = - 1
2780 GOTO 2840
2790 IF L1 = 49 THEN 2830
2800 B$ = "oil"
2810 PRINT "I see no " ; B$ ; " here."
2820 GOTO 400
2830 B0 = 2 : S ( 17 ) = - 1
2840 PRINT "The bottle is now filled."
2850 GOTO 400
2860 REM *** EMPTY ***
2870 IF S ( 21 ) = - 1 THEN 2890
2880 GOTO 2700
2890 REM EMPTY BOTTLE (ASSUMED FULL)
2900 S ( B0 + 15 ) = 0 : B0 = 0
2910 PRINT "Emptied"
2920 GOTO 400
2930 REM *** LOOK ***
2940 IF L1 < 13 OR L1 = 58 THEN 2970
2941 IF L = 1 AND ( S ( 18 ) = L1 OR S ( 18 ) = - 1 ) THEN 2970
2950 Z5 = 45 : GOSUB 7620
2960 GOTO 400
2970 GOSUB 8050
2980 GOSUB 6680
2990 GOTO 400
3000 REM *** LIGHT ***
3010 IF S ( 18 ) = - 1 THEN 3040
3020 B$ = "lamp"
3030 GOTO 2710
3040 L = 1
3050 B$ = "on"
3060 PRINT "The lamp is now " ; B$
3070 GOTO 2940
3080 REM *** OFF (EXTINGUSIH) ***
3090 IF S ( 18 ) = - 1 THEN 3110
3100 GOTO 3020
3110 L = 0 : B$ = "off"
3120 GOTO 3060
3130 REM *** ENTER ***
3140 IF L1 <> 6 THEN 3180
3150 REM TO HOUSE
3160 D = 3
3170 GOTO 1070
3180 IF L1 <> 68 THEN 3240
3190 REM TO BARREN ROOM
3200 D = 3
3210 GOTO 1070
3240 FOR Z0 = 1 TO 10
3250 Z2 = DIRS ( L1 , Z0 )
3260 IF Z2 > 0 AND Z2 < 101 THEN 1150
3270 NEXT Z0
3280 GOTO 2200
3290 REM ** LEAVE ***
3300 IF L1 <> 7 THEN 3340
3310 REM LEAVE HOUSE
3320 D = 7
3330 GOTO 1070
3340 IF L1 <> 69 THEN 3400
3350 REM LEAVE BARREN ROOM
3360 D = 7
3370 GOTO 1070
3400 FOR Z0 = 1 TO 10
3410 Z2 = DIRS ( L1 , Z0 )
3420 IF Z2 > 0 AND Z2 < 101 THEN 1150
3430 NEXT Z0
3440 GOTO 2200
3450 REM *** INVENTORY ***
3460 REM RESTORE 9960
3470 Z0 = 0
3480 PRINT "You are carrying:" ;
3490 FOR X = 1 TO T2
3500 REM READ B$
3510 IF S ( X ) <> - 1 THEN 3540
3511 RESTORE 9960 + X : READ B$
3520 PRINT B$
3530 Z0 = Z0 + 1
3540 NEXT X
3550 IF Z0 = 0 THEN 3551 ELSE 3560
3551 PRINT "nothing."
3560 PRINT
3570 GOTO 400
3590 REM *** GET ***
3630 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 3680
3640 GOSUB 8280
3650 IF Z8 > 0 THEN 3680
3660 PRINT "Get what?"
3670 GOTO 2040
3680 REM restore 9960
3690 FOR Z3 = 1 TO T2
3700 REM read a$
3710 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 3730
3720 IF K ( 1 ) <> Z3 AND K ( 2 ) <> Z3 THEN 3900
3730 IF S ( Z3 ) <> L1 THEN 3750
3740 IF S ( Z3 ) = L1 THEN 3790
3750 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 3900
3760 RESTORE 9960 + Z3 : READ A$ : PRINT A$ ; " not here."
3770 GOTO 3900
3780 REM MUST CHECK NOW FOR LEGALITY OF TAKING ITEM
3790 Z8 = 0
3800 FOR X = 1 TO T2
3810 IF S ( X ) <> - 1 THEN 3820
3811 Z8 = Z8 + 1
3820 NEXT X
3830 IF Z8 < 7 THEN 3870
3840 REM CARRYING TOO MUCH
3850 Z5 = 54 : GOSUB 7620
3860 GOTO 410
3870 GOTO 6880
3880 S ( Z3 ) = - 1
3890 RESTORE 9960 + Z3 : READ A$ : PRINT A$ ; ":taken."
3900 NEXT Z3
3910 GOTO 400
3920 REM *** DROP ***
3940 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 4000
3950 GOSUB 8280
3960 IF Z8 > 0 THEN 4000
3970 PRINT "Drop what?"
3980 GOTO 2040
4000 REM RESTORE 9960
4010 FOR Z3 = 1 TO T2
4020 REM READ B$
4030 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 4060
4040 IF K ( 1 ) <> Z3 AND K ( 2 ) <> Z3 THEN 4140
4050 IF S ( Z3 ) = 0 THEN 4140
4060 IF S ( Z3 ) = - 1 THEN 4100
4070 IF K ( 1 ) = 47 OR K ( 2 ) = 47 THEN 4140
4080 RESTORE 9960 + Z3 : READ B$ : PRINT "You don't have the " ; B$
4090 GOTO 4140
4100 REM STILL NEED TO ELABORATE ON DROP (BIRD IN CAGE, BOTTLE)
4110 GOTO 7380
4120 RESTORE 9960 + Z3 : READ B$ : PRINT B$ ; ":dropped."
4130 S ( Z3 ) = L1
4140 NEXT Z3
4150 GOTO 400
4160 REM *** THROW ***
4170 GOSUB 8280
4180 IF Z8 > 0 THEN 4210
4190 PRINT "Throw what?"
4200 GOTO 2040
4210 IF S ( Z3 ) <> - 1 THEN 2710
4220 IF NOT ( Z3 < 16 AND S ( 32 ) = L1 ) THEN 4260
4230 REM THROW TREASURE TO TROLL
4240 Z5 = 27 : GOSUB 7620
4241 S ( Z3 ) = 0 : T = 3 : GOTO 400
4260 IF NOT ( Z3 = 27 AND S ( 32 ) = L1 ) THEN 4300
4270 REM TRYING TO BUTCHER TROLL?
4280 Z5 = 26 : GOSUB 7620
4281 S ( 27 ) = L1 : GOTO 400
4300 IF NOT ( Z3 = 27 AND S ( 35 ) = L1 ) THEN 4380
4310 REM TRYING TO KILL DWARF
4320 IF RND > 0.5 THEN 4360
4330 Z5 = 29 : GOSUB 7620
4340 GOSUB 8650
4350 GOTO 4410
4360 Z5 = 30 : GOSUB 7620
4361 S ( 35 ) = 0 : GOTO 4410
4380 REM NOTHING SPECIAL, JUST DROP ITEM
4390 IF S ( 35 ) <> L1 THEN 4400
4391 GOSUB 8550
4400 PRINT "Thrown."
4410 S ( Z3 ) = L1
4415 IF DEAD = 1 THEN 9540
4420 GOTO 400
4430 REM *** ATTACK ***
4440 GOSUB 8280
4450 IF NOT ( Z3 = 33 AND S ( Z3 ) = L1 AND L1 = 82 ) THEN 4520
4460 REM HE CAN KILL DRAGON
4470 Z5 = 68 : GOSUB 7620
4480 GOTO 410
4490 IF L1 <> 82 THEN 2040
4500 Z5 = 69 : GOSUB 7620
4501 S ( 33 ) = 0 : D1 = 0 : GOTO 400
4520 IF S ( 32 ) <> L1 THEN 4560
4530 REM TRYING TO MUNGE TROLL
4540 Z9 = FNA ( 25 ) : GOTO 400
4560 IF NOT ( Z3 = 26 OR Z3 > 30 ) THEN 4600
4570 REM DANGEROUS TO ATTACK THESE
4580 Z5 = 70 : GOSUB 7620
4590 GOTO 400
4600 REM NOTHING TO ATTACK
4610 Z5 = 71 : GOSUB 7620
4620 GOTO 400
4630 REM *** FEED ***
4640 GOSUB 8280
4650 IF Z3 <> 35 THEN 4690
4660 REM CAN'T FEED DWARF!
4670 Z5 = 24 : GOSUB 7620
4680 GOTO 400
4690 IF S ( 20 ) = - 1 THEN 4720
4700 B$ = "FOOD" : GOTO 2710
4720 IF L1 = 69 THEN 4760
4730 PRINT "I can't feed it."
4740 Z5 = 23 : GOSUB 7620
4750 GOTO 400
4760 IF S ( 20 ) = L1 THEN 7600
4770 B1 = 1 : S ( 20 ) = 0 : Z5 = 6 : GOSUB 7620
4790 GOTO 400
4800 REM *** WATER ***
4810 IF S ( 16 ) = - 1 THEN 4840
4820 B$ = "water" : GOTO 2710
4840 IF L1 <> 50 THEN 2200
4850 REM GOTO P1+1 OF 4860,4890,4920
4851 IF P1 = 0 THEN 4860
4852 IF P1 = 1 THEN 4890
4853 IF P1 = 2 THEN 4920
4860 Z5 = 7 : GOSUB 7620
4870 P1 = 1 : S ( 16 ) = 0 : B0 = 0 : GOTO 400
4890 Z5 = 8 : GOSUB 7620
4900 P1 = 2 : S ( 16 ) = 0 : B0 = 0 : GOTO 400
4920 Z5 = 9 : GOSUB 7620
4930 P1 = 0 : S ( 16 ) = 0 : B0 = 0 : GOTO 400
4950 REM *** LOCK ***
4960 IF L1 = 10 OR L1 = 11 THEN 4990
4970 REM NOTHING LOCKABLE
4980 GOTO 2200
4990 IF S ( 19 ) = - 1 THEN 5020
5000 B$ = "keys" : GOTO 2710
5020 G = 0 : Z5 = 10 : GOSUB 7620
5040 GOTO 400
5045 REM *** line 5050 no reachable, try and figure out what was meant
5050 S ( Z3 ) = L1
5060 REM *** UNLOCK ***
5070 IF S ( 19 ) <> - 1 THEN 5000
5080 IF L1 <> 10 AND L1 <> 11 THEN 5120
5090 G = 1 : Z5 = 11 : GOSUB 7620
5110 GOTO 400
5120 IF L1 <> 69 THEN 2200
5130 IF B1 > 0 THEN 5160
5140 Z5 = 12 : GOSUB 7620
5150 GOTO 400
5160 IF C <> 0 THEN 5170
5165 C = 1 : B1 = 2
5170 Z5 = 13 : GOSUB 7620
5180 GOTO 400
5190 REM *** FREE ***
5200 IF K ( 1 ) = 31 OR K ( 2 ) = 31 THEN 5240
5210 REM CAN'T FREE ANYTHING BUT BIRD
5220 Z5 = 2 : GOSUB 7620
5230 GOTO 410
5240 IF S ( 31 ) <> - 1 THEN 5220
5250 S ( 31 ) = L1 : B3 = 0
5260 PRINT "Freed."
5270 IF L1 <> 22 THEN 5350
5280 IF SN <> 1 THEN 400
5290 B$ = "snake"
5300 PRINT "The little bird attacks the green " ; B$ ; " and"
5310 IF L1 = 82 THEN 5380
5320 PRINT "drives it off"
5330 SN = 0 : S ( 34 ) = 0 : GOTO 400
5350 IF L1 <> 82 THEN 400
5360 B$ = "dragon" : GOTO 5300
5380 PRINT "gets burned to a crisp"
5381 S ( 20 ) = 0 : B0 = 0 : GOTO 400
5390 S ( 31 ) = 0
5400 GOTO 400
5410 REM *** WAVE ***
5420 IF K ( 1 ) <> 23 AND K ( 2 ) <> 23 THEN 2200
5430 IF S ( 23 ) = - 1 THEN 5460
5440 B$ = "rod" : GOTO 2710
5460 REM IS HERE NEAR FISSURE
5470 IF L1 <> 19 AND L1 <> 20 THEN 2200
5480 REM yes
5490 REM GOTO B2+1 OF 5500,5530
5491 IF B2 = 0 THEN 5500
5492 IF B2 = 1 THEN 5530
5500 Z5 = 14 : GOSUB 7620
5510 B2 = 1 : GOTO 400
5530 Z5 = 15 : GOSUB 7620
5540 B2 = 0 : GOTO 400
5560 REM *** OPEN ***
5570 GOSUB 8280
5580 IF Z3 > 0 THEN 5610
5590 PRINT "Open " ; : GOTO 2040
5610 IF Z3 = 40 THEN 5070
5620 IF S ( Z3 ) = L1 THEN 5650
5630 PRINT "I see no " ; B$ ; " here." : GOTO 400
5650 IF Z3 = 24 THEN 5680
5660 PRINT "I don't know how to open a " ; B$ : GOTO 400
5680 IF S ( 9 ) = - 1 THEN 5710
5690 Z5 = 16 : GOSUB 7620
5700 GOTO 400
5710 IF S ( Z3 ) = 0 THEN 2200
5720 REM HE'S OPENED CLAM, SO PRINT DESCRIPTION OF THIS
5730 REM PUT PEARL IN CUL-DE-SAC
5740 S ( 7 ) = 43 : S ( 24 ) = 0 : S ( 30 ) = L1 : Z5 = 17 : GOSUB 7620
5750 GOTO 400
5760 REM *** CLOSE ***
5770 GOSUB 8280
5780 IF Z3 = 40 THEN 4960
5790 Z5 = 18 : GOSUB 7620
5800 GOTO 400
5810 REM OIL
5820 IF K ( 1 ) <> 17 AND K ( 2 ) <> 17 THEN 2200
5830 IF S ( 17 ) = - 1 THEN 5860
5840 B$ = "oil" : GOTO 5630
5860 IF L1 <> 73 THEN 2200
5870 REM IS DOOR STILL RUSTED
5880 IF D2 = 1 THEN 2200
5890 D2 = 1 : S ( 17 ) = 0 : B0 = 0 : Z5 = 19 : GOSUB 7620
5900 GOTO 400
5910 REM *** EAT ***
5920 IF K ( 1 ) = 20 OR K ( 2 ) = 20 THEN 5950
5930 Z5 = 20 : GOSUB 7620
5940 GOTO 410
5950 Z3 = 20 : GOSUB 8490
5970 IF Z5 = 0 THEN 410
5980 Z5 = 73 : GOSUB 7620
6000 REM *** DRINK ***
6010 IF K ( 1 ) = 16 OR K ( 2 ) = 16 THEN 6040
6020 Z5 = 21 : GOSUB 7620
6030 GOTO 410
6040 Z3 = 16 : GOSUB 8490
6060 IF Z5 = 0 THEN 410
6070 Z5 = 22 : GOSUB 7620
6071 S ( 17 ) = 0 : B0 = 0 : GOTO 400
6090 REM *** FEE FIE FOE FOO ***
6100 IF L1 = 71 THEN 6130
6110 Z5 = 2 : GOSUB 7620
6120 GOTO 410
6130 IF S ( 8 ) <> L1 THEN 6180
6140 REM MAKE NEST VANISH
6150 Z5 = 79 : GOSUB 7620
6160 S ( 8 ) = 0 : GOTO 400
6180 REM IF S(8)=0 THEN 6110
6190 S ( 8 ) = L1
6200 REM MAKE NEST RE-APPEAR
6210 Z5 = 81 : GOSUB 7620
6220 GOTO 400
6230 REM *** SHORT ***
6240 PRINT "Short descriptions"
6250 D0 = 0 : GOTO 400
6270 REM *** LONG ***
6280 PRINT "Long descriptions"
6290 D0 = 1 : GOTO 400
6310 REM *** BRIEF ***
6320 PRINT "OK, I'll only describe the room in detail the first time."
6330 D0 = 2 : GOTO 400
6350 REM *** QUIT ***
6360 PRINT "Save game" ;
6370 GOSUB 9860
6380 IF Z0 = 1 THEN 8970
6390 GOTO 9750
6400 REM SCORE ***
6410 GOSUB 6430
6420 GOTO 400
6430 REM PRINT OUT SCORE DATA
6440 GOSUB 6510
6450 PRINT "Your score is now " ; S0
6451 PRINT "You have explored " , ( Z9 / T1 ) * T1 , "% of the cave."
6460 RESTORE 6470
6470 DATA "beginner" , "novice" , "experienced" , "advanced" , "expert"
6480 Z9 = INT ( ( S0 - 1 ) / 100 )
6481 IF Z9 <= 4 THEN 6483
6482 Z9 = 4
6483 FOR Z0 = 0 TO Z9
6484 READ D$
6485 NEXT Z0
6490 PRINT "That makes you a " ; D$ ; " adventurer."
6500 RETURN
6510 REM COMPUTE CURRENT SCORE
6520 RESTORE 230
6530 Z9 = 0 : S0 = 0
6540 FOR Z0 = 1 TO 15
6550 READ Z1
6560 IF Z1 = 0 THEN 6590
6570 IF V ( Z1 ) <> 1 THEN 6580
6575 S0 = S0 + 4 * O ( Z0 )
6580 IF S ( Z0 ) <> 7 THEN 6590
6585 S0 = S0 + 4 * O ( Z0 )
6590 NEXT Z0
6600 S0 = ( G = 1 ) * 10 + S0 : S0 = ( SN = 0 ) * 20 + S0 : S0 = ( D1 = 0 ) * 30 + S0 : S0 = ( T = 0 ) * 30 + S0 : S0 = ( B1 = 2 ) * 20 + S0
6605 S0 = ( B2 = 1 ) * 20 + S0 : S0 = ( P1 = 2 ) * 20 + S0 : S0 = ( D2 = 1 ) * 20 + S0 : S0 = ( C = 1 ) * 20 + S0
6610 FOR Z0 = 1 TO T1
6620 IF V ( Z0 ) <> 1 THEN 6630
6621 S0 = S0 + 1 : Z9 = Z9 + 1
6630 NEXT Z0
6640 RETURN
6660 REM list items at location l1
6680 FSEEK # 2 , 0
6690 FOR Z1 = 1 TO T2
6700 INPUT # 2 , A$
6710 IF S ( Z1 ) <> L1 THEN 6720
6711 PRINT A$
6720 NEXT Z1
6721 IF S ( 26 ) <> - 1 THEN 6730
6722 Z5 = 67 : GOSUB 7620
6730 REM CHECK FOR DWARF,PIRATE
6740 GOSUB 8560
6745 IF DEAD = 1 THEN 9540
6750 GOSUB 8800
6760 PRINT
6770 RETURN
6775 REM Print Short room description
6780 FSEEK # 1 , 0
6820 FOR Z1 = 1 TO L1
6830 INPUT # 1 , A$
6840 NEXT Z1
6850 V ( L1 ) = 1
6860 PRINT A$
6870 RETURN
6880 REM SPECIAL GETS
6890 IF NOT ( Z3 = 24 OR Z3 = 30 OR Z3 > 31 ) THEN 6930
6900 REM CAN'T GET THESE FOR SOME REASON
6910 Z5 = 61 : GOSUB 7620
6920 GOTO 400
6930 IF NOT ( Z3 = 12 AND C = 0 ) THEN 6970
6940 REM CHAIN
6950 Z5 = 58 : GOSUB 7620
6960 GOTO 3900
6970 REM BEAR IS HE FED? UNLOCKED?
6980 IF NOT ( Z3 = 26 AND B1 <> 2 ) THEN 7010
6990 Z5 = 61 : GOSUB 7620
7000 GOTO 3900
7010 IF NOT ( Z3 = 14 AND D1 = 1 ) THEN 7050
7020 REM DRAGON AND RUG
7030 Z5 = 59 : GOSUB 7620
7040 GOTO 3900
7050 IF NOT ( Z3 = 16 OR Z3 = 17 ) THEN 7090
7060 REM OIL AND WATER DO SAME AS FILL
7070 PRINT "Why not say 'fill'?"
7080 GOTO 3900
7090 IF NOT ( Z3 = 22 AND B3 ) THEN 7140
7100 REM TAKE BIRD SINCE IT'S IN CAGE
7110 S ( 31 ) = - 1 : PRINT "Bird and " ; : GOTO 3880
7140 IF Z3 <> 31 THEN 7310
7150 REM GETTING BIRD
7160 IF B3 <> 1 THEN 7210
7170 REM TAKE CAGE, SINCE BIRD IS IN IT
7180 PRINT "Cage and " ; : S ( 22 ) = - 1 : GOTO 3880
7210 IF S ( 22 ) = - 1 THEN 7240
7220 B$ = "cage" : GOTO 2810
7240 IF S ( 23 ) = - 1 THEN 7280
7250 REM OK TO TAKE BIRD
7260 S ( 31 ) = - 1 : B3 = 1 : GOTO 3890
7280 REM ROD SCARES BIRD
7290 Z5 = 37 : GOSUB 7620
7300 GOTO 3900
7310 REM BOTTLE FULL? IF SO, GET CONTENTS
7320 IF NOT ( Z3 = 21 AND B0 ) THEN 7360
7330 PRINT "Contents and the " ;
7340 S ( B0 + 15 ) = - 1
7360 GOTO 3880
7370 REM SPECIAL "DROP"
7380 IF Z3 <> 31 THEN 7440
7390 REM BIRD IN CAGE
7400 S ( 31 ) = L1 : S ( 22 ) = L1 : B3 = 1
7410 IF Z3 <> 31 THEN 7420
7415 PRINT "Cage and " ;
7420 IF Z3 = 22 THEN 7430
7425 PRINT "Bird and " ;
7430 GOTO 4120
7440 IF Z3 = 22 AND B3 = 1 THEN 7400
7450 IF Z3 <> 21 THEN 7520
7460 REM BOTTLE
7470 IF B0 = 0 THEN 4120
7480 REM BOTTLE IS FULL, DO DROP CONTENTS TOO
7490 PRINT "Contents and " ;
7500 S ( 15 + B0 ) = L1 : GOTO 4120
7520 IF NOT ( Z3 = 16 OR Z3 = 17 ) THEN 7541
7530 PRINT "Try saying 'empty'" : GOTO 4140
7541 IF Z3 <> 26 OR T <> 1 OR ( L1 <> 60 AND L1 <> 61 ) THEN 7550
7542 Z5 = 28 : GOSUB 7620
7543 T = 0 : S ( 26 ) = L1 : S ( 32 ) = 0 : GOTO 400
7550 IF Z3 <> 6 THEN 4120
7560 IF S ( 28 ) = L1 THEN 7600
7570 REM GOODBYE, FRAGILE VASE!
7580 Z5 = 43 : GOSUB 7620
7581 S ( 6 ) = 0 : S ( 29 ) = L1 : GOTO 400
7600 Z5 = 60 : GOSUB 7620
7610 GOTO 4120
7619 REM PRINT MESSAGE
7620 IF INDX ( 1 ) >= 0 THEN 7640
7630 GOSUB 12500
7640 Z5 = INT ( Z5 ) : XTMP = INDX ( Z5 )
7645 IF Z5 <> 2 AND Z5 <> 61 THEN 7660
7650 XTMP = FRAINDX ( XTMP + MIN ( INT ( RND * 5 ) , 5 ) )
7660 FSEEK # 3 , XTMP
7670 INPUT # 3 , B1$
7672 IF LEN ( B1$ ) = 0 THEN 7673 ELSE 7680
7673 B1$ = " "
7680 REM if eof(3) then 7760
7690 IF INSTR ( B1$ , "#" ) = 0 THEN 7670
7700 Z4 = VAL ( MID$ ( B1$ , 2 ) )
7705 IF INT ( Z4 ) = Z5 THEN 7720
7710 IF INT ( Z4 ) < Z5 THEN 7670
7712 IF INT ( Z4 ) > Z5 THEN 7760
7720 INPUT # 3 , B1$
7730 IF MID$ ( B1$ , 1 , 1 ) = "#" THEN 7770
7740 PRINT B1$
7750 GOTO 7720
7760 PRINT "NO DESC. # " ; Z5 ; " IN FILE AMESSAGE"
7770 RETURN
7800 REM
7810 REM SITUATION DESCRIPTIONS
7820 REM
7830 REM GRATE
7840 IF L1 = 10 OR L1 = 11 THEN 7842 ELSE 7850
7842 Z5 = ( G + 10 ) : GOSUB 7620
7850 REM CRYSTAL BRIDGE
7860 IF ( L1 = 19 OR L1 = 20 ) AND B2 = 1 THEN 7861 ELSE 7870
7861 Z5 = 14 : GOSUB 7620
7870 REM PLUGH NOISE
7880 IF L1 = 26 AND RND > 0.3 THEN 7881 ELSE 7890
7881 Z5 = 41 : GOSUB 7620
7890 REM IRON DOOR
7900 IF L1 = 73 AND D2 = 0 THEN 7901 ELSE 7910
7901 Z5 = 57 : GOSUB 7620
7910 REM TROLL
7920 IF ( L1 = 60 OR L1 = 61 ) AND T = 1 THEN 7921 ELSE 7930
7921 Z5 = 63 : GOSUB 7620
7930 REM BEAR
7940 IF L1 = 69 AND B1 = 0 THEN 7941 ELSE 7950
7941 Z5 = 64 : GOSUB 7620
7950 IF L1 = 69 AND B1 = 1 THEN 7951 ELSE 7960
7951 Z5 = 66 : GOSUB 7620
7960 REM PLANT IN PIT
7970 IF L1 = 48 OR L1 = 50 THEN 7971 ELSE 7980
7971 Z5 = 47 + P1 : GOSUB 7620
7980 RETURN
7990 REM
8000 REM print long room description from "amessage" file
8010 REM description is noormally l1+200 except for
8020 REM maze or forest
8030 REM set v(l1)=1 so as not to repeat long desc(brief mode
8040 V ( L1 ) = 1
8050 IF L1 > 4 THEN 8080
8060 Z5 = 200 : GOSUB 7620
8070 GOTO 8130
8080 IF NOT ( L1 > 88 AND L1 < 98 OR L1 = 99 ) THEN 8110
8090 Z5 = 288 : GOSUB 7620
8100 GOTO 8130
8110 REM normal description
8120 Z5 = 200 + L1 : GOSUB 7620
8130 RETURN
8180 REM always give long descriptio nfor forest and maze
8190 IF L1 < 5 OR ( L1 > 88 AND L1 < 98 ) OR L1 = 99 THEN 8220
8200 IF V ( L1 ) THEN 8201 ELSE 8220
8201 GOSUB 6780
8202 GOTO 8235
8210 REM he hassn't seen this room, so give a long desc.
8220 V ( L1 ) = 1
8230 GOSUB 7990
8235 RETURN
8240 REM
8250 REM fetch first item code in k(1 to t2)
8260 REM z8=total # of items found in list
8270 REM z3=item code first found
8280 Z8 = 0 : Z3 = 0 : D$ = ""
8290 REM restore 9960
8300 FOR Z5 = 1 TO 45
8310 REM read b$
8320 IF K ( 1 ) <> Z5 AND K ( 2 ) <> Z5 THEN 8360
8330 Z8 = Z8 + 1
8340 RESTORE 9960 + Z5 : READ B$ : D$ = B$
8350 IF K ( 1 ) = Z5 AND Z8 = 1 THEN 8352
8351 IF K ( 2 ) = Z5 AND Z8 = 1 THEN 8352 ELSE 8360
8352 Z3 = Z5
8360 NEXT Z5
8370 B$ = D$
8380 RETURN
8390 REM FIND FIRST ITEM AT ROOM
8400 REM RESTORE 9960
8405 X1 = 0
8410 FOR Z1 = 1 TO 47
8415 IF X1 = 1 THEN 8440
8420 REM READ D$
8430 IF K ( 1 ) = Z1 OR K ( 2 ) = Z1 THEN 8431 ELSE 8440
8431 RESTORE 9960 + Z1 : READ D$ : X1 = 1
8440 NEXT Z1
8450 RETURN
8460 REM 
8470 REM MAKE SURE HE'S CARRYING ITEM * Z3
8480 REM
8490 IF S ( Z3 ) = - 1 THEN 8530
8500 PRINT "You don't have the " ; A$
8510 Z5 = 0
8520 RETURN
8530 Z5 = 1
8540 RETURN
8550 REM *** DWARF ***
8560 IF D3 <> 0 THEN 8640
8570 REM SHOULD DWARF GIVE AWAY AXE?
8580 IF L1 < 13 THEN 8790
8590 IF RND > 0.05 THEN 8790
8600 REM GIVE AWAY AXE
8610 Z5 = 80 : GOSUB 7620
8620 S ( 27 ) = L1 : D3 = 1
8630 GOTO 8790
8640 REM SHOULD DWARF ATTACK?
8650 IF L1 >= 13 THEN 8660
8652 S ( 35 ) = 0 : GOTO 8790
8660 IF S ( 35 ) <> L1 THEN 8770
8670 IF RND > 0.5 THEN 8790
8680 REM YES!
8690 Z5 = 32 : GOSUB 7620
8700 REM DOES THE KNIFE KILL THE PLAYER?
8705 KC = KC - 0.02
8706 IF KC >= 0.5 THEN 8710
8707 KC = 0.5
8710 IF RND <= KC THEN 8750
8720 REM YES
8730 PRINT "It gets you!"
8740 DEAD = 1 : GOTO 8790
8750 PRINT "It misses!"
8760 GOTO 8790
8770 REM SHOULD WE PUT A DWARF HERE?
8780 IF RND >= 0.1 THEN 8790
8785 S ( 35 ) = L1
8786 Z5 = 31 : GOSUB 7620
8790 RETURN
8800 REM *** PIRATE ***
8810 REM FIRST, DOES HE HAVE ANYTHING WORTH STEALING?
8820 Z3 = 0
8830 IF L1 < 13 THEN 8960
8840 FOR X = 1 TO 15
8850 IF S ( X ) <> - 1 THEN 8860
8855 Z3 = Z3 + 1
8860 NEXT X
8870 IF Z3 < INT ( RND * 4 ) + 1 THEN 8960
8880 REM SHOULD WE RIP OFF HIS VALUABLES?
8890 IF RND < 0.05 THEN 8920
8900 Z5 = 34 : GOSUB 7620
8910 GOTO 8960
8920 Z5 = 33 : GOSUB 7620
8930 FOR X = 1 TO 15
8940 IF S ( X ) <> - 1 THEN 8950
8945 S ( X ) = 100
8950 NEXT X
8960 RETURN
8970 REM *** SAVE GAME ***
8980 INPUT "What do you want to call the save file? " , A$
8990 OPEN A$ FOR OUTPUT AS # 5 ELSE 9010
9000 GOTO 9030
9010 PRINT "File " , A$ , " not created"
9020 GOTO 410
9030 PRINT # 5 , T1 , "," , T2 , "," , T3 , "," , L1 , "," , L2 , "," , G , "," , B0 , "," , SN , "," , D1 , "," , D2 , "," , D0 , "," , T , "," , B1 , "," , B2 , "," , P1 , "," , L , "," , C , "," , D3 , "," , B3 , "," , R0 , "," , KC
9040 FOR X = 1 TO 99
9041 PRINT # 5 , S ( X ) , "," , V ( X )
9042 NEXT X
9043 PRINT # 5 , V ( 100 )
9044 CLOSE # 5
9050 PRINT "Game saved"
9051 C0 = 0
9060 IF K ( 1 ) = 143 OR K ( 2 ) = 143 THEN 9750
9070 GOTO 410
9080 REM *** LOAD OLD GAME ***
9090 IF C0 = 0 THEN 9120
9100 PRINT "You already have a loaded game!"
9110 GOTO 410
9120 INPUT "Save file name? " , A$
9130 OPEN A$ FOR INPUT AS # 5 ELSE 9150
9140 GOTO 9170
9150 PRINT "Unable to use file " ; A$
9160 GOTO 410
9170 INPUT # 5 , T1 , T2 , T3 , L1 , L2 , G , B0 , SN , D1 , D2 , D0 , T , B1 , B2 , P1 , L , C , D3 , B3 , R0 , KCX$
9171 KC = VAL ( KCX$ )
9180 FOR X = 1 TO 99
9191 INPUT # 5 , SX , VX : S ( X ) = SX : V ( X ) = VX
9192 NEXT X
9193 INPUT # 5 , VX : V ( 100 ) = VX
9194 CLOSE # 5
9200 C0 = 1
9210 GOTO 300
9220 REM *** READ THE MAGAZINE ***
9230 GOSUB 8280
9240 IF Z3 = 25 THEN 9270
9250 Z5 = 74 : GOSUB 7620
9260 GOTO 410
9270 IF S ( 25 ) = - 1 THEN 9300
9280 B$ = "magazine"
9290 GOTO 2710
9300 REM OK, LET HIM READ IT
9310 Z5 = 303 : GOSUB 7620
9320 GOTO 400
9330 REM *** BUG ***
9340 A$ = "ADVBUGS.TXT"
9341 OPEN A$ FOR APPEND AS # 5 ELSE 9150
9390 INPUT "Your name: " , A$
9400 A$ = A$ + " " + DATE$
9410 PRINT # 5 , A$
9420 PRINT "Enter your gripe in up to five lines (hit return to quit):"
9430 FOR Z0 = 1 TO 5
9440 PRINT Z0 ;
9450 INPUT A$
9460 IF A$ = "" THEN 9490
9470 PRINT # 5 , A$
9480 NEXT Z0
9490 PRINT "Message recorded. Thank you!"
9500 CLOSE # 5
9510 GOTO 410
9540 REM REINCARNATE HIM
9550 R0 = R0 + 1
9560 IF R0 = 1 THEN 9580
9561 IF R0 = 2 THEN 9610
9562 IF R0 = 3 THEN 9740
9570 REM ASK HIM IF HE WANTS TO BE REINCARNATED
9580 Z5 = 75 : GOSUB 7620
9590 GOSUB 9860
9600 GOTO 9630
9610 Z5 = 77 : GOSUB 7620
9620 GOTO 9580
9630 IF Z0 = 0 THEN 9750
9640 Z5 = 76 : GOSUB 7620
9650 REM PUT HIM BACK IN HOUSE, REARRANGE HIS STUFF
9660 S ( 18 ) = 7 : L = 0 : DEAD = 0 : KC = 1.03
9670 FOR X = 1 TO T2
9680 IF S ( X ) <> - 1 THEN 9690
9685 S ( X ) = L1
9690 NEXT X
9700 REM WE'VE PUT THE LAMP IN HOUSE AND OTHER ITEMS WHERE HE DIED
9710 L1 = INT ( RND * 4 ) + 1 : L2 = L1
9720 GOTO 320
9730 REM THIRD DEATH--END OF GAME
9740 Z5 = 78 : GOSUB 7620
9750 PRINT "Oh well..."
9760 GOSUB 6430
9762 CLOSE # 1 : CLOSE # 2 : CLOSE # 3 : CLOSE # 10
9770 STOP
9780 REM *** PITS ***
9790 IF L1 < 13 THEN 1210
9791 IF L = 1 AND ( S ( 18 ) = - 1 OR S ( 18 ) = L1 ) THEN 1210
9800 REM IS HE GOING TO FALL INTO A PIT?
9810 IF L1 = 16 OR L1 = 17 OR L1 = 19 OR L1 = 20 OR L1 = 25 OR L1 = 47 OR L1 = 48 OR L1 = 59 OR L1 = 60 OR L1 = 61 OR L1 = 75 OR L1 = 76 OR L1 = 98 THEN 9840
9820 GOTO 1210
9830 REM he fell into a pit
9840 Z5 = 44 : GOSUB 7620
9850 GOTO 9540
9860 REM *** SEEK A "YES" OR "NO"
9870 INPUT A$
9875 IF LEN ( A$ ) <> 0 THEN 9880
9877 A$ = " "
9880 A$ = LOWER$ ( MID$ ( A$ , 1 , 1 ) )
9890 IF A$ <> "y" AND A$ <> "n" THEN 9930
9900 IF A$ = "y" THEN 9901 ELSE 9910
9901 Z0 = 1
9910 IF A$ = "n" THEN 9911 ELSE 9920
9911 Z0 = 0
9920 GOTO 9945
9930 PRINT "Yes or No-" ;
9940 GOTO 9870
9945 RETURN
9950 REM ---- SHORT NAMES FOR STUFF ----
9961 DATA "large gold nugget"
9962 DATA "bars of silver"
9963 DATA "precious jewelry"
9964 DATA "many coins"
9965 DATA "several diamonds"
9966 DATA "fragile ming vase"
9967 DATA "glistening pearl"
9968 DATA "nest of golden eggs"
9969 DATA "jewel-encrusted trident"
9970 DATA "egg-sized emerald"
9971 DATA "platinum pyramid"
9972 DATA "golden chain"
9973 DATA "rare spices"
9974 DATA "persian rug"
9975 DATA "treasure chest"
9976 DATA "water"
9977 DATA "oil"
9978 DATA "brass lamp"
9979 DATA "keys"
9980 DATA "food"
9981 DATA "bottle"
9982 DATA "wicker cage"
9983 DATA "3-foot black rod"
9984 DATA "clam"
9985 DATA "magazine"
9986 DATA "bear"
9987 DATA "axe"
9988 DATA "velvet pillow"
9989 DATA "shards of pottery"
9990 DATA "oyster"
9991 DATA "bird"
9992 DATA "troll"
9993 DATA "dragon"
9994 DATA "snake"
9995 DATA "dwarf"
9996 DATA "rock"
9997 DATA "stairs"
9998 DATA "steps"
9999 DATA "house"
10000 DATA "grate"
10001 DATA "stream"
10002 DATA "room"
10003 DATA "bridge"
10004 DATA "pit"
10005 DATA "volcano"
10006 DATA "road"
10007 DATA "everything"
12500 REM INITIALIZE MESSAGE INDEX
12501 OPEN "AMESSAGE.IDX" FOR INPUT AS # 6 ELSE 12505
12502 GOTO 12610
12504 REM Message indx file doesn't exist, create it
12505 OPEN "AMESSAGE.IDX" FOR OUTPUT AS # 6
12506 FPOS = - 2 : B$ = "" : FRACNT = 0 : LASTFRA = - 1 : FSEEK # 3 , 0
12520 FPOS = FPOS + LEN ( B$ ) + 2
12522 INPUT # 3 , B$
12530 IF LEN ( B$ ) = 0 THEN 12531 ELSE 12540
12531 B$ = " " : FPOS = FPOS - 1
12540 IF B$ = "#" THEN 12591
12550 IF INSTR ( B$ , "#" ) = 0 THEN 12520
12560 Z4 = VAL ( MID$ ( B$ , 2 ) )
12561 REM print b$," ->",z4,"<-",len(b$)
12570 IF INT ( Z4 ) = Z4 THEN 12580
12571 FRACNT = FRACNT + 1
12572 IF LASTFRA = INT ( Z4 ) THEN 12574
12573 INDX ( INT ( Z4 ) ) = FRACNT : LASTFRA = INT ( Z4 ) : PRINT # 6 , INT ( Z4 ) , "," , FRACNT
12574 FRAINDX ( FRACNT ) = FPOS
12576 GOTO 12585
12580 INDX ( INT ( Z4 ) ) = FPOS
12581 PRINT # 6 , INT ( Z4 ) , "," , FPOS
12585 PRINT "*" ;
12590 GOTO 12520
12591 PRINT # 6 , - 999 , "," , - 999
12592 FOR I = 1 TO FRACNT
12593 PRINT # 6 , FRAINDX ( I )
12594 NEXT I
12595 PRINT # 6 , - 999
12596 CLOSE # 3
12597 OPEN "AMESSAGE" FOR INPUT AS # 3
12600 GOTO 12670
12604 REM READ AMESSAGE.IDX FILE INTO ARRAYS
12610 INPUT # 6 , II , I
12612 PRINT "*" ;
12615 IF I = - 999 THEN 12630
12620 INDX ( II ) = I : GOTO 12610
12630 II = 0
12640 INPUT # 6 , I
12641 PRINT "*" ;
12650 IF I = - 999 THEN 12670
12660 II = II + 1 : FRAINDX ( II ) = I : GOTO 12640
12670 CLOSE # 6 : PRINT : PRINT
12680 RETURN
